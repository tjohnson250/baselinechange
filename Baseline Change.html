<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Todd R. Johnson">

<title>Causal Effect Analysis of Baseline Change</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="Baseline Change_files/libs/clipboard/clipboard.min.js"></script>
<script src="Baseline Change_files/libs/quarto-html/quarto.js"></script>
<script src="Baseline Change_files/libs/quarto-html/popper.min.js"></script>
<script src="Baseline Change_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Baseline Change_files/libs/quarto-html/anchor.min.js"></script>
<link href="Baseline Change_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Baseline Change_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Baseline Change_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Baseline Change_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Baseline Change_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="Baseline Change_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="Baseline Change_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="Baseline Change_files/libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="Baseline Change_files/libs/typedarray-0.1/typedarray.min.js"></script>
<script src="Baseline Change_files/libs/jquery-3.5.1/jquery.min.js"></script>
<link href="Baseline Change_files/libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="Baseline Change_files/libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="Baseline Change_files/libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="Baseline Change_files/libs/plotly-main-2.11.1/plotly-latest.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Causal Effect Analysis of Baseline Change</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Todd R. Johnson </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"jtextor/dagitty/r"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Using GitHub PAT from the git credential store.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Skipping install of 'dagitty' from a github remote, the SHA1 (7a657776) has not changed since last install.
  Use `force = TRUE` to force installation</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dagitty)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdag)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'ggdag'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    filter</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.2     ✔ tibble    3.2.1
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.0.4     </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks ggdag::filter(), stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
</div>
<p>The goal of this notebook is to explain how to estimate the average treatment effect of a dichotomous (binary) treatment on change from a continuous baseline measure <span class="citation" data-cites="tennant2021">(<a href="#ref-tennant2021" role="doc-biblioref">Tennant et al. 2021</a>)</span> under three different scenarios:</p>
<ol type="1">
<li>A Randomized Controlled Trial (RCT) with no loss to follow-up.</li>
<li>An RCT with loss to follow-up.</li>
<li>An observational study with treatment confounders and loss to follow-up.</li>
</ol>
<p>Each approach uses the same core data generating model with a proportional treatment effect, where the treatment works better in patients with lower baseline scores.</p>
<section id="randomized-controlled-trial-with-no-loss-to-follow-up" class="level2">
<h2 class="anchored" data-anchor-id="randomized-controlled-trial-with-no-loss-to-follow-up">Randomized Controlled Trial With No Loss to Follow-Up</h2>
<p>In this simulation:</p>
<p>- <code>severity</code> is a latent (unobserved) variable that affects:</p>
<ol type="a">
<li><p>Baseline scores (sicker patients have lower scores)</p></li>
<li><p>Treatment effect (treatment works better for sicker patients)</p></li>
</ol>
<p>Note that in this model severity is not affected by treatment or time. It is set at baseline for each patient and remains the same for each time period.</p>
<p>The Causal DAG for this data generating model is shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the DAG using dagify</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>dagRCT <span class="ot">&lt;-</span> <span class="fu">dagify</span>(</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  baseline <span class="sc">~</span> severity,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  time1 <span class="sc">~</span> baseline <span class="sc">+</span> group <span class="sc">+</span> severity,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  change1 <span class="sc">~</span> baseline <span class="sc">+</span> time1,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  time2 <span class="sc">~</span> group <span class="sc">+</span> time1 <span class="sc">+</span> severity,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  change2 <span class="sc">~</span> baseline <span class="sc">+</span> time2,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="st">"group"</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="st">"time2"</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">coords =</span> <span class="fu">data.frame</span>(</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="fu">c</span>(<span class="st">"baseline"</span>, <span class="st">"severity"</span>, <span class="st">"group"</span>, <span class="st">"time1"</span>, <span class="st">"change1"</span>, <span class="st">"time2"</span>, <span class="st">"change2"</span>),</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="fl">1.5</span>, <span class="fl">5.5</span>, <span class="dv">4</span>),</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Change status of severity to indicate that it is a latent variable</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="fu">latents</span>(dagRCT) <span class="ot">=</span> <span class="st">"severity"</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the dagitty graph to a ggdag group for prettier printing</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>tidy_dagRCT <span class="ot">&lt;-</span> <span class="fu">tidy_dagitty</span>(dagRCT) </span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot with custom node shapes</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the status (exposure, outcome) information and set variables without a status to "observed"</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>status_data <span class="ot">&lt;-</span> <span class="fu">ggdag_status</span>(tidy_dagRCT)<span class="sc">$</span>data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">status =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(status), <span class="st">"observed"</span>, <span class="fu">as.character</span>(status)))</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="co">#status_data &lt;- status_data %&gt;% mutate(gstatus = as.character(status), gstatus = ifelse(name == "censored", "adjusted", as.character(status)), </span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a><span class="co">#                                      gstatus = factor(gstatus,levels = c(levels(status), "adjusted")))</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot with custom node shapes while preserving status coloring</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(status_data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_edges</span>(<span class="at">arrow_directed =</span> grid<span class="sc">::</span><span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"cm"</span>), <span class="at">type =</span> <span class="st">"closed"</span>)) <span class="sc">+</span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> status), <span class="at">size =</span> <span class="dv">24</span>) <span class="sc">+</span></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_text</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="at">circle =</span> <span class="dv">16</span>, <span class="at">square =</span> <span class="dv">15</span>), <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">name =</span> <span class="st">"Status"</span>, <span class="at">na.value =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_dag</span>() <span class="sc">+</span></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Baseline-Change_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<p>Now let’s simulate data for the RCT. This simulates and retains the potential outcomes Y0_time1, Y1_time1, Y0_time2 and Y1_time2 for all patients, then sets time1 and time2 for a patient based on that patient’s assigned treatment in the data. This means that we can calculate the true causal effect from the potential outcomes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">124</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate data for demonstration</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 150 participants, 2 groups (treatment and control)</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">150</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> n<span class="sc">/</span><span class="dv">2</span>)  <span class="co"># 0 = control, 1 = treatment</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate baseline scores (similar for both groups)</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>baseline <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a latent "severity" variable that affects baseline score</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>severity <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjust baseline by severity (sicker patients have lower baseline scores)</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>baseline <span class="ot">&lt;-</span> baseline <span class="sc">-</span> <span class="dv">5</span> <span class="sc">*</span> severity</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate follow-up scores with proportional effects</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>prop_effect1 <span class="ot">&lt;-</span> <span class="fl">0.20</span>  <span class="co"># 20% improvement at time1 for treatment group</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>prop_effect2 <span class="ot">&lt;-</span> <span class="fl">0.15</span>  <span class="co"># Additional 15% improvement at time2 for treatment group</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate potential outcomes</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="co"># True effect is proportional to baseline</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="co"># The treatment also has a stronger effect for patients with higher severity</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>Y0_time1 <span class="ot">&lt;-</span> baseline <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>Y1_time1 <span class="ot">&lt;-</span> baseline <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> prop_effect1 <span class="sc">+</span> <span class="fl">0.1</span> <span class="sc">*</span> severity) <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>Y0_time2 <span class="ot">&lt;-</span> Y0_time1 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>Y1_time2 <span class="ot">&lt;-</span> Y1_time1 <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> prop_effect1 <span class="sc">+</span> <span class="fl">0.1</span> <span class="sc">*</span> severity) <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate time1 values - true effect is proportional to baseline</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a><span class="co"># The treatment also has a stronger effect for patients with higher severity</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a><span class="co"># time1 &lt;- vector("numeric", n)</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a><span class="co"># for (i in 1:n) {</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a><span class="co">#   if (group[i] == 1) {</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a><span class="co">#     # Treatment group: effect is proportional to baseline and increased by severity</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a><span class="co">#     effect_modifier &lt;- 1 + prop_effect1 + 0.1 * severity[i]</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a><span class="co">#     time1[i] &lt;- baseline[i] * effect_modifier + rnorm(1, mean = 0, sd = 3)</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a><span class="co">#   } else {</span></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a><span class="co">#     # Control group: small random change</span></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a><span class="co">#     time1[i] &lt;- baseline[i] + rnorm(1, mean = 0, sd = 3)</span></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a><span class="co">#   }</span></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a><span class="co"># time2 &lt;- vector("numeric", n)</span></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a><span class="co"># for (i in 1:n) {</span></span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a><span class="co">#   if (group[i] == 1) {</span></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a><span class="co">#     # Treatment group: additional effect proportional to time1</span></span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a><span class="co">#     effect_modifier &lt;- 1 + prop_effect2 + 0.05 * severity[i]</span></span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a><span class="co">#     time2[i] &lt;- time1[i] * effect_modifier + rnorm(1, mean = 0, sd = 3)</span></span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a><span class="co">#   } else {</span></span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a><span class="co">#     # Control group: small random change</span></span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a><span class="co">#     time2[i] &lt;- time1[i] + rnorm(1, mean = 0, sd = 3)</span></span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a><span class="co">#   }</span></span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the observed time1 and time2 based on treatment (group)  assignment</span></span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>time1 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(group <span class="sc">==</span> <span class="dv">0</span>, Y0_time1, Y1_time1)</span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>time2 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(group <span class="sc">==</span> <span class="dv">0</span>, Y0_time2, Y1_time2)</span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data frame</span></span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span>n,</span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(group, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Control"</span>, <span class="st">"Treatment"</span>)),</span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a>  <span class="at">baseline =</span> baseline,</span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a>  <span class="at">time1 =</span> time1,</span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a>  <span class="at">time2 =</span> time2,</span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y0_time1 =</span> Y0_time1,</span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y1_time1 =</span> Y1_time1,</span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y0_time2 =</span> Y0_time2,</span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y1_time2 =</span> Y1_time2,</span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a>  <span class="at">severity =</span> severity  <span class="co"># Include the latent severity variable</span></span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a><span class="co"># Create change scores for the full dataset</span></span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>change1 <span class="ot">&lt;-</span> data<span class="sc">$</span>time1 <span class="sc">-</span> data<span class="sc">$</span>baseline</span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>change2 <span class="ot">&lt;-</span> data<span class="sc">$</span>time2 <span class="sc">-</span> data<span class="sc">$</span>baseline</span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     id     group baseline    time1     time2 Y0_time1 Y1_time1 Y0_time2
1     1   Control 39.09145 38.94449  39.89455 38.94449 48.84230 39.89455
2     2   Control 57.19560 59.86716  62.17377 59.86716 60.29944 62.17377
3     3   Control 44.61789 53.04918  47.49930 53.04918 49.67243 47.49930
4     4   Control 55.33969 56.32246  57.80872 56.32246 58.41192 57.80872
5     5   Control 66.80911 63.67679  61.25124 63.67679 74.47889 61.25124
6     6   Control 56.15879 53.78891  54.37218 53.78891 68.38688 54.37218
7     7   Control 59.10007 59.69455  64.65971 59.69455 69.55121 64.65971
8     8   Control 52.46759 52.00316  51.65788 52.00316 55.48877 51.65788
9     9   Control 49.40897 46.66109  48.80836 46.66109 57.44905 48.80836
10   10   Control 70.79288 67.86056  67.38931 67.86056 67.35339 67.38931
11   11   Control 55.67093 60.34121  63.34273 60.34121 66.05216 63.34273
12   12   Control 31.93408 31.75186  32.81464 31.75186 43.39724 32.81464
13   13   Control 43.44213 43.10698  42.92159 43.10698 53.27799 42.92159
14   14   Control 58.29431 54.84831  53.42288 54.84831 78.44573 53.42288
15   15   Control 60.04356 64.56218  66.55769 64.56218 74.70610 66.55769
16   16   Control 62.46429 65.54253  71.49398 65.54253 69.92314 71.49398
17   17   Control 54.29454 51.26797  50.84189 51.26797 57.43640 50.84189
18   18   Control 29.48965 31.01369  29.00302 31.01369 39.66056 29.00302
19   19   Control 45.05781 44.51446  42.50311 44.51446 51.61058 42.50311
20   20   Control 36.46554 32.84510  26.69822 32.84510 48.31275 26.69822
21   21   Control 46.32265 48.16191  50.36985 48.16191 55.08164 50.36985
22   22   Control 50.45087 55.39182  54.63256 55.39182 60.99653 54.63256
23   23   Control 46.55318 47.80155  55.12707 47.80155 60.63977 55.12707
24   24   Control 63.46695 63.82730  60.18311 63.82730 79.27236 60.18311
25   25   Control 45.71815 44.67753  53.12450 44.67753 62.01167 53.12450
26   26   Control 50.89080 45.91749  45.91419 45.91749 55.15636 45.91419
27   27   Control 48.16881 51.40024  55.16688 51.40024 57.76917 55.16688
28   28   Control 49.11651 46.88987  45.94326 46.88987 57.10953 45.94326
29   29   Control 39.13452 39.64903  40.77922 39.64903 48.70060 40.77922
30   30   Control 40.70747 42.58311  47.82029 42.58311 44.99933 47.82029
31   31   Control 42.51437 39.09705  40.84714 39.09705 56.99478 40.84714
32   32   Control 33.48211 31.92773  28.61153 31.92773 42.12751 28.61153
33   33   Control 53.46371 59.58022  54.90420 59.58022 59.82009 54.90420
34   34   Control 52.66557 50.07268  49.46328 50.07268 59.66487 49.46328
35   35   Control 40.91776 38.48439  39.19120 38.48439 52.09611 39.19120
36   36   Control 54.64298 56.83252  56.79861 56.83252 67.75549 56.79861
37   37   Control 64.94583 60.79840  60.92002 60.79840 69.42455 60.92002
38   38   Control 55.83776 49.69440  55.01165 49.69440 59.31543 55.01165
39   39   Control 35.69860 36.42293  32.36955 36.42293 47.64469 32.36955
40   40   Control 50.47333 48.52611  44.17572 48.52611 51.03669 44.17572
41   41   Control 45.87059 40.87429  38.51251 40.87429 57.33971 38.51251
42   42   Control 68.09646 68.33831  67.75275 68.33831 76.44985 67.75275
43   43   Control 51.56331 48.36605  45.48067 48.36605 61.64866 45.48067
44   44   Control 61.59219 63.02745  65.99955 63.02745 61.25944 65.99955
45   45   Control 48.41200 52.51893  56.85215 52.51893 57.52852 56.85215
46   46   Control 52.24868 46.63139  48.19213 46.63139 56.95051 48.19213
47   47   Control 40.51304 42.02738  39.48818 42.02738 44.67607 39.48818
48   48   Control 40.40055 42.72849  38.60415 42.72849 50.19275 38.60415
49   49   Control 58.03595 60.56136  62.21416 60.56136 60.28262 62.21416
50   50   Control 51.15621 52.76075  51.94790 52.76075 69.76518 51.94790
51   51   Control 37.21183 35.18254  35.78045 35.18254 49.16978 35.78045
52   52   Control 49.63226 45.28386  46.85098 45.28386 57.52738 46.85098
53   53   Control 42.36671 44.15339  37.52431 44.15339 55.71659 37.52431
54   54   Control 50.89122 53.22738  48.61955 53.22738 61.40308 48.61955
55   55   Control 44.68387 44.16536  41.32054 44.16536 58.32170 41.32054
56   56   Control 39.79460 41.76585  43.75333 41.76585 50.71296 43.75333
57   57   Control 54.83938 56.14516  56.23002 56.14516 57.36938 56.23002
58   58   Control 38.64275 36.73682  31.62624 36.73682 48.25726 31.62624
59   59   Control 45.55780 51.51042  50.66644 51.51042 52.40534 50.66644
60   60   Control 53.62608 55.60862  56.92581 55.60862 57.43708 56.92581
61   61   Control 53.29140 53.11390  51.28139 53.11390 63.30093 51.28139
62   62   Control 67.76123 68.19578  68.99667 68.19578 81.75344 68.99667
63   63   Control 40.46914 40.65106  41.64875 40.65106 48.00975 41.64875
64   64   Control 40.71810 37.06681  36.77009 37.06681 43.64157 36.77009
65   65   Control 67.37001 70.16393  70.49267 70.16393 73.47845 70.49267
66   66   Control 57.64053 52.08669  55.55989 52.08669 54.30719 55.55989
67   67   Control 49.88909 50.93954  52.90868 50.93954 57.02446 52.90868
68   68   Control 58.20677 58.46360  53.14766 58.46360 70.40046 53.14766
69   69   Control 55.23292 56.33584  56.37148 56.33584 68.02304 56.37148
70   70   Control 57.43635 60.07684  63.75052 60.07684 67.36057 63.75052
71   71   Control 41.58464 39.27441  38.17657 39.27441 56.84538 38.17657
72   72   Control 33.57789 23.99195  22.99804 23.99195 50.73075 22.99804
73   73   Control 46.98964 44.17566  41.95432 44.17566 40.29836 41.95432
74   74   Control 59.06321 61.77131  60.16613 61.77131 68.85639 60.16613
75   75   Control 48.87397 50.62988  50.30104 50.62988 61.12893 50.30104
76   76 Treatment 54.54478 60.29331  68.37596 54.73486 60.29331 52.32298
77   77 Treatment 60.11717 75.54304  99.11581 65.42701 75.54304 65.14231
78   78 Treatment 56.43157 80.54078 119.40571 55.12553 80.54078 56.94389
79   79 Treatment 58.84627 74.69194  90.14163 60.43549 74.69194 60.06271
80   80 Treatment 49.78355 60.86280  78.83264 50.08867 60.86280 51.84502
81   81 Treatment 50.83785 57.18154  64.13782 46.24020 57.18154 43.13870
82   82 Treatment 57.59920 73.71699  92.47865 57.27658 73.71699 61.38049
83   83 Treatment 43.52943 60.45304  84.71730 45.81643 60.45304 46.50178
84   84 Treatment 45.22371 52.27877  62.00978 44.52233 52.27877 46.51467
85   85 Treatment 11.00985 19.05979  28.22155 13.14188 19.05979 17.25865
86   86 Treatment 48.31842 48.99325  53.17994 48.28534 48.99325 49.35369
87   87 Treatment 59.25869 69.59108  80.84698 59.78521 69.59108 60.98390
88   88 Treatment 67.97401 67.54562  70.84304 64.87460 67.54562 68.44877
89   89 Treatment 70.31073 83.87550 100.52183 76.46813 83.87550 77.59151
90   90 Treatment 48.48987 55.55405  62.65999 44.65864 55.55405 45.75782
91   91 Treatment 42.51204 50.65590  55.87271 41.60971 50.65590 45.15135
92   92 Treatment 54.88327 62.52919  69.62319 57.33432 62.52919 57.04365
93   93 Treatment 56.40594 66.55292  85.60029 54.98326 66.55292 52.19416
94   94 Treatment 48.79905 65.93170  77.83907 48.76008 65.93170 43.99867
95   95 Treatment 43.51246 63.52734  92.53424 42.98487 63.52734 42.40286
96   96 Treatment 43.16136 54.72664  70.49579 42.49663 54.72664 48.53186
97   97 Treatment 56.30816 64.69526  74.67816 54.54098 64.69526 58.76511
98   98 Treatment 57.87567 75.41792  98.63383 57.98448 75.41792 54.55783
99   99 Treatment 25.70053 30.50729  40.72608 23.38890 30.50729 29.90117
100 100 Treatment 68.41269 70.92787  71.76531 62.47600 70.92787 58.71133
101 101 Treatment 42.83618 53.89007  71.09207 42.49019 53.89007 41.74520
102 102 Treatment 42.67407 45.78115  47.98779 43.06178 45.78115 37.94560
103 103 Treatment 57.00004 71.68920  88.86870 57.80152 71.68920 55.59091
104 104 Treatment 46.06045 51.03660  60.58087 41.88157 51.03660 42.21685
105 105 Treatment 48.61455 54.60376  55.37608 46.84337 54.60376 48.43960
106 106 Treatment 48.58344 48.49807  52.36754 54.95247 48.49807 56.93475
107 107 Treatment 47.54618 59.97347  72.89233 47.76594 59.97347 45.13345
108 108 Treatment 51.92373 63.58916  79.48709 50.76227 63.58916 54.52064
109 109 Treatment 45.55180 59.11262  77.86122 41.56316 59.11262 38.65800
110 110 Treatment 48.36586 57.70214  69.09031 49.40059 57.70214 48.08633
111 111 Treatment 52.89847 65.09622  81.76633 49.86835 65.09622 45.47814
112 112 Treatment 51.53511 58.24248  65.89854 51.50258 58.24248 43.11744
113 113 Treatment 39.66116 44.92299  49.99655 37.06584 44.92299 35.26878
114 114 Treatment 50.44553 55.78413  63.53970 50.31529 55.78413 47.14423
115 115 Treatment 57.13133 71.23052  87.68700 56.20440 71.23052 56.46083
116 116 Treatment 48.20019 57.03628  65.94945 52.60924 57.03628 45.32020
117 117 Treatment 46.04917 52.19150  60.17738 47.44696 52.19150 51.74285
118 118 Treatment 50.90043 63.98681  74.18652 52.18907 63.98681 53.52013
119 119 Treatment 44.50771 50.95063  53.34588 48.72036 50.95063 43.00559
120 120 Treatment 56.06550 74.59888 103.54079 54.42610 74.59888 57.62512
121 121 Treatment 60.45469 63.83268  67.47092 56.15643 63.83268 61.35284
122 122 Treatment 58.24016 72.06693  91.99193 59.35566 72.06693 64.12470
123 123 Treatment 55.47591 60.94993  68.30700 58.08867 60.94993 56.03362
124 124 Treatment 58.25315 60.99491  69.31943 61.36232 60.99491 63.68286
125 125 Treatment 58.98655 68.24045  78.37278 58.66195 68.24045 58.43766
126 126 Treatment 50.00476 65.67756  87.47491 44.09626 65.67756 44.72460
127 127 Treatment 51.33585 67.57276  84.55268 47.15134 67.57276 47.50333
128 128 Treatment 35.18915 39.30469  45.90114 32.28052 39.30469 31.16266
129 129 Treatment 58.73291 69.39553  71.69120 58.00190 69.39553 60.27539
130 130 Treatment 72.57546 83.65660  94.62015 75.93713 83.65660 77.56127
131 131 Treatment 71.79009 77.42212  81.04355 71.06834 77.42212 71.68858
132 132 Treatment 45.96473 47.25815  39.51445 44.37800 47.25815 47.62483
133 133 Treatment 37.85788 49.65274  60.90281 32.07848 49.65274 31.75201
134 134 Treatment 34.82885 46.31059  63.08097 33.37962 46.31059 30.03325
135 135 Treatment 36.83460 35.36407  36.93280 40.99307 35.36407 45.55133
136 136 Treatment 60.27065 78.41002 102.51581 59.15572 78.41002 58.98592
137 137 Treatment 44.70728 55.23012  59.90133 43.11129 55.23012 47.76813
138 138 Treatment 37.30080 45.14299  49.06174 42.09273 45.14299 42.95190
139 139 Treatment 61.00677 78.25849  94.59303 56.06238 78.25849 54.30918
140 140 Treatment 54.59061 67.62165  85.41414 56.20424 67.62165 57.35683
141 141 Treatment 55.03863 61.62011  74.18757 56.08165 61.62011 55.78789
142 142 Treatment 42.84571 56.67893  71.67246 38.95967 56.67893 39.81810
143 143 Treatment 57.98146 63.34712  73.16962 53.85832 63.34712 58.91781
144 144 Treatment 68.54190 76.14336  77.30184 68.83238 76.14336 71.83553
145 145 Treatment 35.40112 46.37997  68.28407 34.71479 46.37997 36.42422
146 146 Treatment 41.39019 42.73918  46.59885 39.74948 42.73918 36.44519
147 147 Treatment 37.52050 47.21034  59.04016 36.21049 47.21034 36.77405
148 148 Treatment 44.39008 58.05083  74.19946 44.09960 58.05083 45.43446
149 149 Treatment 40.47486 54.31955  68.20934 38.88585 54.31955 36.42366
150 150 Treatment 61.99351 63.58270  69.03147 60.43616 63.58270 58.15848
     Y1_time2     severity     change1      change2
1    58.58824 -0.588431009 -0.14696141   0.80310323
2    58.79534 -1.362473104  2.67156604   4.97817182
3    49.88642 -0.449637942  8.43129429   2.88141640
4    64.25387 -0.643325032  0.98276975   2.46903003
5    84.43627 -0.510745552 -3.13232201  -5.55786280
6    89.83833  0.257202011 -2.36987720  -1.78661187
7    80.70594 -0.419555448  0.59448210   5.55963831
8    58.94418 -0.952227655 -0.46443375  -0.80971394
9    72.41812  0.512393405 -2.74788180  -0.60060745
10   64.17177 -1.744267685 -2.93232051  -3.40356129
11   79.58758 -0.497512412  4.67027773   7.67180114
12   58.63108  0.765585781 -0.18222465   0.88055974
13   66.81193  0.501393067 -0.33514947  -0.52054061
14   98.39941  0.331911171 -3.44599971  -4.87143051
15   92.67333 -0.091075734  4.51862821   6.51413459
16   77.83721 -0.656682033  3.07823831   9.02968853
17   62.71453 -1.160848139 -3.02657564  -3.45265139
18   55.57684  1.655931934  1.52403734  -0.48663711
19   58.46786 -0.749210548 -0.54334533  -2.55470351
20   53.98608  0.621920555 -3.62044753  -9.76732797
21   55.50436 -1.471805169  1.83926538   4.04720155
22   75.98730  0.798195457  4.94094344   4.18168576
23   75.73098  0.279462509  1.24837121   8.57388494
24  102.85162  0.657874259  0.36034456  -3.28384345
25   77.29861  0.593726323 -1.04061432   7.40635709
26   65.98937 -0.577926514 -4.97330840  -4.97661367
27   71.08579  0.476062734  3.23142746   6.99807226
28   58.25056 -1.187633619 -2.22664220  -3.17325390
29   58.87147  0.717688045  0.51451544   1.64469937
30   53.56137  0.134697245  1.87564126   7.11281818
31   77.24838  1.422080340 -3.41731346  -1.66722659
32   51.03576  0.040730913 -1.55438656  -4.87058402
33   65.84015 -0.338409751  6.11651020   1.44048664
34   71.63615 -0.558115388 -2.59289064  -3.20228733
35   65.45196  1.027813483 -2.43337167  -1.72655705
36   72.31925 -0.225470479  2.18953673   2.15563116
37   71.98265 -1.231630051 -4.14742242  -4.02580505
38   62.03784 -0.758244741 -6.14336000  -0.82610978
39   60.05289  1.085518149  0.72433121  -3.32905206
40   56.30502 -1.049098885 -1.94722419  -6.29761143
41   68.41145  0.290399553 -4.99630067  -7.35808471
42   82.87496 -0.447573426  0.24185284  -0.34371256
43   67.48246 -0.218860766 -3.19725710  -6.08263979
44   60.52893 -1.605443512  1.43526609   4.40736733
45   65.45619  0.074839686  4.10692438   8.44014513
46   63.85951 -0.521918699 -5.61728670  -4.05654833
47   53.28959 -0.064902369  1.51434346  -1.02485445
48   73.21381  1.051369968  2.32793910  -1.79640026
49   62.04669 -1.742158263  2.52541139   4.17820788
50   91.15907  1.732548028  1.60454924   0.79169389
51   73.18699  1.633529147 -2.02929309  -1.43137861
52   70.83273 -0.376649698 -4.34839331  -2.78127080
53   64.85573 -0.166238218  1.78667353  -4.84240379
54   75.82325 -0.032152280  2.33615058  -2.27167361
55   70.83374  0.513153462 -0.51850372  -3.36333089
56   64.87683  1.268227345  1.97125430   3.95873114
57   61.40759 -1.060282651  1.30578289   1.39064067
58   62.45687  0.619662623 -1.90592779  -7.01650545
59   58.03013 -0.819628200  5.95262181   5.10864515
60   64.67588 -0.487742639  1.98253945   3.29972383
61   77.56820 -0.091085439 -0.17749198  -2.01001058
62  101.93806  0.307927349  0.43455354   1.23543937
63   52.21592 -0.374883974  0.18192063   1.17960165
64   49.84748 -0.787856679 -3.65128920  -3.94801489
65   80.09937 -1.016339522  2.79392115   3.12265457
66   53.31948 -2.625018837 -5.55384782  -2.08064347
67   66.37422 -0.229832109  1.05044997   3.01959152
68   79.70909 -0.265917359  0.25682731  -5.05911651
69   82.29789  0.363816746  1.10292346   1.13855834
70   83.37178  0.115686261  2.64048590   6.31416538
71   72.28006  0.757306617 -2.31022445  -3.40806910
72   73.33670  1.515312869 -9.58594056 -10.57984198
73   35.81259 -2.659783853 -2.81398228  -5.03532368
74   80.48814 -0.688180040  2.70810487   1.10292576
75   70.66967 -0.426578648  1.75590438   1.42706999
76   68.37596 -0.426205443  5.74852387  13.83118007
77   99.11581  0.148303276 15.42586597  38.99863505
78  119.40571  2.527809443 24.10920785  62.97413906
79   90.14163 -0.143400088 15.84566559  31.29535240
80   78.83264  1.033067643 11.07924663  29.04908966
81   64.13782 -0.357864893  6.34369192  13.29997111
82   92.47865  0.757721814 16.11779533  34.87944996
83   84.71730  2.298742697 16.92360800  41.18786397
84   62.00978 -0.075570095  7.05506273  16.78606794
85   28.22155  2.861248463  8.04993772  17.21169770
86   53.17994 -1.408790030  0.67482955   4.86151922
87   80.84698  0.076437759 10.33238523  21.58829281
88   70.84304 -1.773209098 -0.42838696   2.86902813
89  100.52183 -0.210528088 13.56476810  30.21110551
90   62.65999 -0.303787640  7.06417766  14.17012062
91   55.87271 -0.611821863  8.14386035  13.36066636
92   69.62319 -0.140420951  7.64592514  14.73992795
93   85.60029  0.121357441 10.14698183  29.19435327
94   77.83907  0.733706176 17.13264563  29.04001875
95   92.53424  2.226098691 20.01487797  49.02178536
96   70.49579  0.576791991 11.56527937  27.33443604
97   74.67816  0.164509489  8.38710202  18.37000860
98   98.63383  0.794891931 17.54225351  40.75815990
99   40.72608  1.037596357  4.80676899  15.02555369
100  71.76531 -1.452676696  2.51518116   3.35262333
101  71.09207  0.494162682 11.05388448  28.25588929
102  47.98779 -0.830819813  3.10707906   5.31371876
103  88.86870  0.807987311 14.68916009  31.86866147
104  60.58087  0.209410136  4.97614530  14.52042446
105  55.37608 -0.277568197  5.98920421   6.76152285
106  52.36754 -1.468252805 -0.08536482   3.78410039
107  72.89233  0.497323081 12.42728910  25.34614968
108  79.48709  0.146437596 11.66543444  27.56335895
109  77.86122  0.641591724 13.56082034  32.30941862
110  69.09031  0.068976156  9.33627549  20.72444726
111  81.76633  0.018530770 12.19775429  28.86785748
112  65.89854 -0.270422763  6.70737853  14.36343214
113  49.99655 -0.232355657  5.26182785  10.33538848
114  63.53970 -0.947898423  5.33860006  13.09417242
115  87.68700  0.273739679 14.09919148  30.55567331
116  65.94945 -0.069697035  8.83609417  17.74926465
117  60.17738 -0.444662895  6.14232826  14.12820452
118  74.18652  0.038769544 13.08638186  23.28608932
119  53.34588 -0.314564052  6.44292517   8.83816738
120 103.54079  1.872851822 18.53338300  47.47529032
121  67.47092 -1.389335511  3.37798682   7.01622442
122  91.99193  0.697209012 13.82676609  33.75177344
123  68.30700 -1.161929589  5.47401965  12.83108935
124  69.31943 -0.927741210  2.74176648  11.06628276
125  78.37278  0.293841101  9.25389608  19.38622932
126  87.47491  0.205472841 15.67280200  37.47015057
127  84.55268  0.396421921 16.23691330  33.21683253
128  45.90114 -0.174946992  4.11554123  10.71199055
129  71.69120 -0.866042662 10.66261758  12.95828311
130  94.62015 -0.751348416 11.08114337  22.04469632
131  81.04355 -1.659806250  5.63202936   9.25345538
132  39.51445 -2.463111660  1.29342033  -6.45028447
133  60.90281  0.997359361 11.79485987  23.04493403
134  63.08097  1.201242167 11.48174754  28.25212290
135  36.93280 -2.088974257 -1.47052692   0.09819388
136 102.51581  1.002769194 18.13936704  42.24516009
137  59.90133 -0.201030187 10.52284451  15.19404750
138  49.06174  0.403656593  7.84219071  11.76094455
139  94.59303  0.288365090 17.25172132  33.58626140
140  85.41414  0.001630429 13.03103985  30.82353547
141  74.18757 -0.672314405  6.58148135  19.14894085
142  71.67246  0.880851961 13.83322250  28.82675013
143  73.16962 -0.611647224  5.36566206  15.18815944
144  77.30184 -1.028870125  7.60146626   8.75993883
145  68.28407  1.966288418 10.97885748  32.88295473
146  46.59885 -1.271629667  1.34898838   5.20865389
147  59.04016  0.093051240  9.68984029  21.51966002
148  74.19946  0.307061493 13.66074506  29.80938144
149  68.20934  0.009532613 13.84469632  27.73448794
150  69.03147 -0.695369234  1.58919330   7.03795645</code></pre>
</div>
</div>
<p>For publication ready tables, we can use gtsummary. Here is the cannonical Table 1:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>table1 <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> <span class="fu">tbl_summary</span>()</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>table1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="rnvfcutllp" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#rnvfcutllp table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#rnvfcutllp thead, #rnvfcutllp tbody, #rnvfcutllp tfoot, #rnvfcutllp tr, #rnvfcutllp td, #rnvfcutllp th {
  border-style: none;
}

#rnvfcutllp p {
  margin: 0;
  padding: 0;
}

#rnvfcutllp .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rnvfcutllp .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#rnvfcutllp .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rnvfcutllp .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rnvfcutllp .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rnvfcutllp .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rnvfcutllp .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rnvfcutllp .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rnvfcutllp .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rnvfcutllp .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rnvfcutllp .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rnvfcutllp .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rnvfcutllp .gt_spanner_row {
  border-bottom-style: hidden;
}

#rnvfcutllp .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#rnvfcutllp .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#rnvfcutllp .gt_from_md > :first-child {
  margin-top: 0;
}

#rnvfcutllp .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rnvfcutllp .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rnvfcutllp .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#rnvfcutllp .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#rnvfcutllp .gt_row_group_first td {
  border-top-width: 2px;
}

#rnvfcutllp .gt_row_group_first th {
  border-top-width: 2px;
}

#rnvfcutllp .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rnvfcutllp .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#rnvfcutllp .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#rnvfcutllp .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rnvfcutllp .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rnvfcutllp .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rnvfcutllp .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#rnvfcutllp .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rnvfcutllp .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rnvfcutllp .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rnvfcutllp .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rnvfcutllp .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rnvfcutllp .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rnvfcutllp .gt_left {
  text-align: left;
}

#rnvfcutllp .gt_center {
  text-align: center;
}

#rnvfcutllp .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rnvfcutllp .gt_font_normal {
  font-weight: normal;
}

#rnvfcutllp .gt_font_bold {
  font-weight: bold;
}

#rnvfcutllp .gt_font_italic {
  font-style: italic;
}

#rnvfcutllp .gt_super {
  font-size: 65%;
}

#rnvfcutllp .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#rnvfcutllp .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#rnvfcutllp .gt_indent_1 {
  text-indent: 5px;
}

#rnvfcutllp .gt_indent_2 {
  text-indent: 10px;
}

#rnvfcutllp .gt_indent_3 {
  text-indent: 15px;
}

#rnvfcutllp .gt_indent_4 {
  text-indent: 20px;
}

#rnvfcutllp .gt_indent_5 {
  text-indent: 25px;
}

#rnvfcutllp .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#rnvfcutllp div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header gt_col_headings">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="stat_0" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>N = 150</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">id</td>
<td class="gt_row gt_center" headers="stat_0">76 (38, 113)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">group</td>
<td class="gt_row gt_center" headers="stat_0"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Control</td>
<td class="gt_row gt_center" headers="stat_0">75 (50%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Treatment</td>
<td class="gt_row gt_center" headers="stat_0">75 (50%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">baseline</td>
<td class="gt_row gt_center" headers="stat_0">50 (43, 57)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">time1</td>
<td class="gt_row gt_center" headers="stat_0">55 (46, 64)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">time2</td>
<td class="gt_row gt_center" headers="stat_0">60 (48, 71)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Y0_time1</td>
<td class="gt_row gt_center" headers="stat_0">50 (43, 57)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Y1_time1</td>
<td class="gt_row gt_center" headers="stat_0">58 (52, 68)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Y0_time2</td>
<td class="gt_row gt_center" headers="stat_0">50 (43, 57)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Y1_time2</td>
<td class="gt_row gt_center" headers="stat_0">69 (60, 79)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">severity</td>
<td class="gt_row gt_center" headers="stat_0">-0.08 (-0.66, 0.51)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">change1</td>
<td class="gt_row gt_center" headers="stat_0">3 (0, 10)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">change2</td>
<td class="gt_row gt_center" headers="stat_0">6 (-1, 19)</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="2" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> Median (Q1, Q3); n (%)</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p>And here is the Canonical Table 2. This shows a significant difference between <code>time2</code> for the treatment and control groups.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>table2 <span class="ot">&lt;-</span> <span class="fu">tbl_summary</span>(data, <span class="at">by =</span> group) <span class="sc">|&gt;</span> <span class="fu">add_p</span>() <span class="sc">|&gt;</span> <span class="fu">bold_labels</span>()</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>table2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="wgsnslyehr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#wgsnslyehr table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#wgsnslyehr thead, #wgsnslyehr tbody, #wgsnslyehr tfoot, #wgsnslyehr tr, #wgsnslyehr td, #wgsnslyehr th {
  border-style: none;
}

#wgsnslyehr p {
  margin: 0;
  padding: 0;
}

#wgsnslyehr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#wgsnslyehr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#wgsnslyehr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#wgsnslyehr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#wgsnslyehr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wgsnslyehr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wgsnslyehr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wgsnslyehr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#wgsnslyehr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#wgsnslyehr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#wgsnslyehr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#wgsnslyehr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#wgsnslyehr .gt_spanner_row {
  border-bottom-style: hidden;
}

#wgsnslyehr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#wgsnslyehr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#wgsnslyehr .gt_from_md > :first-child {
  margin-top: 0;
}

#wgsnslyehr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#wgsnslyehr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#wgsnslyehr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#wgsnslyehr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#wgsnslyehr .gt_row_group_first td {
  border-top-width: 2px;
}

#wgsnslyehr .gt_row_group_first th {
  border-top-width: 2px;
}

#wgsnslyehr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wgsnslyehr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#wgsnslyehr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#wgsnslyehr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wgsnslyehr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wgsnslyehr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#wgsnslyehr .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#wgsnslyehr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#wgsnslyehr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wgsnslyehr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wgsnslyehr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wgsnslyehr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wgsnslyehr .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wgsnslyehr .gt_left {
  text-align: left;
}

#wgsnslyehr .gt_center {
  text-align: center;
}

#wgsnslyehr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#wgsnslyehr .gt_font_normal {
  font-weight: normal;
}

#wgsnslyehr .gt_font_bold {
  font-weight: bold;
}

#wgsnslyehr .gt_font_italic {
  font-style: italic;
}

#wgsnslyehr .gt_super {
  font-size: 65%;
}

#wgsnslyehr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#wgsnslyehr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#wgsnslyehr .gt_indent_1 {
  text-indent: 5px;
}

#wgsnslyehr .gt_indent_2 {
  text-indent: 10px;
}

#wgsnslyehr .gt_indent_3 {
  text-indent: 15px;
}

#wgsnslyehr .gt_indent_4 {
  text-indent: 20px;
}

#wgsnslyehr .gt_indent_5 {
  text-indent: 25px;
}

#wgsnslyehr .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#wgsnslyehr div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header gt_col_headings">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="stat_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Control</strong><br>
N = 75<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Treatment</strong><br>
N = 75<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">id</td>
<td class="gt_row gt_center" headers="stat_1">38 (19, 57)</td>
<td class="gt_row gt_center" headers="stat_2">113 (94, 132)</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">baseline</td>
<td class="gt_row gt_center" headers="stat_1">50 (42, 56)</td>
<td class="gt_row gt_center" headers="stat_2">50 (44, 58)</td>
<td class="gt_row gt_center" headers="p.value">0.6</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">time1</td>
<td class="gt_row gt_center" headers="stat_1">51 (43, 57)</td>
<td class="gt_row gt_center" headers="stat_2">61 (52, 68)</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">time2</td>
<td class="gt_row gt_center" headers="stat_1">51 (41, 57)</td>
<td class="gt_row gt_center" headers="stat_2">71 (61, 85)</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Y0_time1</td>
<td class="gt_row gt_center" headers="stat_1">51 (43, 57)</td>
<td class="gt_row gt_center" headers="stat_2">50 (43, 57)</td>
<td class="gt_row gt_center" headers="p.value">0.9</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Y1_time1</td>
<td class="gt_row gt_center" headers="stat_1">57 (51, 66)</td>
<td class="gt_row gt_center" headers="stat_2">61 (52, 68)</td>
<td class="gt_row gt_center" headers="p.value">0.2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Y0_time2</td>
<td class="gt_row gt_center" headers="stat_1">51 (41, 57)</td>
<td class="gt_row gt_center" headers="stat_2">49 (43, 58)</td>
<td class="gt_row gt_center" headers="p.value">0.8</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Y1_time2</td>
<td class="gt_row gt_center" headers="stat_1">66 (59, 77)</td>
<td class="gt_row gt_center" headers="stat_2">71 (61, 85)</td>
<td class="gt_row gt_center" headers="p.value">0.14</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">severity</td>
<td class="gt_row gt_center" headers="stat_1">-0.23 (-0.69, 0.51)</td>
<td class="gt_row gt_center" headers="stat_2">0.02 (-0.61, 0.58)</td>
<td class="gt_row gt_center" headers="p.value">0.3</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">change1</td>
<td class="gt_row gt_center" headers="stat_1">0 (-3, 2)</td>
<td class="gt_row gt_center" headers="stat_2">10 (6, 14)</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">change2</td>
<td class="gt_row gt_center" headers="stat_1">-1 (-3, 3)</td>
<td class="gt_row gt_center" headers="stat_2">19 (13, 30)</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="even">
<td colspan="4" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> Median (Q1, Q3)</td>
</tr>
<tr class="odd">
<td colspan="4" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span> Wilcoxon rank sum test</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p>With all the potential outcomes we can calculate the Average Treatment Effect of the treatment on time2 as:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(data<span class="sc">$</span>Y1_time2) <span class="sc">-</span> <span class="fu">mean</span>(data<span class="sc">$</span>Y0_time2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20.22007</code></pre>
</div>
</div>
<p>This is just the mean of the raw individual treatment effects:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(data<span class="sc">$</span>Y1_time2 <span class="sc">-</span> data<span class="sc">$</span>Y0_time2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20.22007</code></pre>
</div>
</div>
<p>This value is not adjusted for the baseline value of each patient.</p>
<p>We can also compute the difference in change scores between the treated and untreated, which is the causal estimand showing the effect of treatment, <span class="math inline">\(X\)</span>, on change in score <span class="math inline">\(Y\)</span>, where <span class="math inline">\(Y_1^x\)</span> is the potential outcome of <span class="math inline">\(Y_1\)</span> the follow-up score when <span class="math inline">\(X\)</span> is set to <span class="math inline">\(x\)</span> and <span class="math inline">\(Y_1^{x'}\)</span> is the potential outcome of …</p>
<p><span id="eq-changescore"><span class="math display">\[
\mathrm{E}(Y_1^x - Y_0^x) - \mathrm{E}(Y_1^{x'} - Y_0^{x'})
\tag{1}\]</span></span></p>
<p>When we have both potential outcomes for the populations, this is identical to the equations above, because the baselines cancel out across the two means below. In <a href="#eq-changescore" class="quarto-xref">Equation&nbsp;1</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(data<span class="sc">$</span>Y1_time2 <span class="sc">-</span> data<span class="sc">$</span>baseline) <span class="sc">-</span> <span class="fu">mean</span>(data<span class="sc">$</span>Y0_time2 <span class="sc">-</span> data<span class="sc">$</span>baseline)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20.22007</code></pre>
</div>
</div>
<p>While there is only one measured covariate here (<code>baseline</code>) a covariate balance plot showing the standardized mean differences between covariates in the treated and untreated groups (treatment mean - control mean) will show whether there is covariate imbalance due to the small sample size. Here, we include the latent variable <code>severity</code>. Even though we have an RCT, both covariates are skewed to the right.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cobalt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code> cobalt (Version 4.6.0, Build Date: 2025-04-15)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>unadjcov <span class="ot">&lt;-</span> <span class="fu">bal.tab</span>(group <span class="sc">~</span> baseline <span class="sc">+</span> severity, <span class="at">data =</span> data, <span class="at">thresholds =</span> <span class="fu">c</span>(<span class="at">m =</span> .<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Note: `s.d.denom` not specified; assuming "pooled".</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">love.plot</span>(unadjcov, <span class="at">stars =</span> <span class="st">"std"</span>, <span class="at">thresholds =</span> <span class="fu">c</span>(<span class="at">m =</span> .<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Baseline-Change_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>There is some controversy over how to measure total effect of a treatment on change from baseline. If the baseline values of the treatment and control group are balanced, then an unbiased average treatment effect is just the mean of <code>time2</code> for those in the treatment group minus the mean for those in the control group. In an RCT with sufficient sample size, the baselines are expected to be balanced. Let’s check our data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(group) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">meanBaseline =</span> <span class="fu">mean</span>(baseline))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  group     meanBaseline
  &lt;fct&gt;            &lt;dbl&gt;
1 Control           50.0
2 Treatment         50.5</code></pre>
</div>
</div>
<p>With the relatively small sample size, the baseline means are close, but not perfectly balanced. This could bias our effect estimate if we simply use the difference in means of <code>time2</code> between Treatment and Control. The means of <code>time2</code> for the Control and Treatment groups are:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>means <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(group) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(time2))</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>means</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  group      mean
  &lt;fct&gt;     &lt;dbl&gt;
1 Control    49.8
2 Treatment  71.9</code></pre>
</div>
</div>
<p>Subtracting these to get the average treatment effect is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(means, group<span class="sc">==</span><span class="st">"Treatment"</span>)<span class="sc">$</span>mean <span class="sc">-</span> <span class="fu">filter</span>(means, group<span class="sc">==</span><span class="st">"Control"</span>)<span class="sc">$</span>mean</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 22.05297</code></pre>
</div>
</div>
<p>We can also do a t-test to test for difference in means for <code>time2</code> between the treatment and control groups:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(time2 <span class="sc">~</span> group, <span class="at">data =</span> data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  time2 by group
t = -9.2943, df = 126.84, p-value = 5.426e-16
alternative hypothesis: true difference in means between group Control and group Treatment is not equal to 0
95 percent confidence interval:
 -26.74824 -17.35770
sample estimates:
  mean in group Control mean in group Treatment 
               49.80446                71.85743 </code></pre>
</div>
</div>
<p>Here, we see that the means are statistically significantly different.</p>
<p>If the baseline values are unbalanced, the effect estimate of the difference in means of <code>time2</code> will be biased. This is why many analysts recommend always using analysis of covariance (ANCOVA) where the outcome is regressed on the treatment and adjusted for the baseline value:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">lm</span>(time2 <span class="sc">~</span> group <span class="sc">+</span> baseline, <span class="at">data =</span> data)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = time2 ~ group + baseline, data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-27.399  -5.672  -0.532   5.751  41.044 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     -4.8355     4.1091  -1.177    0.241    
groupTreatment  21.4722     1.5712  13.666   &lt;2e-16 ***
baseline         1.0938     0.0792  13.811   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 9.618 on 147 degrees of freedom
Multiple R-squared:  0.7252,    Adjusted R-squared:  0.7214 
F-statistic: 193.9 on 2 and 147 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Here we see that the causal effect of <code>group</code> on <code>time2</code> when adjusted for baseline is <code>coef(res)["group"]</code>. Note above that the baseline means between treatment and control differ by around .5, which explains the difference between the effect as computed on the difference in the mean of <code>time2</code> between groups, vs.&nbsp;the regression results.</p>
<p>We can use gtsummary for a nicer view of the results:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_regression</span>(res, <span class="at">estimate_fun =</span> purrr<span class="sc">::</span><span class="fu">partial</span>(style_ratio, <span class="at">digits =</span> <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="gyovqomiut" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#gyovqomiut table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#gyovqomiut thead, #gyovqomiut tbody, #gyovqomiut tfoot, #gyovqomiut tr, #gyovqomiut td, #gyovqomiut th {
  border-style: none;
}

#gyovqomiut p {
  margin: 0;
  padding: 0;
}

#gyovqomiut .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#gyovqomiut .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#gyovqomiut .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#gyovqomiut .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#gyovqomiut .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gyovqomiut .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gyovqomiut .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gyovqomiut .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#gyovqomiut .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#gyovqomiut .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#gyovqomiut .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#gyovqomiut .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#gyovqomiut .gt_spanner_row {
  border-bottom-style: hidden;
}

#gyovqomiut .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#gyovqomiut .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#gyovqomiut .gt_from_md > :first-child {
  margin-top: 0;
}

#gyovqomiut .gt_from_md > :last-child {
  margin-bottom: 0;
}

#gyovqomiut .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#gyovqomiut .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#gyovqomiut .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#gyovqomiut .gt_row_group_first td {
  border-top-width: 2px;
}

#gyovqomiut .gt_row_group_first th {
  border-top-width: 2px;
}

#gyovqomiut .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gyovqomiut .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#gyovqomiut .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#gyovqomiut .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gyovqomiut .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gyovqomiut .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#gyovqomiut .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#gyovqomiut .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#gyovqomiut .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gyovqomiut .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gyovqomiut .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gyovqomiut .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gyovqomiut .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gyovqomiut .gt_left {
  text-align: left;
}

#gyovqomiut .gt_center {
  text-align: center;
}

#gyovqomiut .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#gyovqomiut .gt_font_normal {
  font-weight: normal;
}

#gyovqomiut .gt_font_bold {
  font-weight: bold;
}

#gyovqomiut .gt_font_italic {
  font-style: italic;
}

#gyovqomiut .gt_super {
  font-size: 65%;
}

#gyovqomiut .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#gyovqomiut .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#gyovqomiut .gt_indent_1 {
  text-indent: 5px;
}

#gyovqomiut .gt_indent_2 {
  text-indent: 10px;
}

#gyovqomiut .gt_indent_3 {
  text-indent: 15px;
}

#gyovqomiut .gt_indent_4 {
  text-indent: 20px;
}

#gyovqomiut .gt_indent_5 {
  text-indent: 25px;
}

#gyovqomiut .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#gyovqomiut div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header gt_col_headings">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Beta</strong></th>
<th id="conf.low" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">group</td>
<td class="gt_row gt_center" headers="estimate"><br>
</td>
<td class="gt_row gt_center" headers="conf.low"><br>
</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Control</td>
<td class="gt_row gt_center" headers="estimate">—</td>
<td class="gt_row gt_center" headers="conf.low">—</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Treatment</td>
<td class="gt_row gt_center" headers="estimate">21.5</td>
<td class="gt_row gt_center" headers="conf.low">18.4, 24.6</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">baseline</td>
<td class="gt_row gt_center" headers="estimate">1.09</td>
<td class="gt_row gt_center" headers="conf.low">0.94, 1.25</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
</tbody><tfoot class="gt_sourcenotes">
<tr class="odd">
<td colspan="4" class="gt_sourcenote">Abbreviation: CI = Confidence Interval</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p>Interpretation: After adjusting for baseline differences, mean <code>time2</code> increased by `res$ units for those receiving the treatment compared with those who did not receive the treatment. We can see this here:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required libraries</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'plotly'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggplot2':

    last_plot</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    filter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:graphics':

    layout</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>mean_baseline <span class="ot">=</span> <span class="fu">mean</span>(data<span class="sc">$</span>baseline)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate predictions at mean baseline for each group</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>pred1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(res, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">group =</span> <span class="fu">levels</span>(data<span class="sc">$</span>group)[<span class="dv">1</span>], <span class="at">baseline =</span> mean_baseline))</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>pred2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(res, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">group =</span> <span class="fu">levels</span>(data<span class="sc">$</span>group)[<span class="dv">2</span>], <span class="at">baseline =</span> mean_baseline))</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> baseline, <span class="at">y =</span> time2, <span class="at">color =</span> group)) <span class="sc">+</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add points</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add regression lines for each group</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add vertical line at mean baseline</span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> mean_baseline, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add points for the endpoints of the vertical line (these will be invisible)</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> mean_baseline, <span class="at">y =</span> pred1, </span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>                <span class="at">text =</span> <span class="fu">paste</span>(<span class="st">"Group:"</span>, <span class="fu">levels</span>(data<span class="sc">$</span>group)[<span class="dv">1</span>], </span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"&lt;br&gt;Baseline:"</span>, <span class="fu">round</span>(mean_baseline, <span class="dv">2</span>),</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"&lt;br&gt;Predicted Time2:"</span>, <span class="fu">round</span>(pred1, <span class="dv">2</span>))),</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> mean_baseline, <span class="at">y =</span> pred2,</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>                <span class="at">text =</span> <span class="fu">paste</span>(<span class="st">"Group:"</span>, <span class="fu">levels</span>(data<span class="sc">$</span>group)[<span class="dv">2</span>], </span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"&lt;br&gt;Baseline:"</span>, <span class="fu">round</span>(mean_baseline, <span class="dv">2</span>),</span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"&lt;br&gt;Predicted Time2:"</span>, <span class="fu">round</span>(pred2, <span class="dv">2</span>))),</span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add the vertical line showing difference between groups at mean baseline</span></span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> mean_baseline, </span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">xend =</span> mean_baseline,</span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> pred1,</span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">yend =</span> pred2,</span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"red"</span>, </span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">ends =</span> <span class="st">"both"</span>, <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">"inches"</span>))</span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Customize the plot</span></span>
<span id="cb42-43"><a href="#cb42-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb42-44"><a href="#cb42-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Time2 vs Baseline by Group"</span>,</span>
<span id="cb42-45"><a href="#cb42-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Vertical line shows difference between groups at mean baseline ("</span>, </span>
<span id="cb42-46"><a href="#cb42-46" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">round</span>(mean_baseline, <span class="dv">2</span>), <span class="st">")"</span>, <span class="at">sep =</span> <span class="st">""</span>),</span>
<span id="cb42-47"><a href="#cb42-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Baseline"</span>,</span>
<span id="cb42-48"><a href="#cb42-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Time2"</span>,</span>
<span id="cb42-49"><a href="#cb42-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Group"</span></span>
<span id="cb42-50"><a href="#cb42-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb42-51"><a href="#cb42-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-52"><a href="#cb42-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Clean theme</span></span>
<span id="cb42-53"><a href="#cb42-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb42-54"><a href="#cb42-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb42-55"><a href="#cb42-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb42-56"><a href="#cb42-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">color =</span> <span class="st">"gray40"</span>),</span>
<span id="cb42-57"><a href="#cb42-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span></span>
<span id="cb42-58"><a href="#cb42-58" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_point(aes(x = mean_baseline, y = pred1, text = paste("Group:",
: Ignoring unknown aesthetics: text</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_point(aes(x = mean_baseline, y = pred2, text = paste("Group:",
: Ignoring unknown aesthetics: text</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to plotly for interactive tooltips</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p, <span class="at">tooltip =</span> <span class="st">"text"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"Time2 vs Baseline by Group&lt;br&gt;&lt;sub&gt;Vertical line shows difference between groups at mean baseline&lt;/sub&gt;"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Use of `data$group` is discouraged.
ℹ Use `group` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_point(aes(x = mean_baseline, y = pred1, text = paste("Group:", : All aesthetics have length 1, but the data has 150 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Use of `data$group` is discouraged.
ℹ Use `group` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_point(aes(x = mean_baseline, y = pred2, text = paste("Group:", : All aesthetics have length 1, but the data has 150 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-ad58baa06881bace08f0" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-ad58baa06881bace08f0">{"x":{"data":[{"x":[39.091448859933372,57.195597328716019,44.617888087536684,55.339686512854527,66.809107427513652,56.15878816772662,59.100071269435553,52.467592141819047,49.408971593528527,70.792876164184406,55.670929322066016,31.934082556986912,43.442126082309194,58.29430980215276,60.043556544438211,62.464289127504671,54.29454467442585,29.489652441449319,45.057809851850955,36.465543575310328,46.322648013804447,50.450873332197226,46.553181332281099,63.466953036448835,45.718145883553888,50.890802788260089,48.168810482902963,49.116513207154448,39.134518291847108,40.70747091568272,42.514367149560982,33.48211303176484,53.463714713667521,52.665568949763561,40.917761319802985,54.642981705007131,64.945825882238452,55.837764508928778,35.698602153132533,50.473333841850732,45.870592703527755,68.096458762769259,51.563309779134741,61.592185334788049,48.412001517474998,52.248675075927942,40.513036977656483,40.400551882666363,58.035947763977994,51.156205519372108,37.211830353897454,49.632255663594961,42.366713086166627,50.89122459300205,44.683868494770017,39.794599703190855,54.839381839994275,38.642749667134495,45.557798621330903,53.626081288138508,53.29139625132381,67.76122791696109,40.469143690131332,40.718100967065709,67.370013663621563,57.640533862930994,49.889085624959471,58.206774011003553,55.232920027701056,57.436352985342658,41.584635122705542,33.577885813967427,46.989643529472531,59.06320607776415,48.873974892101764],"y":[39.894552086995759,62.173769151954964,47.499304486170303,57.808716546574125,61.251244628435401,54.372176295720443,64.65970958205736,51.657878202281523,48.808364138857712,67.389314878866273,63.342730463663898,32.81464229871537,42.921585468459568,53.422879289934855,66.557691129684898,71.493977660539272,50.841893285508512,29.003015331066713,42.50310633806366,26.698215605940529,50.369849567162433,54.632559096431109,55.127066273467996,60.183109581628663,53.12450297060002,45.914189120877886,55.166882739167363,45.943259302838683,40.779217660924445,47.820289095094495,40.847140561923325,28.611529011184174,54.904201357589272,49.463281617110049,39.191204270918455,56.798612869883769,60.920020831181404,55.011654733642644,32.369550093762356,44.175722414789504,38.512507995944709,67.752746199076043,45.480669993012285,65.99955266425107,56.852146642931956,48.192126743637552,39.488182531687137,38.604151623570459,62.21415564316402,51.947899410060124,35.780451747826881,46.85098486808279,37.524309291873813,48.619550982321208,41.320537603194104,43.753330843945136,56.230022509802744,31.626244216654616,50.666443771448201,56.925805118085862,51.281385671824147,68.996667288619577,41.648745342648198,36.770086079028232,70.492668231150517,55.559890396757069,52.908677141377723,53.147657499116022,56.371478369553756,63.750518363364428,38.176566020127638,22.998043836934965,41.954319849779914,60.166131836131157,50.301044878509266],"text":"","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":0.59999999999999998,"size":7.559055118110237,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"Control","legendgroup":"Control","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[54.544783414475354,60.117174613764853,56.431568933797614,58.84627493277636,49.783549656919568,50.837846831176435,57.59919592419223,43.52943280506787,45.223709936846802,11.009853015745517,48.31842271383659,59.25869200179163,67.974007978395676,70.310728816133732,48.489868720644985,42.512038812257245,54.88326560542847,56.405941014223842,48.799051942841601,43.512458161111766,43.161358165723044,56.308155607246569,57.875665905969143,25.700525336313898,68.41268911988989,42.836184525524757,42.674071531278429,57.000043010715586,46.06045015116942,48.614554776461802,48.583437638522227,47.546176110927966,51.923728272464459,45.551800061833184,48.365860164748646,52.898469290489061,51.535105933225545,39.66116497884115,50.445528646226855,57.131331372741784,48.200190257762159,46.049174315503436,50.900426120616693,44.507709620633833,56.065499053873566,60.454694756949671,58.240160682682216,55.475912640715293,58.253146008527985,58.986550878891968,50.004759719289325,51.335845973073013,35.189146814208911,58.732912752504745,72.575455302915387,71.790093903094743,45.96473058243275,37.857875871030735,34.828845937596952,36.834601836805582,60.270654043153222,44.707278694872031,37.300796823017677,61.006772792769837,54.590609317739677,55.038630309237845,42.845709970693505,57.98146229832787,68.541896333890961,35.401115665219841,41.390192968554686,37.52050409528232,44.390082253974214,40.474855981453111,61.99351015494193],"y":[68.37596348684005,99.115809665626429,119.40570799530298,90.141627331555725,78.832639317614181,64.137817940691008,92.47864587933968,84.717296774532258,62.00977787831863,28.221550715842074,53.179941932769211,80.846984807549973,70.84303610613162,100.52183432668431,62.659989338322873,55.872705175600778,69.62319355293036,85.60029428579189,77.839070689907544,92.534243524928343,70.495794205327215,74.678164211330284,98.633825810592455,40.726079026584458,71.76531244736114,71.092073819765744,47.987790287849435,88.8687044763508,60.580874612200894,55.376077631174404,52.367538031591067,72.892325792144675,79.487087218836265,77.861218685776223,69.090307419791074,81.766326773137152,65.89853807691,49.996553463821272,63.539701061971904,87.687004679778525,65.949454910043727,60.177378834678109,74.186515441746096,53.345877000491818,103.54078937552637,67.470919180218146,91.991934122342172,68.307001987744087,69.319428772917277,78.372780197369011,87.474910290923958,84.552678499867696,45.901137361401766,71.691195858573025,94.620151626663713,81.043549287147727,39.514446111722265,60.902809898724897,63.080968834316458,36.932795721616706,102.51581413364364,59.901326199722874,49.061741374559489,94.593034188962008,85.414144789985158,74.187571163681497,71.672460102062985,73.169621739198149,77.301835160503572,68.284070393627005,46.598846862115579,59.040164111459433,74.199463692518876,68.209343918710985,69.031466605994041],"text":"","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","opacity":0.59999999999999998,"size":7.559055118110237,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)"}},"hoveron":"points","name":"Treatment","legendgroup":"Treatment","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[29.489652441449319,30.012478058192801,30.535303674936284,31.058129291679766,31.580954908423248,32.103780525166727,32.626606141910209,33.149431758653691,33.672257375397173,34.195082992140655,34.717908608884137,35.240734225627619,35.763559842371102,36.286385459114584,36.809211075858066,37.332036692601548,37.85486230934503,38.377687926088512,38.900513542831995,39.423339159575477,39.946164776318959,40.468990393062441,40.991816009805923,41.514641626549405,42.037467243292888,42.56029286003637,43.083118476779852,43.605944093523334,44.128769710266816,44.651595327010298,45.17442094375378,45.697246560497263,46.220072177240745,46.742897793984227,47.265723410727709,47.788549027471191,48.311374644214673,48.834200260958156,49.357025877701638,49.87985149444512,50.402677111188602,50.925502727932084,51.448328344675566,51.971153961419049,52.493979578162531,53.016805194906013,53.539630811649495,54.062456428392977,54.585282045136452,55.108107661879941,55.630933278623417,56.153758895366906,56.676584512110381,57.19941012885387,57.722235745597345,58.245061362340834,58.767886979084309,59.290712595827799,59.813538212571274,60.336363829314763,60.859189446058238,61.382015062801727,61.904840679545202,62.427666296288692,62.950491913032167,63.473317529775656,63.996143146519131,64.51896876326262,65.041794380006095,65.564619996749585,66.08744561349306,66.610271230236549,67.133096846980024,67.655922463723513,68.178748080466988,68.701573697210478,69.224399313953953,69.747224930697442,70.270050547440917,70.792876164184406],"y":[27.416309428014287,27.98828408994757,28.560258751880848,29.132233413814127,29.704208075747406,30.276182737680681,30.84815739961396,31.420132061547243,31.992106723480521,32.5640813854138,33.136056047347083,33.708030709280358,34.28000537121364,34.851980033146916,35.423954695080198,35.995929357013473,36.567904018946756,37.139878680880038,37.711853342813313,38.283828004746596,38.855802666679871,39.427777328613153,39.999751990546429,40.571726652479711,41.143701314412993,41.715675976346269,42.287650638279551,42.859625300212826,43.431599962146109,44.003574624079391,44.575549286012667,45.147523947945949,45.719498609879224,46.291473271812507,46.863447933745782,47.435422595679064,48.007397257612347,48.579371919545622,49.151346581478904,49.72332124341218,50.295295905345462,50.867270567278744,51.43924522921202,52.011219891145302,52.583194553078577,53.15516921501186,53.727143876945135,54.299118538878417,54.871093200811686,55.443067862744975,56.01504252467825,56.587017186611533,57.158991848544808,57.73096651047809,58.302941172411366,58.874915834344655,59.446890496277923,60.018865158211213,60.590839820144481,61.162814482077771,61.734789144011039,62.306763805944328,62.878738467877604,63.450713129810886,64.022687791744161,64.594662453677444,65.166637115610712,65.738611777544008,66.310586439477277,66.882561101410559,67.454535763343841,68.026510425277124,68.598485087210392,69.170459749143689,69.742434411076957,70.314409073010239,70.886383734943507,71.458358396876804,72.030333058810072,72.602307720743354],"text":"","type":"scatter","mode":"lines","name":"Control","line":{"width":3.7795275590551185,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","legendgroup":"Control","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[11.009853015745517,11.789164437102098,12.568475858458678,13.347787279815257,14.127098701171839,14.90641012252842,15.685721543885,16.46503296524158,17.244344386598161,18.023655807954743,18.802967229311321,19.582278650667902,20.361590072024484,21.140901493381065,21.920212914737647,22.699524336094225,23.478835757450806,24.258147178807388,25.037458600163966,25.816770021520547,26.596081442877129,27.37539286423371,28.154704285590288,28.93401570694687,29.713327128303451,30.492638549660033,31.271949971016614,32.051261392373192,32.830572813729773,33.609884235086355,34.389195656442936,35.168507077799518,35.947818499156099,36.727129920512681,37.506441341869262,38.285752763225837,39.065064184582418,39.844375605939,40.623687027295574,41.402998448652156,42.182309870008737,42.961621291365319,43.7409327127219,44.520244134078482,45.299555555435063,46.078866976791645,46.858178398148226,47.637489819504808,48.416801240861389,49.196112662217971,49.975424083574552,50.754735504931134,51.534046926287715,52.313358347644282,53.092669769000864,53.871981190357445,54.651292611714027,55.430604033070608,56.20991545442719,56.989226875783771,57.768538297140353,58.547849718496934,59.327161139853516,60.106472561210097,60.885783982566679,61.66509540392326,62.444406825279842,63.223718246636423,64.003029667993005,64.782341089349572,65.561652510706153,66.340963932062735,67.120275353419316,67.899586774775898,68.678898196132479,69.458209617489061,70.237521038845642,71.016832460202224,71.796143881558805,72.575455302915387],"y":[28.685578688101774,29.537869466703778,30.390160245305783,31.242451023907787,32.094741802509795,32.947032581111799,33.799323359713803,34.651614138315807,35.503904916917811,36.356195695519816,37.20848647412182,38.060777252723824,38.913068031325828,39.765358809927832,40.617649588529837,41.469940367131841,42.322231145733845,43.174521924335849,44.026812702937853,44.879103481539858,45.731394260141862,46.583685038743866,47.43597581734587,48.288266595947874,49.140557374549878,49.99284815315189,50.845138931753894,51.697429710355891,52.549720488957902,53.402011267559907,54.254302046161911,55.106592824763915,55.958883603365919,56.81117438196793,57.663465160569935,58.515755939171932,59.368046717773936,60.22033749637594,61.072628274977937,61.924919053579941,62.777209832181953,63.629500610783957,64.481791389385961,65.334082167987972,66.18637294658997,67.038663725191981,67.890954503793978,68.743245282395989,69.595536060998,70.447826839599998,71.300117618202009,72.152408396804006,73.004699175406017,73.856989954008,74.709280732610011,75.561571511212023,76.41386228981402,77.266153068416031,78.118443847018028,78.97073462562004,79.823025404222051,80.675316182824048,81.527606961426059,82.379897740028056,83.232188518630068,84.084479297232065,84.936770075834076,85.789060854436087,86.641351633038084,87.493642411640081,88.345933190242079,89.19822396884409,90.050514747446101,90.902805526048098,91.75509630465011,92.607387083252107,93.459677861854118,94.311968640456115,95.164259419058126,96.016550197660138],"text":"","type":"scatter","mode":"lines","name":"Treatment","line":{"width":3.7795275590551185,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","legendgroup":"Treatment","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[29.489652441449319,30.012478058192801,30.535303674936284,31.058129291679766,31.580954908423248,32.103780525166727,32.626606141910209,33.149431758653691,33.672257375397173,34.195082992140655,34.717908608884137,35.240734225627619,35.763559842371102,36.286385459114584,36.809211075858066,37.332036692601548,37.85486230934503,38.377687926088512,38.900513542831995,39.423339159575477,39.946164776318959,40.468990393062441,40.991816009805923,41.514641626549405,42.037467243292888,42.56029286003637,43.083118476779852,43.605944093523334,44.128769710266816,44.651595327010298,45.17442094375378,45.697246560497263,46.220072177240745,46.742897793984227,47.265723410727709,47.788549027471191,48.311374644214673,48.834200260958156,49.357025877701638,49.87985149444512,50.402677111188602,50.925502727932084,51.448328344675566,51.971153961419049,52.493979578162531,53.016805194906013,53.539630811649495,54.062456428392977,54.585282045136452,55.108107661879941,55.630933278623417,56.153758895366906,56.676584512110381,57.19941012885387,57.722235745597345,58.245061362340834,58.767886979084309,59.290712595827799,59.813538212571274,60.336363829314763,60.859189446058238,61.382015062801727,61.904840679545202,62.427666296288692,62.950491913032167,63.473317529775656,63.996143146519131,64.51896876326262,65.041794380006095,65.564619996749585,66.08744561349306,66.610271230236549,67.133096846980024,67.655922463723513,68.178748080466988,68.701573697210478,69.224399313953953,69.747224930697442,70.270050547440917,70.792876164184406,70.792876164184406,70.270050547440917,69.747224930697442,69.224399313953953,68.701573697210478,68.178748080466988,67.655922463723513,67.133096846980024,66.610271230236549,66.08744561349306,65.564619996749585,65.041794380006095,64.51896876326262,63.996143146519131,63.473317529775656,62.950491913032167,62.427666296288692,61.904840679545202,61.382015062801727,60.859189446058238,60.336363829314763,59.813538212571274,59.290712595827799,58.767886979084309,58.245061362340834,57.722235745597345,57.19941012885387,56.676584512110381,56.153758895366906,55.630933278623417,55.108107661879941,54.585282045136452,54.062456428392977,53.539630811649495,53.016805194906013,52.493979578162531,51.971153961419049,51.448328344675566,50.925502727932084,50.402677111188602,49.87985149444512,49.357025877701638,48.834200260958156,48.311374644214673,47.788549027471191,47.265723410727709,46.742897793984227,46.220072177240745,45.697246560497263,45.17442094375378,44.651595327010298,44.128769710266816,43.605944093523334,43.083118476779852,42.56029286003637,42.037467243292888,41.514641626549405,40.991816009805923,40.468990393062441,39.946164776318959,39.423339159575477,38.900513542831995,38.377687926088512,37.85486230934503,37.332036692601548,36.809211075858066,36.286385459114584,35.763559842371102,35.240734225627619,34.717908608884137,34.195082992140655,33.672257375397173,33.149431758653691,32.626606141910209,32.103780525166727,31.580954908423248,31.058129291679766,30.535303674936284,30.012478058192801,29.489652441449319,29.489652441449319],"y":[24.947918491916987,25.572003621183676,26.195844232966355,26.819423876913461,27.442724687812635,28.065727242305933,28.688410399763942,29.310751125611038,29.932724295269992,30.554302476788596,31.175455690138005,31.796151141152897,32.416352928144022,33.036021719391691,33.655114400074652,34.27358368776612,34.891377716523749,35.508439590917298,36.124706913210183,36.740111289495154,37.354577824062119,37.968024615842971,38.580362276624157,39.191493497995289,39.801312702762502,40.409705826671676,41.016550287325913,41.621715208263872,42.225061975796358,42.826445212136093,43.425714247574419,44.022715163316391,44.617293451326333,45.209297295225241,45.798581416164431,46.385011352674539,46.968467961752417,47.548851853092309,48.126087416130396,48.70012608700236,49.270948540790279,49.838565584476086,50.403017656129684,50.964372983526786,51.522724593124025,52.078186463458799,52.630889170446309,53.18097537313438,53.728595445942737,54.273903492837,54.817053897417843,55.358198485000322,55.897484307935201,56.435052018005088,56.971034759862256,57.505557504695851,58.038736739982497,58.570680435546144,59.101488214997687,59.631251672478577,60.160054785796085,60.687974387477801,61.215080664440571,61.741437664669022,62.267103795537729,62.792132303322781,63.316571727214864,63.840466323964598,64.363856461347453,64.886778980096778,65.409267524954728,65.931352846150389,66.453063073017788,66.974423961686298,67.495459118866094,68.016190203750853,68.536637109999688,69.056818129662631,69.576750100793646,70.096448540364833,75.108166901121876,74.483916016826498,73.859898664090977,73.236130359887326,72.612627942269626,71.989409703287819,71.366495536601079,70.743907101402996,70.121668004403858,69.499804001732954,68.87834322272434,68.2573164176071,67.636757231123426,67.01670250400656,66.397192604032099,65.778271787950587,65.15998859495275,64.542396271314644,63.925553224410855,63.309523502225993,62.694377291676965,62.080191425291275,61.467049880876282,60.85504425257335,60.24427416399346,59.634847584960475,59.026881002951093,58.420499389154415,57.815835888222743,57.213031151938658,56.61223223265295,56.013590955680634,55.417261704622454,54.823398583443961,54.232151966564921,53.64366451303313,53.058066798763818,52.475472802294355,51.895975550081403,51.319643269900645,50.746516399821999,50.176605746827413,49.609891985998935,49.046326553472277,48.48583383868359,47.928314451327132,47.373649248399772,46.821703768432116,46.272332732575506,45.725384324450914,45.180704036022689,44.63813794849586,44.097535392161781,43.558750989233189,43.021646126020862,42.486089926063485,41.951959806964133,41.4191417044687,40.887530041383336,40.357027509297623,39.827544719998038,39.298999772416444,38.771317770842778,38.244430321369762,37.718275026260827,37.192794990085744,36.66793834690214,36.143657814283259,35.619910277407818,35.096656404556164,34.573860294039001,34.051489151691051,33.529512997483451,33.007904399463975,32.48663823305543,31.965691463682177,31.445042950714793,30.924673270795342,30.404564558711463,29.884700364111588,24.947918491916987],"text":"","type":"scatter","mode":"lines","line":{"width":3.7795275590551185,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(153,153,153,0.2)","hoveron":"points","hoverinfo":"x+y","name":"Control","legendgroup":"Control","showlegend":false,"xaxis":"x","yaxis":"y","frame":null},{"x":[11.009853015745517,11.789164437102098,12.568475858458678,13.347787279815257,14.127098701171839,14.90641012252842,15.685721543885,16.46503296524158,17.244344386598161,18.023655807954743,18.802967229311321,19.582278650667902,20.361590072024484,21.140901493381065,21.920212914737647,22.699524336094225,23.478835757450806,24.258147178807388,25.037458600163966,25.816770021520547,26.596081442877129,27.37539286423371,28.154704285590288,28.93401570694687,29.713327128303451,30.492638549660033,31.271949971016614,32.051261392373192,32.830572813729773,33.609884235086355,34.389195656442936,35.168507077799518,35.947818499156099,36.727129920512681,37.506441341869262,38.285752763225837,39.065064184582418,39.844375605939,40.623687027295574,41.402998448652156,42.182309870008737,42.961621291365319,43.7409327127219,44.520244134078482,45.299555555435063,46.078866976791645,46.858178398148226,47.637489819504808,48.416801240861389,49.196112662217971,49.975424083574552,50.754735504931134,51.534046926287715,52.313358347644282,53.092669769000864,53.871981190357445,54.651292611714027,55.430604033070608,56.20991545442719,56.989226875783771,57.768538297140353,58.547849718496934,59.327161139853516,60.106472561210097,60.885783982566679,61.66509540392326,62.444406825279842,63.223718246636423,64.003029667993005,64.782341089349572,65.561652510706153,66.340963932062735,67.120275353419316,67.899586774775898,68.678898196132479,69.458209617489061,70.237521038845642,71.016832460202224,71.796143881558805,72.575455302915387,72.575455302915387,72.575455302915387,71.796143881558805,71.016832460202224,70.237521038845642,69.458209617489061,68.678898196132479,67.899586774775898,67.120275353419316,66.340963932062735,65.561652510706153,64.782341089349572,64.003029667993005,63.223718246636423,62.444406825279842,61.66509540392326,60.885783982566679,60.106472561210097,59.327161139853516,58.547849718496934,57.768538297140353,56.989226875783771,56.20991545442719,55.430604033070608,54.651292611714027,53.871981190357445,53.092669769000864,52.313358347644282,51.534046926287715,50.754735504931134,49.975424083574552,49.196112662217971,48.416801240861389,47.637489819504808,46.858178398148226,46.078866976791645,45.299555555435063,44.520244134078482,43.7409327127219,42.961621291365319,42.182309870008737,41.402998448652156,40.623687027295574,39.844375605939,39.065064184582418,38.285752763225837,37.506441341869262,36.727129920512681,35.947818499156099,35.168507077799518,34.389195656442936,33.609884235086355,32.830572813729773,32.051261392373192,31.271949971016614,30.492638549660033,29.713327128303451,28.93401570694687,28.154704285590288,27.37539286423371,26.596081442877129,25.816770021520547,25.037458600163966,24.258147178807388,23.478835757450806,22.699524336094225,21.920212914737647,21.140901493381065,20.361590072024484,19.582278650667902,18.802967229311321,18.023655807954743,17.244344386598161,16.46503296524158,15.685721543885,14.90641012252842,14.127098701171839,13.347787279815257,12.568475858458678,11.789164437102098,11.009853015745517,11.009853015745517],"y":[17.109645842970409,18.175285024328737,19.240630803705791,20.305666034158918,21.370372234149293,22.434729458130285,23.498716152174701,24.562308992645193,25.625482705613312,26.688209864385072,27.7504606620858,28.812202655784759,29.873400478088982,30.934015511491918,31.994005520010752,33.053324231767867,34.111920865146175,35.169739589951767,36.226718913623472,37.282790980910121,38.337880773562169,39.391905194425938,40.444772017861204,41.496378685608839,42.546610924116749,43.595341155919343,44.642426674040458,45.68770754471236,46.731004200260266,47.772114681265201,48.810811485843111,49.846837985222777,50.879904370511902,51.90968310814749,52.935803904641922,53.957848219816775,54.97534342829475,55.987756819704245,56.994489758012442,57.994872498325172,58.988160390267566,59.973532475807531,60.950093792118636,61.916882961471899,62.872886791590403,63.817063475995468,64.748375401247515,65.665831392489409,66.568536446246185,67.455744843812667,68.326910552555333,69.181727763548821,70.020154959236152,70.842418257126653,71.648993419808718,72.440569758242859,73.218001993888976,73.982257256427914,74.734363771014287,75.475366003928272,76.206288860582362,76.928111593456165,77.641750707400433,78.348050396289722,79.047778791636404,79.74162837791674,80.430219173500205,81.114103576861893,81.793772067641427,82.469659198844894,83.142149510463099,83.811583138668965,84.478260996532129,85.142449471104143,85.804384626306629,86.46427592833173,87.122309525665173,87.778651123356354,88.433448493631332,89.08683366432804,89.08683366432804,102.94626673099224,101.89507034448492,100.84528615755588,99.797046198043063,98.750498238172483,97.705807982993591,96.663161580992053,95.622768498360074,94.584864799019215,93.549716870021058,92.517625624435269,91.488931198434742,90.464018132010281,89.443320978167947,88.427330216547389,87.416598245623732,86.411745083766391,85.413463215451685,84.42252077219193,83.43976194786174,82.466103247311807,81.502523923021769,80.550048880404148,79.609722585739064,78.682573264181187,77.769568045411305,76.871561650889348,75.989243391575883,75.123089030059191,74.273324683848685,73.439908835387328,72.622535675749816,71.82065917230257,71.033533606340441,70.260263974388494,69.499859101589536,68.751281374504046,68.013488986653286,67.285468745760383,66.566259274096339,65.854965608834718,65.150766791943425,64.452918173047635,63.760750007253122,63.073663658527089,62.391126416497947,61.712665655788371,61.037862836219936,60.366347664305053,59.697792606480711,59.031907853854612,58.368436777655539,57.707151875999422,57.04785118946733,56.390355150384437,55.734503824983008,55.08015450628691,54.427179616830536,53.775464883061794,53.124907746721554,52.475415982169594,51.826906492252235,51.179304258719931,50.532541426321515,49.886556502495814,49.241293657048921,48.596702108363743,47.952735584562674,47.309351849662889,46.66651228615784,46.024181526654559,45.382327128222315,44.740919283986422,44.099930567252905,43.459335704093313,42.819111370870296,42.179236013656656,41.539689686905774,40.90045390907882,40.26151153323314,17.109645842970409],"text":"","type":"scatter","mode":"lines","line":{"width":3.7795275590551185,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(153,153,153,0.2)","hoveron":"points","hoverinfo":"x+y","name":"Treatment","legendgroup":"Treatment","showlegend":false,"xaxis":"x","yaxis":"y","frame":null},{"x":[50.219514375340935,50.219514375340935],"y":[11.99484273535378,124.5205111029196],"text":"","type":"scatter","mode":"lines","line":{"width":3.0236220472440949,"color":"rgba(0,0,0,1)","dash":"dash"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935],"y":[50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033,50.094861221245033],"text":"Group: Control <br>Baseline: 50.22 <br>Predicted Time2: 50.09","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(255,0,0,1)","opacity":0.80000000000000004,"size":11.338582677165356,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(255,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935,50.219514375340935],"y":[71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544,71.567023678148544],"text":"Group: Treatment <br>Baseline: 50.22 <br>Predicted Time2: 71.57","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(255,0,0,1)","opacity":0.80000000000000004,"size":11.338582677165356,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(255,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935,null,50.219514375340935,50.219514375340935],"y":[50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544,null,50.094861221245033,71.567023678148544],"text":"","type":"scatter","mode":"lines","line":{"width":7.559055118110237,"color":"rgba(255,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":44.825238688252384,"r":7.3059360730593621,"b":40.182648401826498,"l":43.105022831050235},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Time2 vs Baseline by Group<br><sub>Vertical line shows difference between groups at mean baseline<\/sub>","font":{"color":"rgba(0,0,0,1)","family":"","size":18.596928185969279},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[7.9315729013870229,75.653735417273879],"tickmode":"array","ticktext":["20","40","60"],"tickvals":[20,40,60],"categoryorder":"array","categoryarray":["20","40","60"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Baseline","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[11.99484273535378,124.5205111029196],"tickmode":"array","ticktext":["25","50","75","100"],"tickvals":[25,50,75,100],"categoryorder":"array","categoryarray":["25","50","75","100"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Time2","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Group","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"6c7e15606cc2":{"x":{},"y":{},"colour":{},"type":"scatter"},"6c7e6d843f84":{"x":{},"y":{},"colour":{}},"6c7e5662b48":{"xintercept":{}},"6c7e76a386bc":{"x":{},"y":{},"text":{}},"6c7e69e2dd7d":{"x":{},"y":{},"text":{}},"6c7e2d3b6fda":{"x":{},"y":{},"colour":{}}},"cur_data":"6c7e15606cc2","visdat":{"6c7e15606cc2":["function (y) ","x"],"6c7e6d843f84":["function (y) ","x"],"6c7e5662b48":["function (y) ","x"],"6c7e76a386bc":["function (y) ","x"],"6c7e69e2dd7d":["function (y) ","x"],"6c7e2d3b6fda":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Recall that the treatment effect in this model is proportional to the baseline value and increased by <code>severity</code>, a latent variable. The average treatment effect reported in the analysis above is the average across all baseline values in the model.</p>
</section>
<section id="simulate-proportional-treatment-effect-on-change-from-baseline-in-an-rct-with-censoring" class="level2">
<h2 class="anchored" data-anchor-id="simulate-proportional-treatment-effect-on-change-from-baseline-in-an-rct-with-censoring">Simulate proportional treatment effect on change from baseline in an RCT with censoring</h2>
<p>For data with censoring and proportional treatment effects:</p>
<p>This simulation is identical to the one above, but with some subjects dropping out of the study prior to time2 being measured. Changes noted in bold.</p>
<p>- <code>severity</code> is latent variable that affects:</p>
<ol type="a">
<li><p>Baseline scores (sicker patients have lower scores)</p></li>
<li><p>Treatment effect (treatment works better for sicker patients)</p></li>
<li><p><strong>Censoring probability (sicker patients more likely to drop out)</strong></p></li>
</ol>
<p>- <strong>Treatment group participants are less likely to be censored</strong></p>
<p><strong>- Participants with less improvement are more likely to be censored</strong></p>
<p>The Causal DAG for this data generating model is shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dagitty)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdag)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the DAG using dagify</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>dag1 <span class="ot">&lt;-</span> <span class="fu">dagify</span>(</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  baseline <span class="sc">~</span> severity,</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  time1 <span class="sc">~</span> baseline <span class="sc">+</span> group <span class="sc">+</span> severity,</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  change1 <span class="sc">~</span> baseline <span class="sc">+</span> time1,</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  censored <span class="sc">~</span> change1 <span class="sc">+</span> group <span class="sc">+</span> severity,</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  time2 <span class="sc">~</span> group <span class="sc">+</span> time1 <span class="sc">+</span> severity,</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="st">"group"</span>,</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="st">"time2"</span>,</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">coords =</span> <span class="fu">data.frame</span>(</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="fu">c</span>(<span class="st">"baseline"</span>, <span class="st">"severity"</span>, <span class="st">"group"</span>, <span class="st">"time1"</span>, <span class="st">"change1"</span>, <span class="st">"censored"</span>, <span class="st">"time2"</span>),</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="fl">1.5</span>, <span class="dv">8</span>, <span class="fl">5.5</span>),</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Indicate that `censored` is adjusted since we only have data for patients who are not censored, censored is forced to equal 0</span></span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a><span class="fu">adjustedNodes</span>(dag1) <span class="ot">&lt;-</span> <span class="st">"censored"</span></span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dag1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Baseline-Change_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">#List all paths from treatment `group` to outcome `time2`</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co"># `paths` currently ignores the adjusted nodes when determining which paths are open, so we have to specify adjusted nodes in the call</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">paths</span>(dag1, <span class="at">Z =</span> <span class="fu">adjustedNodes</span>(dag1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$paths
 [1] "group -&gt; censored &lt;- change1 &lt;- baseline -&gt; time1 -&gt; time2"            
 [2] "group -&gt; censored &lt;- change1 &lt;- baseline -&gt; time1 &lt;- severity -&gt; time2"
 [3] "group -&gt; censored &lt;- change1 &lt;- baseline &lt;- severity -&gt; time1 -&gt; time2"
 [4] "group -&gt; censored &lt;- change1 &lt;- baseline &lt;- severity -&gt; time2"         
 [5] "group -&gt; censored &lt;- change1 &lt;- time1 -&gt; time2"                        
 [6] "group -&gt; censored &lt;- change1 &lt;- time1 &lt;- baseline &lt;- severity -&gt; time2"
 [7] "group -&gt; censored &lt;- change1 &lt;- time1 &lt;- severity -&gt; time2"            
 [8] "group -&gt; censored &lt;- severity -&gt; baseline -&gt; change1 &lt;- time1 -&gt; time2"
 [9] "group -&gt; censored &lt;- severity -&gt; baseline -&gt; time1 -&gt; time2"           
[10] "group -&gt; censored &lt;- severity -&gt; time1 -&gt; time2"                       
[11] "group -&gt; censored &lt;- severity -&gt; time2"                                
[12] "group -&gt; time1 -&gt; change1 -&gt; censored &lt;- severity -&gt; time2"            
[13] "group -&gt; time1 -&gt; change1 &lt;- baseline &lt;- severity -&gt; time2"            
[14] "group -&gt; time1 -&gt; time2"                                               
[15] "group -&gt; time1 &lt;- baseline -&gt; change1 -&gt; censored &lt;- severity -&gt; time2"
[16] "group -&gt; time1 &lt;- baseline &lt;- severity -&gt; time2"                       
[17] "group -&gt; time1 &lt;- severity -&gt; time2"                                   
[18] "group -&gt; time2"                                                        

$open
 [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE
[16] TRUE TRUE TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the adjustment sets (if any)</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">adjustmentSets</span>(dag1)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>tidy_dag1 <span class="ot">&lt;-</span> <span class="fu">tidy_dagitty</span>(dag1) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">shape =</span> <span class="fu">ifelse</span>(name <span class="sc">==</span> <span class="st">"censored"</span>, <span class="st">"square"</span>, <span class="st">"circle"</span>))</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Indicate that `censored` is adjusted for in this model</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>tidy_dag1 <span class="ot">&lt;-</span> <span class="fu">adjust_for</span>(tidy_dag1, <span class="st">"censored"</span>)</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot with custom node shapes</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the status (exposure, outcome) information</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>status_data <span class="ot">&lt;-</span> <span class="fu">ggdag_status</span>(tidy_dag1)<span class="sc">$</span>data</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>status_data <span class="ot">&lt;-</span> status_data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">gstatus =</span> <span class="fu">as.character</span>(status), <span class="at">gstatus =</span> <span class="fu">ifelse</span>(name <span class="sc">==</span> <span class="st">"censored"</span>, <span class="st">"adjusted"</span>, <span class="fu">as.character</span>(status)), </span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">gstatus =</span> <span class="fu">factor</span>(gstatus,<span class="at">levels =</span> <span class="fu">c</span>(<span class="fu">levels</span>(status), <span class="st">"adjusted"</span>)))</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot with custom node shapes while preserving status coloring</span></span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(status_data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_edges</span>(<span class="at">arrow_directed =</span> grid<span class="sc">::</span><span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"cm"</span>), <span class="at">type =</span> <span class="st">"closed"</span>)) <span class="sc">+</span></span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> gstatus, <span class="at">shape =</span> shape), <span class="at">size =</span> <span class="dv">24</span>) <span class="sc">+</span></span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_text</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="at">circle =</span> <span class="dv">16</span>, <span class="at">square =</span> <span class="dv">15</span>), <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">name =</span> <span class="st">"Status"</span>, <span class="at">na.value =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_dag</span>() <span class="sc">+</span></span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing missing values or values outside the scale range
(`geom_dag_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Baseline-Change_files/figure-html/unnamed-chunk-17-2.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<p>The <code>censored</code> variable is shown with a square around it to indicate that by analyzing only uncensored patients, <code>censored</code> is adjusted for in the analysis. Since all arrows point into <code>censored</code>, any path from treatment <code>group</code> to effect <code>time2</code> that includes <code>censored</code> will transmit spurious association through <code>censored</code> unless the path is blocked at another point.</p>
<p>To see this, lets look at all paths (causal and non-causal) from <code>group</code> to <code>time2</code>. A causal path is one in which arrows point from the treatment <code>group</code> to the outcome <code>time2</code>. Noncausal paths are those with at least one arrow pointing back toward the treatment.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># `paths` currently ignores the adjusted nodes when determining which paths are open, so we have to specify the adjusted nodes in the call</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">paths</span>(dag1, <span class="at">Z =</span> <span class="fu">adjustedNodes</span>(dag1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$paths
 [1] "group -&gt; censored &lt;- change1 &lt;- baseline -&gt; time1 -&gt; time2"            
 [2] "group -&gt; censored &lt;- change1 &lt;- baseline -&gt; time1 &lt;- severity -&gt; time2"
 [3] "group -&gt; censored &lt;- change1 &lt;- baseline &lt;- severity -&gt; time1 -&gt; time2"
 [4] "group -&gt; censored &lt;- change1 &lt;- baseline &lt;- severity -&gt; time2"         
 [5] "group -&gt; censored &lt;- change1 &lt;- time1 -&gt; time2"                        
 [6] "group -&gt; censored &lt;- change1 &lt;- time1 &lt;- baseline &lt;- severity -&gt; time2"
 [7] "group -&gt; censored &lt;- change1 &lt;- time1 &lt;- severity -&gt; time2"            
 [8] "group -&gt; censored &lt;- severity -&gt; baseline -&gt; change1 &lt;- time1 -&gt; time2"
 [9] "group -&gt; censored &lt;- severity -&gt; baseline -&gt; time1 -&gt; time2"           
[10] "group -&gt; censored &lt;- severity -&gt; time1 -&gt; time2"                       
[11] "group -&gt; censored &lt;- severity -&gt; time2"                                
[12] "group -&gt; time1 -&gt; change1 -&gt; censored &lt;- severity -&gt; time2"            
[13] "group -&gt; time1 -&gt; change1 &lt;- baseline &lt;- severity -&gt; time2"            
[14] "group -&gt; time1 -&gt; time2"                                               
[15] "group -&gt; time1 &lt;- baseline -&gt; change1 -&gt; censored &lt;- severity -&gt; time2"
[16] "group -&gt; time1 &lt;- baseline &lt;- severity -&gt; time2"                       
[17] "group -&gt; time1 &lt;- severity -&gt; time2"                                   
[18] "group -&gt; time2"                                                        

$open
 [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE
[16] TRUE TRUE TRUE</code></pre>
</div>
</div>
<p>We see that there are 18 paths from <code>group</code> to <code>time2</code>. $open is a boolean list showing whether each path is open or closed. All of these paths are open and since many of these paths are noncausal “backdoor” paths, meaning the arrows do not all point from <code>group</code> to <code>time2</code> this means that if we measure the association between <code>group</code> and <code>time2</code> in the data, that association is likely to exhibit bias from confounding. For example, paths 1 through 11 are all backdoor paths that go through <code>censored</code>. A collider is a variable on a path in which both arrows point toward it. As you can see, <code>censored</code> is a collider on every path it appears in. Colliders block association when they are not adjusted, but allow association to flow and bias the analysis when they are adjusted.</p>
<p>To properly measure the total causal effect of <code>group</code> on <code>time2</code> we need to measure the association that flows through all paths that point from <code>group</code> to <code>time2</code>. Let’s use <code>paths</code> to list only the causal paths:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paths</span>(dag1, <span class="at">Z =</span> <span class="fu">adjustedNodes</span>(dag1), <span class="at">directed =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$paths
[1] "group -&gt; time1 -&gt; time2" "group -&gt; time2"         

$open
[1] TRUE TRUE</code></pre>
</div>
</div>
<p>There are two causal paths, both open. To measure the total causal effect, we need to block the non-causal open paths by adjusting for variables, if possible. We can use <code>ggdag</code> to list the adjustment sets for the total causal effect of <code>group</code> on <code>time2</code>. This returns nothing because there is no way to adjust variables to block the open path caused through the collider <code>censored.</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adjustmentSets</span>(dag1, <span class="at">effect =</span> <span class="st">"total"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will use IP Weighting for censoring below, but before that, lets analyze this dataset as if there were no loss to follow-up.</p>
</section>
<section id="same-model-with-no-loss-to-follow-up" class="level1">
<h1>Same model with no loss to follow-up</h1>
<p>The same data generating model above includes time2_all with outcome values for all patients. Without Censoring the Causal DAG for time2_all looks like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dagitty)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdag)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the DAG using dagitify</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>dag_noloss <span class="ot">&lt;-</span> <span class="fu">dagify</span>(</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  baseline <span class="sc">~</span> severity,</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  time1 <span class="sc">~</span> baseline <span class="sc">+</span> group <span class="sc">+</span> severity,</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>  change1 <span class="sc">~</span> baseline <span class="sc">+</span> time1,</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>  time2_all <span class="sc">~</span> group <span class="sc">+</span> time1 <span class="sc">+</span> severity,</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="st">"group"</span>,</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="st">"time2_all"</span>,</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">coords =</span> <span class="fu">data.frame</span>(</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="fu">c</span>(<span class="st">"baseline"</span>, <span class="st">"severity"</span>, <span class="st">"group"</span>, <span class="st">"time1"</span>, <span class="st">"change1"</span>, <span class="st">"censored"</span>, <span class="st">"time2_all"</span>),</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="fl">1.5</span>, <span class="dv">8</span>, <span class="fl">5.5</span>),</span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>tidy_dag_noloss <span class="ot">&lt;-</span> <span class="fu">tidy_dagitty</span>(dag_noloss)</span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot with custom node shapes</span></span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the status (exposure, outcome) information</span></span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a>status_data <span class="ot">&lt;-</span> <span class="fu">ggdag_status</span>(tidy_dag_noloss)<span class="sc">$</span>data</span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a>status_data <span class="ot">&lt;-</span> status_data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">gstatus =</span> <span class="fu">as.character</span>(status), <span class="at">gstatus =</span> <span class="fu">ifelse</span>(name <span class="sc">==</span> <span class="st">"censored"</span>, <span class="st">"adjusted"</span>, <span class="fu">as.character</span>(status)), </span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">gstatus =</span> <span class="fu">factor</span>(gstatus,<span class="at">levels =</span> <span class="fu">c</span>(<span class="fu">levels</span>(status), <span class="st">"adjusted"</span>)))</span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot with custom node shapes while preserving status coloring</span></span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(status_data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_edges</span>(<span class="at">arrow_directed =</span> grid<span class="sc">::</span><span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"cm"</span>), <span class="at">type =</span> <span class="st">"closed"</span>)) <span class="sc">+</span></span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> gstatus), <span class="at">size =</span> <span class="dv">24</span>) <span class="sc">+</span></span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_text</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb62-32"><a href="#cb62-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="at">circle =</span> <span class="dv">16</span>, <span class="at">square =</span> <span class="dv">15</span>), <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb62-33"><a href="#cb62-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">name =</span> <span class="st">"Status"</span>, <span class="at">na.value =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb62-34"><a href="#cb62-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_dag</span>() <span class="sc">+</span></span>
<span id="cb62-35"><a href="#cb62-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Baseline-Change_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required libraries</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dagitty)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdag)</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the DAG</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>dag1 <span class="ot">&lt;-</span> <span class="fu">dagitty</span>(<span class="st">'dag {</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="st">bb="0,0,1,1"</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a><span class="st">baseline [pos="0.348,0.542"]</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a><span class="st">censored [adjusted,pos="0.931,0.499"]</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a><span class="st">change1 [pos="0.477,0.641"]</span></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a><span class="st">group [exposure,pos="0.343,0.368"]</span></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a><span class="st">severity [pos="0.348,0.449"]</span></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a><span class="st">time1 [pos="0.486,0.540"]</span></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a><span class="st">time2 [outcome,pos="0.605,0.539"]</span></span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a><span class="st">baseline -&gt; change1</span></span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a><span class="st">baseline -&gt; time1</span></span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a><span class="st">change1 -&gt; censored</span></span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a><span class="st">group -&gt; censored</span></span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a><span class="st">group -&gt; time1</span></span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a><span class="st">group -&gt; time2</span></span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a><span class="st">severity -&gt; baseline</span></span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a><span class="st">severity -&gt; censored</span></span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a><span class="st">severity -&gt; time1</span></span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a><span class="st">severity -&gt; time2</span></span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a><span class="st">time1 -&gt; change1</span></span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a><span class="st">time1 -&gt; time2</span></span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a><span class="st">}'</span></span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dag1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="generate-data-according-to-the-two-causal-dags-above" class="level2">
<h2 class="anchored" data-anchor-id="generate-data-according-to-the-two-causal-dags-above">Generate Data According to the Two Causal DAGs Above</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install and load required packages</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Uncomment to install packages if needed</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(c("lavaan", "semPlot", "tidyverse", "psych"))</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>This is lavaan 0.6-19
lavaan is FREE software! Please report any bugs.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(semPlot)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'psych'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:lavaan':

    cor2cov</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:ggplot2':

    %+%, alpha</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate data for demonstration</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 150 participants, 2 groups (treatment and control)</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">150</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> n<span class="sc">/</span><span class="dv">2</span>)  <span class="co"># 0 = control, 1 = treatment</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate baseline scores (similar for both groups)</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>baseline <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a latent "severity" variable that affects both baseline and censoring</span></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a><span class="co"># This creates the missing not at random (MNAR) scenario</span></span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>severity <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjust baseline by severity (sicker patients have lower baseline scores)</span></span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>baseline <span class="ot">&lt;-</span> baseline <span class="sc">-</span> <span class="dv">5</span> <span class="sc">*</span> severity</span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate follow-up scores with proportional effects</span></span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a>prop_effect1 <span class="ot">&lt;-</span> <span class="fl">0.20</span>  <span class="co"># 20% improvement at time1 for treatment group</span></span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a>prop_effect2 <span class="ot">&lt;-</span> <span class="fl">0.15</span>  <span class="co"># Additional 15% improvement at time2 for treatment group</span></span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate time1 values - true effect is proportional to baseline</span></span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a><span class="co"># The treatment also has a stronger effect for patients with higher severity</span></span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a>time1 <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"numeric"</span>, n)</span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb70-27"><a href="#cb70-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (group[i] <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb70-28"><a href="#cb70-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Treatment group: effect is proportional to baseline and increased by severity</span></span>
<span id="cb70-29"><a href="#cb70-29" aria-hidden="true" tabindex="-1"></a>    effect_modifier <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> prop_effect1 <span class="sc">+</span> <span class="fl">0.1</span> <span class="sc">*</span> severity[i]</span>
<span id="cb70-30"><a href="#cb70-30" aria-hidden="true" tabindex="-1"></a>    time1[i] <span class="ot">&lt;-</span> baseline[i] <span class="sc">*</span> effect_modifier <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb70-31"><a href="#cb70-31" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb70-32"><a href="#cb70-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Control group: small random change</span></span>
<span id="cb70-33"><a href="#cb70-33" aria-hidden="true" tabindex="-1"></a>    time1[i] <span class="ot">&lt;-</span> baseline[i] <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb70-34"><a href="#cb70-34" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb70-35"><a href="#cb70-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb70-36"><a href="#cb70-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-37"><a href="#cb70-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate time2 values</span></span>
<span id="cb70-38"><a href="#cb70-38" aria-hidden="true" tabindex="-1"></a>time2 <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"numeric"</span>, n)</span>
<span id="cb70-39"><a href="#cb70-39" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb70-40"><a href="#cb70-40" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (group[i] <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb70-41"><a href="#cb70-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Treatment group: additional effect proportional to time1</span></span>
<span id="cb70-42"><a href="#cb70-42" aria-hidden="true" tabindex="-1"></a>    effect_modifier <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> prop_effect2 <span class="sc">+</span> <span class="fl">0.05</span> <span class="sc">*</span> severity[i]</span>
<span id="cb70-43"><a href="#cb70-43" aria-hidden="true" tabindex="-1"></a>    time2[i] <span class="ot">&lt;-</span> time1[i] <span class="sc">*</span> effect_modifier <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb70-44"><a href="#cb70-44" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb70-45"><a href="#cb70-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Control group: small random change</span></span>
<span id="cb70-46"><a href="#cb70-46" aria-hidden="true" tabindex="-1"></a>    time2[i] <span class="ot">&lt;-</span> time1[i] <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb70-47"><a href="#cb70-47" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb70-48"><a href="#cb70-48" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb70-49"><a href="#cb70-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-50"><a href="#cb70-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Save time2 values prior to censoring to create a model without censoring</span></span>
<span id="cb70-51"><a href="#cb70-51" aria-hidden="true" tabindex="-1"></a>time2_all <span class="ot">&lt;-</span> time2</span>
<span id="cb70-52"><a href="#cb70-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-53"><a href="#cb70-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate censoring indicators</span></span>
<span id="cb70-54"><a href="#cb70-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Higher probability of censoring (dropout) for:</span></span>
<span id="cb70-55"><a href="#cb70-55" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Sicker patients (higher severity)</span></span>
<span id="cb70-56"><a href="#cb70-56" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Control group participants (treatment has benefit that keeps people engaged)</span></span>
<span id="cb70-57"><a href="#cb70-57" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Those with smaller improvements from baseline to time1</span></span>
<span id="cb70-58"><a href="#cb70-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-59"><a href="#cb70-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate change from baseline to time1</span></span>
<span id="cb70-60"><a href="#cb70-60" aria-hidden="true" tabindex="-1"></a>change_time1 <span class="ot">&lt;-</span> time1 <span class="sc">-</span> baseline</span>
<span id="cb70-61"><a href="#cb70-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-62"><a href="#cb70-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate censoring probabilities</span></span>
<span id="cb70-63"><a href="#cb70-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Logit model for censoring</span></span>
<span id="cb70-64"><a href="#cb70-64" aria-hidden="true" tabindex="-1"></a>logit_censoring <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span> <span class="sc">+</span> </span>
<span id="cb70-65"><a href="#cb70-65" aria-hidden="true" tabindex="-1"></a>                   <span class="fl">1.5</span> <span class="sc">*</span> severity <span class="sc">+</span>                <span class="co"># Sicker patients more likely to drop out</span></span>
<span id="cb70-66"><a href="#cb70-66" aria-hidden="true" tabindex="-1"></a>                   <span class="sc">-</span><span class="fl">0.5</span> <span class="sc">*</span> group <span class="sc">+</span>                 <span class="co"># Treatment group less likely to drop out</span></span>
<span id="cb70-67"><a href="#cb70-67" aria-hidden="true" tabindex="-1"></a>                   <span class="sc">-</span><span class="fl">0.05</span> <span class="sc">*</span> change_time1           <span class="co"># Those improving less likely to drop out</span></span>
<span id="cb70-68"><a href="#cb70-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-69"><a href="#cb70-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to probability</span></span>
<span id="cb70-70"><a href="#cb70-70" aria-hidden="true" tabindex="-1"></a>p_censored <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>logit_censoring))</span>
<span id="cb70-71"><a href="#cb70-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-72"><a href="#cb70-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate censoring indicator (1 = censored/dropped out, 0 = observed)</span></span>
<span id="cb70-73"><a href="#cb70-73" aria-hidden="true" tabindex="-1"></a>censored <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, p_censored)</span>
<span id="cb70-74"><a href="#cb70-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-75"><a href="#cb70-75" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply censoring to the data (set values to NA)</span></span>
<span id="cb70-76"><a href="#cb70-76" aria-hidden="true" tabindex="-1"></a>time2[censored <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb70-77"><a href="#cb70-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-78"><a href="#cb70-78" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data frame</span></span>
<span id="cb70-79"><a href="#cb70-79" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb70-80"><a href="#cb70-80" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span>n,</span>
<span id="cb70-81"><a href="#cb70-81" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(group, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Control"</span>, <span class="st">"Treatment"</span>)),</span>
<span id="cb70-82"><a href="#cb70-82" aria-hidden="true" tabindex="-1"></a>  <span class="at">baseline =</span> baseline,</span>
<span id="cb70-83"><a href="#cb70-83" aria-hidden="true" tabindex="-1"></a>  <span class="at">time1 =</span> time1,</span>
<span id="cb70-84"><a href="#cb70-84" aria-hidden="true" tabindex="-1"></a>  <span class="at">time2 =</span> time2,</span>
<span id="cb70-85"><a href="#cb70-85" aria-hidden="true" tabindex="-1"></a>  <span class="at">time2_all =</span> time2_all,</span>
<span id="cb70-86"><a href="#cb70-86" aria-hidden="true" tabindex="-1"></a>  <span class="at">severity =</span> severity,  <span class="co"># Include the latent severity variable</span></span>
<span id="cb70-87"><a href="#cb70-87" aria-hidden="true" tabindex="-1"></a>  <span class="at">censored =</span> censored    <span class="co"># Include the censoring indicator</span></span>
<span id="cb70-88"><a href="#cb70-88" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb70-89"><a href="#cb70-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-90"><a href="#cb70-90" aria-hidden="true" tabindex="-1"></a><span class="co"># Create change scores for the full dataset</span></span>
<span id="cb70-91"><a href="#cb70-91" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>change1 <span class="ot">&lt;-</span> data<span class="sc">$</span>time1 <span class="sc">-</span> data<span class="sc">$</span>baseline</span>
<span id="cb70-92"><a href="#cb70-92" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>change2 <span class="ot">&lt;-</span> data<span class="sc">$</span>time2 <span class="sc">-</span> data<span class="sc">$</span>baseline</span>
<span id="cb70-93"><a href="#cb70-93" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     id     group baseline    time1    time2 time2_all    severity censored
1     1   Control 40.45655 38.31082       NA  42.60203  0.78773885        1
2     2   Control 43.85301 41.59495       NA  44.73483  0.76904224        1
3     3   Control 63.92607 61.11045 62.41632  62.41632  0.33220258        0
4     4   Control 55.74697 52.58943 54.73496  54.73496 -1.00837661        0
5     5   Control 51.89014 50.57866 53.33019  53.33019 -0.11945261        0
6     6   Control 68.55263 69.54616       NA  61.56340 -0.28039534        1
7     7   Control 51.79421 45.75158 49.08241  49.08241  0.56298953        0
8     8   Control 39.21158 39.84752 38.39256  38.39256 -0.37243876        0
9     9   Control 38.24660 41.95663       NA  42.64848  0.97697339        1
10   10   Control 47.41628 53.52901 52.64353  52.64353 -0.37458086        0
11   11   Control 56.97726 60.88079 63.49668  63.49668  1.05271147        0
12   12   Control 58.84402 61.11435       NA  60.06893 -1.04917701        1
13   13   Control 60.30849 55.12830 56.68381  56.68381 -1.26015524        0
14   14   Control 34.90163 33.09711       NA  31.92505  3.24103993        1
15   15   Control 46.52588 45.46974 42.19138  42.19138 -0.41685759        0
16   16   Control 66.37799 68.48857 72.11860  72.11860  0.29822759        0
17   17   Control 51.79566 51.47864 53.70134  53.70134  0.63656967        0
18   18   Control 32.75273 28.97679 34.14957  34.14957 -0.48378063        0
19   19   Control 54.42925 59.48256 59.67802  59.67802  0.51686204        0
20   20   Control 43.42726 46.16144       NA  49.53645  0.36896453        1
21   21   Control 40.39867 41.11096 47.03721  47.03721 -0.21538051        0
22   22   Control 47.49379 51.14811 50.30367  50.30367  0.06529303        0
23   23   Control 39.91029 35.89397 31.92512  31.92512 -0.03406725        0
24   24   Control 32.06883 34.05129 33.33323  33.33323  2.12845190        0
25   25   Control 47.45629 45.88755       NA  45.24543 -0.74133610        1
26   26   Control 38.61305 40.66428 41.11933  41.11933 -1.09599627        0
27   27   Control 58.18893 58.00646 63.14338  63.14338  0.03778840        0
28   28   Control 49.98133 51.88021 50.90178  50.90178  0.31048075        0
29   29   Control 36.43601 40.44257       NA  41.56158  0.43652348        1
30   30   Control 64.82998 64.85185 64.16879  64.16879 -0.45836533        0
31   31   Control 59.58127 62.63395 62.69530  62.69530 -1.06332613        0
32   32   Control 40.73336 37.16806       NA  38.11023  1.26318518        1
33   33   Control 60.69951 58.53470 62.51934  62.51934 -0.34965039        0
34   34   Control 63.10890 67.66655 68.03051  68.03051 -0.86551286        0
35   35   Control 59.39721 60.52937 62.66790  62.66790 -0.23627957        0
36   36   Control 57.87228 51.71561 54.05219  54.05219 -0.19717589        0
37   37   Control 49.98958 45.89746 48.64178  48.64178  1.10992029        0
38   38   Control 48.95720 48.35485 46.63167  46.63167  0.08473729        0
39   39   Control 43.17010 45.76744       NA  50.64809  0.75405379        1
40   40   Control 48.69175 48.38610 47.24323  47.24323 -0.49929202        0
41   41   Control 41.98070 43.85327 43.53591  43.53591  0.21444531        0
42   42   Control 49.54426 52.42127 56.63342  56.63342 -0.32468591        0
43   43   Control 36.87312 41.88628 45.76854  45.76854  0.09458353        0
44   44   Control 76.16638 76.33443 73.06445  73.06445 -0.89536336        0
45   45   Control 68.63363 68.47768 65.85847  65.85847 -1.31080153        0
46   46   Control 28.78285 23.52314       NA  19.44890  1.99721338        1
47   47   Control 42.96761 43.26559 43.81113  43.81113  0.60070882        0
48   48   Control 51.58980 49.87425 50.36878  50.36878 -1.25127136        0
49   49   Control 60.85548 57.93345 59.02580  59.02580 -0.61116592        0
50   50   Control 55.09371 54.55399 56.21046  56.21046 -1.18548008        0
51   51   Control 41.53913 44.58396 42.77828  42.77828  2.19881035        0
52   52   Control 43.15247 37.17422       NA  34.19313  1.31241298        1
53   53   Control 50.89702 49.61518 52.69554  52.69554 -0.26514506        0
54   54   Control 60.97005 61.31996 63.57315  63.57315  0.54319406        0
55   55   Control 49.81399 47.13437 42.60687  42.60687 -0.41433995        0
56   56   Control 67.54594 68.54765 68.26221  68.26221 -0.47624689        0
57   57   Control 38.45549 39.68978 37.00193  37.00193 -0.78860284        0
58   58   Control 58.81922 58.72012 52.50786  52.50786 -0.59461727        0
59   59   Control 42.98401 35.58631 36.03667  36.03667  1.65090747        0
60   60   Control 52.42956 60.14393 59.90630  59.90630 -0.05402813        0
61   61   Control 53.20017 52.58427 52.29216  52.29216  0.11924524        0
62   62   Control 43.75833 45.71191 46.36037  46.36037  0.24368743        0
63   63   Control 40.50555 41.32685 43.97424  43.97424  1.23247588        0
64   64   Control 42.39457 45.46859 46.08538  46.08538 -0.51606383        0
65   65   Control 44.24462 46.69760 44.84829  44.84829 -0.99250715        0
66   66   Control 44.65680 44.02742       NA  41.82302  1.67569693        1
67   67   Control 56.68791 57.82242 57.42701  57.42701 -0.44116322        0
68   68   Control 54.14537 51.30915 52.23920  52.23920 -0.72306597        0
69   69   Control 65.40404 67.97481 64.85577  64.85577 -1.23627312        0
70   70   Control 76.92443 75.54131 74.98838  74.98838 -1.28471572        0
71   71   Control 47.95956 55.20988 58.11168  58.11168 -0.57397348        0
72   72   Control 23.81838 18.86524       NA  18.54040  0.61798582        1
73   73   Control 54.50814 53.11618 51.02092  51.02092  1.10984814        0
74   74   Control 39.37005 41.84619 41.01835  41.01835  0.70758835        0
75   75   Control 44.93820 46.46860 49.81254  49.81254 -0.36365730        0
76   76 Treatment 59.95696 70.53816 82.97974  82.97974  0.05974994        0
77   77 Treatment 50.67525 54.24940 64.18564  64.18564 -0.70459646        0
78   78 Treatment 41.37891 47.12035 52.91592  52.91592 -0.71721816        0
79   79 Treatment 47.38978 61.01716 74.09950  74.09950  0.88465050        0
80   80 Treatment 53.68905 53.60340 57.24657  57.24657 -1.01559258        0
81   81 Treatment 40.28117 56.31721 72.08674  72.08674  1.95529397        0
82   82 Treatment 54.30440 65.24550 73.21867  73.21867 -0.09031959        0
83   83 Treatment 45.22071 55.75919 60.45949  60.45949  0.21453883        0
84   84 Treatment 60.13640 64.55739 72.24111  72.24111 -0.73852770        0
85   85 Treatment 50.66708 59.31863 72.35038  72.35038 -0.57438869        0
86   86 Treatment 59.90290 68.12988 76.26570  76.26570 -1.31701613        0
87   87 Treatment 61.88302 74.49633 88.48518  88.48518 -0.18292539        0
88   88 Treatment 52.25690 61.49099 73.07939  73.07939  0.41898240        0
89   89 Treatment 45.11916 54.29929 61.49899  61.49899  0.32430434        0
90   90 Treatment 65.39576 74.40230 82.04852  82.04852 -0.78153649        0
91   91 Treatment 63.87815 69.67507 76.55922  76.55922 -0.78862197        0
92   92 Treatment 57.99496 60.20852 66.32186  66.32186 -0.50219872        0
93   93 Treatment 44.90701 63.25953 79.59297  79.59297  1.49606067        0
94   94 Treatment 49.40746 51.18139 52.35607  52.35607 -1.13730362        0
95   95 Treatment 64.50178 74.52654 87.63742  87.63742 -0.17905159        0
96   96 Treatment 34.48560 52.45482 67.90491  67.90491  1.90236182        0
97   97 Treatment 72.37820 83.80057 92.35170  92.35170 -0.10097489        0
98   98 Treatment 72.12531 79.27967 87.69971  87.69971 -1.35984070        0
99   99 Treatment 50.96684 53.99004 67.58468  67.58468 -0.66476944        0
100 100 Treatment 37.30849 45.51774 51.77861  51.77861  0.48545998        0
101 101 Treatment 44.77395 51.82635 61.16171  61.16171 -0.37560287        0
102 102 Treatment 55.37822 59.83634 64.78415  64.78415 -0.56187636        0
103 103 Treatment 49.25267 55.50507 66.20851  66.20851 -0.34391723        0
104 104 Treatment 46.07209 55.61692 64.96059  64.96059  0.09049665        0
105 105 Treatment 32.49127 46.19537       NA  61.77261  1.59850877        1
106 106 Treatment 49.99255 54.59666 58.16748  58.16748 -0.08856511        0
107 107 Treatment 36.74696 47.01870 56.45850  56.45850  1.08079950        0
108 108 Treatment 30.16681 40.37218 46.12047  46.12047  0.63075412        0
109 109 Treatment 46.76593 53.97125 61.16847  61.16847 -0.11363990        0
110 110 Treatment 66.85448 70.65911 73.95357  73.95357 -1.53290200        0
111 111 Treatment 46.85212 55.25768 59.60502  59.60502 -0.52111732        0
112 112 Treatment 58.52900 68.17114 78.46322  78.46322 -0.48987045        0
113 113 Treatment 33.58540 42.42062 45.62099  45.62099  0.04715443        0
114 114 Treatment 42.94339 56.74743 73.40079  73.40079  1.30019868        0
115 115 Treatment 43.72868 61.26071 73.91498  73.91498  2.29307897        0
116 116 Treatment 45.27363 53.40537 65.85187  65.85187  1.54758106        0
117 117 Treatment 51.72252 61.09951 71.45663  71.45663 -0.13315096        0
118 118 Treatment 52.37558 54.94163 60.11776  60.11776 -1.75652740        0
119 119 Treatment 43.44686 52.05330 57.94419  57.94419 -0.38877986        0
120 120 Treatment 39.31268 45.86007 53.18214  53.18214  0.08920722        0
121 121 Treatment 46.95140 65.64764 81.15224  81.15224  0.84501300        0
122 122 Treatment 35.71261 47.15185 52.12448  52.12448  0.96252797        0
123 123 Treatment 41.67288 53.23812       NA  60.70018  0.68430943        1
124 124 Treatment 54.41545 61.52289 67.42047  67.42047 -1.39527435        0
125 125 Treatment 64.19040 80.32698       NA  94.45414  0.84964305        1
126 126 Treatment 45.71329 51.46357 62.14404  62.14404 -0.44655722        0
127 127 Treatment 51.47985 69.86806 82.97869  82.97869  0.17480270        0
128 128 Treatment 50.40685 60.89740 70.47551  70.47551  0.07455118        0
129 129 Treatment 38.24060 52.42676 56.88987  56.88987  0.42816676        0
130 130 Treatment 49.16354 54.80204 63.16826  63.16826  0.02467498        0
131 131 Treatment 72.78288 74.63155 78.65472  78.65472 -1.66747510        0
132 132 Treatment 50.83256 65.87814 77.87877  77.87877  0.73649596        0
133 133 Treatment 48.48220 60.95029 67.72458  67.72458  0.38602657        0
134 134 Treatment 47.10329 52.25573 60.89598  60.89598 -0.26565163        0
135 135 Treatment 28.87681 35.05111 37.39896  37.39896  0.11814451        0
136 136 Treatment 60.64318 70.35241 80.69810  80.69810  0.13403865        0
137 137 Treatment 34.28850 44.04215 52.27946  52.27946  0.22101947        0
138 138 Treatment 49.19524 70.36080 84.33694  84.33694  1.64084617        0
139 139 Treatment 70.18629 76.01115 88.32928  88.32928 -0.21905038        0
140 140 Treatment 34.72074 45.95551 49.28548  49.28548  0.16806538        0
141 141 Treatment 51.17592 63.66729 68.50745  68.50745  1.16838387        0
142 142 Treatment 42.10712 56.33170 69.14555  69.14555  1.05418102        0
143 143 Treatment 28.55224 39.51238 50.22346  50.22346  1.14526311        0
144 144 Treatment 37.74066 42.50972 46.80125  46.80125 -0.57746800        0
145 145 Treatment 23.97222 31.63172 41.05596  41.05596  2.00248273        0
146 146 Treatment 44.35743 54.02075       NA  58.83627  0.06670087        1
147 147 Treatment 26.04818 37.43709 46.16568  46.16568  1.86685184        0
148 148 Treatment 63.63368 70.41403 70.39546  70.39546 -1.35090269        0
149 149 Treatment 70.89617 79.06716 94.55373  94.55373  0.02098359        0
150 150 Treatment 30.88012 36.00676 49.23778  49.23778  1.24991457        0
        change1    change2
1   -2.14572656         NA
2   -2.25806690         NA
3   -2.81561611 -1.5097493
4   -3.15753984 -1.0120046
5   -1.31147860  1.4400462
6    0.99353752         NA
7   -6.04263149 -2.7118002
8    0.63594130 -0.8190215
9    3.71002514         NA
10   6.11272205  5.2272487
11   3.90352798  6.5194228
12   2.27032429         NA
13  -5.18019120 -3.6246799
14  -1.80452012         NA
15  -1.05613937 -4.3345010
16   2.11057171  5.7406032
17  -0.31701400  1.9056860
18  -3.77594588  1.3968408
19   5.05330712  5.2487689
20   2.73417388         NA
21   0.71229082  6.6385480
22   3.65432583  2.8098795
23  -4.01632286 -7.9851762
24   1.98246089  1.2644062
25  -1.56873713         NA
26   2.05123657  2.5062781
27  -0.18246586  4.9544491
28   1.89888214  0.9204505
29   4.00655285         NA
30   0.02187027 -0.6611819
31   3.05267591  3.1140280
32  -3.56530211         NA
33  -2.16481332  1.8198308
34   4.55765313  4.9216083
35   1.13216392  3.2706909
36  -6.15666846 -3.8200884
37  -4.09211236 -1.3477925
38  -0.60234305 -2.3255267
39   2.59733821         NA
40  -0.30564977 -1.4485200
41   1.87256242  1.5552099
42   2.87701613  7.0891669
43   5.01316449  8.8954162
44   0.16805020 -3.1019254
45  -0.15594572 -2.7751587
46  -5.25971208         NA
47   0.29798278  0.8435244
48  -1.71555017 -1.2210276
49  -2.92202875 -1.8296847
50  -0.53971869  1.1167544
51   3.04482952  1.2391510
52  -5.97824547         NA
53  -1.28183786  1.7985173
54   0.34991185  2.6030958
55  -2.67962271 -7.2071223
56   1.00170883  0.7162665
57   1.23428976 -1.4535537
58  -0.09910848 -6.3113617
59  -7.39769458 -6.9473342
60   7.71437444  7.4767393
61  -0.61589777 -0.9080056
62   1.95357984  2.6020375
63   0.82129947  3.4686950
64   3.07401970  3.6908122
65   2.45297834  0.6036708
66  -0.62937951         NA
67   1.13450332  0.7390949
68  -2.83622649 -1.9061755
69   2.57076903 -0.5482720
70  -1.38311502 -1.9360416
71   7.25032006 10.1521218
72  -4.95314669         NA
73  -1.39196173 -3.4872237
74   2.47613959  1.6483041
75   1.53039764  4.8743433
76  10.58119217 23.0227800
77   3.57414787 13.5103885
78   5.74143901 11.5370069
79  13.62737368 26.7097152
80  -0.08565386  3.5575242
81  16.03604087 31.8055701
82  10.94109619 18.9142729
83  10.53848001 15.2387868
84   4.42098963 12.1047064
85   8.65155576 21.6833068
86   8.22698186 16.3627995
87  12.61331513 26.6021616
88   9.23408745 20.8224853
89   9.18013011 16.3798273
90   9.00654544 16.6527627
91   5.79692166 12.6810733
92   2.21355401  8.3269002
93  18.35251701 34.6859533
94   1.77393062  2.9486094
95  10.02476098 23.1356361
96  17.96922877 33.4193125
97  11.42236799 19.9734991
98   7.15436338 15.5744040
99   3.02320010 16.6178401
100  8.20924894 14.4701156
101  7.05239932 16.3877580
102  4.45811828  9.4059321
103  6.25240457 16.9558421
104  9.54483047 18.8885001
105 13.70410008         NA
106  4.60411047  8.1749291
107 10.27173820 19.7115381
108 10.20536529 15.9536618
109  7.20531179 14.4025398
110  3.80463495  7.0990907
111  8.40556415 12.7528988
112  9.64214159 19.9342280
113  8.83522324 12.0355907
114 13.80404490 30.4573993
115 17.53203691 30.1863070
116  8.13173978 20.5782393
117  9.37699000 19.7341110
118  2.56605590  7.7421827
119  8.60644142 14.4973323
120  6.54739761 13.8694671
121 18.69624336 34.2008381
122 11.43923504 16.4118633
123 11.56523762         NA
124  7.10744217 13.0050173
125 16.13657541         NA
126  5.75028172 16.4307576
127 18.38820960 31.4988368
128 10.49054710 20.0686560
129 14.18616062 18.6492726
130  5.63849987 14.0047191
131  1.84866174  5.8718338
132 15.04558144 27.0462125
133 12.46809650 19.2423844
134  5.15244263 13.7926856
135  6.17430247  8.5221541
136  9.70922678 20.0549187
137  9.75365301 17.9909624
138 21.16555692 35.1416923
139  5.82486114 18.1429941
140 11.23476416 14.5647353
141 12.49136374 17.3315245
142 14.22458449 27.0384348
143 10.96013953 21.6712201
144  4.76906066  9.0605827
145  7.65949963 17.0837361
146  9.66331707         NA
147 11.38890330 20.1174956
148  6.78035361  6.7617783
149  8.17098894 23.6575613
150  5.12663816 18.3576536</code></pre>
</div>
</div>
</section>
</section>
<section id="analyze-ideal-dataset-with-no-loss-to-follow-up" class="level1">
<h1>Analyze Ideal Dataset with no Loss to Follow-Up</h1>
<p>Let’s analyze this dataset using the difference in group means:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>group_means <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(group) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="fu">mean</span>(time2_all))</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>group_means</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  group     `mean(time2_all)`
  &lt;fct&gt;                 &lt;dbl&gt;
1 Control                50.4
2 Treatment              66.8</code></pre>
</div>
</div>
<p>The average treatment effect when there is no loss to follow-up is and we do not adjust for baseline, we see:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>group_means <span class="sc">%&gt;%</span> deframe <span class="sc">%&gt;%</span> .[[<span class="st">"Treatment"</span>]] <span class="sc">-</span> group_means <span class="sc">%&gt;%</span> deframe <span class="sc">%&gt;%</span> .[[<span class="st">"Control"</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 16.38415</code></pre>
</div>
</div>
<p>Using ANCOVA we get:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>ideal <span class="ot">&lt;-</span> <span class="fu">glm</span>(time2_all <span class="sc">~</span> baseline <span class="sc">+</span> group, <span class="at">data =</span> data)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ideal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = time2_all ~ baseline + group, data = data)

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     2.77655    2.34170   1.186    0.238    
baseline        0.95396    0.04468  21.352   &lt;2e-16 ***
groupTreatment 17.65259    1.00390  17.584   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for gaussian family taken to be 37.66081)

    Null deviance: 32772.1  on 149  degrees of freedom
Residual deviance:  5536.1  on 147  degrees of freedom
AIC: 974.94

Number of Fisher Scoring iterations: 2</code></pre>
</div>
</div>
<p>The effect estimate here is 17.65, which is higher than the difference in group means of 16.38.</p>
<p>When there is loss to follow-up, the näive approach to estimating the average treatment effect is to ignore patients who were censored, which means removing them from the data. The average treatment effect is then the mean outcome (time2) of the treated group minus the mean outcome (time2) of the untreated in the remaining patients. Here we return to using time2, which has missing values for censored patients.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>group_means_uncensored <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(censored <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(group) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="fu">mean</span>(time2))</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>group_means_uncensored</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  group     `mean(time2)`
  &lt;fct&gt;             &lt;dbl&gt;
1 Control            52.7
2 Treatment          66.7</code></pre>
</div>
</div>
<p>Ignoring censored patients underestimates the treatment effect, because patients who have higher baseline values have higher treatment effects, but are also more likely to drop out (be lost to follow-up):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>group_means_uncensored <span class="sc">%&gt;%</span> deframe <span class="sc">%&gt;%</span> .[[<span class="st">"Treatment"</span>]] <span class="sc">-</span> group_means_uncensored <span class="sc">%&gt;%</span> deframe <span class="sc">%&gt;%</span> .[[<span class="st">"Control"</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 14.03404</code></pre>
</div>
</div>
<p>We can also use logistic regression to do the same näive analysis, using the ANCOVA approach of adjusting for baseline.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>model_naive <span class="ot">&lt;-</span> <span class="fu">lm</span>(time2 <span class="sc">~</span> group <span class="sc">+</span> baseline,</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> <span class="fu">subset</span>(data, <span class="sc">!</span><span class="fu">is.na</span>(time2)))</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>model_naive</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = time2 ~ group + baseline, data = subset(data, !is.na(time2)))

Coefficients:
   (Intercept)  groupTreatment        baseline  
         4.506          16.862           0.929  </code></pre>
</div>
</div>
<p>This result is closer to the true result of 17.65</p>
<p>One appropriate way to analyze an RCT with censored patients is by using IP (Inverse Probability) weighting to adjust the data for the probability of remaining in the study. This creates a pseudo-population where the outcome for patients who were uncensored gets weighted by their inverse probability of staying in the study as calculated using baseline covariates.</p>
<p>To do this, we first use logistic regression to create a model that predicts whether a patient will be censored based on group (the treatment) and baseline HBA1C.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model for censoring process - modeling factors affecting dropout</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>model_censoring <span class="ot">&lt;-</span> <span class="fu">glm</span>(censored <span class="sc">~</span> group <span class="sc">+</span> baseline <span class="sc">+</span> time1, </span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> data,</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_censoring)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = censored ~ group + baseline + time1, family = binomial(link = "logit"), 
    data = data)

Coefficients:
                Estimate Std. Error z value Pr(&gt;|z|)  
(Intercept)     2.179932   1.285029   1.696   0.0898 .
groupTreatment -1.747864   0.954461  -1.831   0.0671 .
baseline       -0.077423   0.079859  -0.969   0.3323  
time1           0.002417   0.073945   0.033   0.9739  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 114.000  on 149  degrees of freedom
Residual deviance:  97.511  on 146  degrees of freedom
AIC: 105.51

Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
<p>The model for censoring is consistent with the data generating process in which there is a Higher probability of censoring (dropout) for:</p>
<ol type="1">
<li><p>Sicker patients (higher severity)</p></li>
<li><p>Control group participants (treatment has benefit that keeps people engaged)</p></li>
<li><p>Those with smaller improvements from baseline to time1</p></li>
</ol>
<p>Now we can predict the probability of remaining in the study (not being censored) by using the regression results on each patient in the study and calculating 1 - p(censored) Look at the probability of remaining in the study to convince yourself that the model is producing appropriate results. For example, patients in the treatment group are more likely to remain in the study, as expected.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>p_observed <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">predict</span>(model_censoring, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     id     group baseline    time1    time2 time2_all    severity censored
1     1   Control 40.45655 38.31082       NA  42.60203  0.78773885        1
2     2   Control 43.85301 41.59495       NA  44.73483  0.76904224        1
3     3   Control 63.92607 61.11045 62.41632  62.41632  0.33220258        0
4     4   Control 55.74697 52.58943 54.73496  54.73496 -1.00837661        0
5     5   Control 51.89014 50.57866 53.33019  53.33019 -0.11945261        0
6     6   Control 68.55263 69.54616       NA  61.56340 -0.28039534        1
7     7   Control 51.79421 45.75158 49.08241  49.08241  0.56298953        0
8     8   Control 39.21158 39.84752 38.39256  38.39256 -0.37243876        0
9     9   Control 38.24660 41.95663       NA  42.64848  0.97697339        1
10   10   Control 47.41628 53.52901 52.64353  52.64353 -0.37458086        0
11   11   Control 56.97726 60.88079 63.49668  63.49668  1.05271147        0
12   12   Control 58.84402 61.11435       NA  60.06893 -1.04917701        1
13   13   Control 60.30849 55.12830 56.68381  56.68381 -1.26015524        0
14   14   Control 34.90163 33.09711       NA  31.92505  3.24103993        1
15   15   Control 46.52588 45.46974 42.19138  42.19138 -0.41685759        0
16   16   Control 66.37799 68.48857 72.11860  72.11860  0.29822759        0
17   17   Control 51.79566 51.47864 53.70134  53.70134  0.63656967        0
18   18   Control 32.75273 28.97679 34.14957  34.14957 -0.48378063        0
19   19   Control 54.42925 59.48256 59.67802  59.67802  0.51686204        0
20   20   Control 43.42726 46.16144       NA  49.53645  0.36896453        1
21   21   Control 40.39867 41.11096 47.03721  47.03721 -0.21538051        0
22   22   Control 47.49379 51.14811 50.30367  50.30367  0.06529303        0
23   23   Control 39.91029 35.89397 31.92512  31.92512 -0.03406725        0
24   24   Control 32.06883 34.05129 33.33323  33.33323  2.12845190        0
25   25   Control 47.45629 45.88755       NA  45.24543 -0.74133610        1
26   26   Control 38.61305 40.66428 41.11933  41.11933 -1.09599627        0
27   27   Control 58.18893 58.00646 63.14338  63.14338  0.03778840        0
28   28   Control 49.98133 51.88021 50.90178  50.90178  0.31048075        0
29   29   Control 36.43601 40.44257       NA  41.56158  0.43652348        1
30   30   Control 64.82998 64.85185 64.16879  64.16879 -0.45836533        0
31   31   Control 59.58127 62.63395 62.69530  62.69530 -1.06332613        0
32   32   Control 40.73336 37.16806       NA  38.11023  1.26318518        1
33   33   Control 60.69951 58.53470 62.51934  62.51934 -0.34965039        0
34   34   Control 63.10890 67.66655 68.03051  68.03051 -0.86551286        0
35   35   Control 59.39721 60.52937 62.66790  62.66790 -0.23627957        0
36   36   Control 57.87228 51.71561 54.05219  54.05219 -0.19717589        0
37   37   Control 49.98958 45.89746 48.64178  48.64178  1.10992029        0
38   38   Control 48.95720 48.35485 46.63167  46.63167  0.08473729        0
39   39   Control 43.17010 45.76744       NA  50.64809  0.75405379        1
40   40   Control 48.69175 48.38610 47.24323  47.24323 -0.49929202        0
41   41   Control 41.98070 43.85327 43.53591  43.53591  0.21444531        0
42   42   Control 49.54426 52.42127 56.63342  56.63342 -0.32468591        0
43   43   Control 36.87312 41.88628 45.76854  45.76854  0.09458353        0
44   44   Control 76.16638 76.33443 73.06445  73.06445 -0.89536336        0
45   45   Control 68.63363 68.47768 65.85847  65.85847 -1.31080153        0
46   46   Control 28.78285 23.52314       NA  19.44890  1.99721338        1
47   47   Control 42.96761 43.26559 43.81113  43.81113  0.60070882        0
48   48   Control 51.58980 49.87425 50.36878  50.36878 -1.25127136        0
49   49   Control 60.85548 57.93345 59.02580  59.02580 -0.61116592        0
50   50   Control 55.09371 54.55399 56.21046  56.21046 -1.18548008        0
51   51   Control 41.53913 44.58396 42.77828  42.77828  2.19881035        0
52   52   Control 43.15247 37.17422       NA  34.19313  1.31241298        1
53   53   Control 50.89702 49.61518 52.69554  52.69554 -0.26514506        0
54   54   Control 60.97005 61.31996 63.57315  63.57315  0.54319406        0
55   55   Control 49.81399 47.13437 42.60687  42.60687 -0.41433995        0
56   56   Control 67.54594 68.54765 68.26221  68.26221 -0.47624689        0
57   57   Control 38.45549 39.68978 37.00193  37.00193 -0.78860284        0
58   58   Control 58.81922 58.72012 52.50786  52.50786 -0.59461727        0
59   59   Control 42.98401 35.58631 36.03667  36.03667  1.65090747        0
60   60   Control 52.42956 60.14393 59.90630  59.90630 -0.05402813        0
61   61   Control 53.20017 52.58427 52.29216  52.29216  0.11924524        0
62   62   Control 43.75833 45.71191 46.36037  46.36037  0.24368743        0
63   63   Control 40.50555 41.32685 43.97424  43.97424  1.23247588        0
64   64   Control 42.39457 45.46859 46.08538  46.08538 -0.51606383        0
65   65   Control 44.24462 46.69760 44.84829  44.84829 -0.99250715        0
66   66   Control 44.65680 44.02742       NA  41.82302  1.67569693        1
67   67   Control 56.68791 57.82242 57.42701  57.42701 -0.44116322        0
68   68   Control 54.14537 51.30915 52.23920  52.23920 -0.72306597        0
69   69   Control 65.40404 67.97481 64.85577  64.85577 -1.23627312        0
70   70   Control 76.92443 75.54131 74.98838  74.98838 -1.28471572        0
71   71   Control 47.95956 55.20988 58.11168  58.11168 -0.57397348        0
72   72   Control 23.81838 18.86524       NA  18.54040  0.61798582        1
73   73   Control 54.50814 53.11618 51.02092  51.02092  1.10984814        0
74   74   Control 39.37005 41.84619 41.01835  41.01835  0.70758835        0
75   75   Control 44.93820 46.46860 49.81254  49.81254 -0.36365730        0
76   76 Treatment 59.95696 70.53816 82.97974  82.97974  0.05974994        0
77   77 Treatment 50.67525 54.24940 64.18564  64.18564 -0.70459646        0
78   78 Treatment 41.37891 47.12035 52.91592  52.91592 -0.71721816        0
79   79 Treatment 47.38978 61.01716 74.09950  74.09950  0.88465050        0
80   80 Treatment 53.68905 53.60340 57.24657  57.24657 -1.01559258        0
81   81 Treatment 40.28117 56.31721 72.08674  72.08674  1.95529397        0
82   82 Treatment 54.30440 65.24550 73.21867  73.21867 -0.09031959        0
83   83 Treatment 45.22071 55.75919 60.45949  60.45949  0.21453883        0
84   84 Treatment 60.13640 64.55739 72.24111  72.24111 -0.73852770        0
85   85 Treatment 50.66708 59.31863 72.35038  72.35038 -0.57438869        0
86   86 Treatment 59.90290 68.12988 76.26570  76.26570 -1.31701613        0
87   87 Treatment 61.88302 74.49633 88.48518  88.48518 -0.18292539        0
88   88 Treatment 52.25690 61.49099 73.07939  73.07939  0.41898240        0
89   89 Treatment 45.11916 54.29929 61.49899  61.49899  0.32430434        0
90   90 Treatment 65.39576 74.40230 82.04852  82.04852 -0.78153649        0
91   91 Treatment 63.87815 69.67507 76.55922  76.55922 -0.78862197        0
92   92 Treatment 57.99496 60.20852 66.32186  66.32186 -0.50219872        0
93   93 Treatment 44.90701 63.25953 79.59297  79.59297  1.49606067        0
94   94 Treatment 49.40746 51.18139 52.35607  52.35607 -1.13730362        0
95   95 Treatment 64.50178 74.52654 87.63742  87.63742 -0.17905159        0
96   96 Treatment 34.48560 52.45482 67.90491  67.90491  1.90236182        0
97   97 Treatment 72.37820 83.80057 92.35170  92.35170 -0.10097489        0
98   98 Treatment 72.12531 79.27967 87.69971  87.69971 -1.35984070        0
99   99 Treatment 50.96684 53.99004 67.58468  67.58468 -0.66476944        0
100 100 Treatment 37.30849 45.51774 51.77861  51.77861  0.48545998        0
101 101 Treatment 44.77395 51.82635 61.16171  61.16171 -0.37560287        0
102 102 Treatment 55.37822 59.83634 64.78415  64.78415 -0.56187636        0
103 103 Treatment 49.25267 55.50507 66.20851  66.20851 -0.34391723        0
104 104 Treatment 46.07209 55.61692 64.96059  64.96059  0.09049665        0
105 105 Treatment 32.49127 46.19537       NA  61.77261  1.59850877        1
106 106 Treatment 49.99255 54.59666 58.16748  58.16748 -0.08856511        0
107 107 Treatment 36.74696 47.01870 56.45850  56.45850  1.08079950        0
108 108 Treatment 30.16681 40.37218 46.12047  46.12047  0.63075412        0
109 109 Treatment 46.76593 53.97125 61.16847  61.16847 -0.11363990        0
110 110 Treatment 66.85448 70.65911 73.95357  73.95357 -1.53290200        0
111 111 Treatment 46.85212 55.25768 59.60502  59.60502 -0.52111732        0
112 112 Treatment 58.52900 68.17114 78.46322  78.46322 -0.48987045        0
113 113 Treatment 33.58540 42.42062 45.62099  45.62099  0.04715443        0
114 114 Treatment 42.94339 56.74743 73.40079  73.40079  1.30019868        0
115 115 Treatment 43.72868 61.26071 73.91498  73.91498  2.29307897        0
116 116 Treatment 45.27363 53.40537 65.85187  65.85187  1.54758106        0
117 117 Treatment 51.72252 61.09951 71.45663  71.45663 -0.13315096        0
118 118 Treatment 52.37558 54.94163 60.11776  60.11776 -1.75652740        0
119 119 Treatment 43.44686 52.05330 57.94419  57.94419 -0.38877986        0
120 120 Treatment 39.31268 45.86007 53.18214  53.18214  0.08920722        0
121 121 Treatment 46.95140 65.64764 81.15224  81.15224  0.84501300        0
122 122 Treatment 35.71261 47.15185 52.12448  52.12448  0.96252797        0
123 123 Treatment 41.67288 53.23812       NA  60.70018  0.68430943        1
124 124 Treatment 54.41545 61.52289 67.42047  67.42047 -1.39527435        0
125 125 Treatment 64.19040 80.32698       NA  94.45414  0.84964305        1
126 126 Treatment 45.71329 51.46357 62.14404  62.14404 -0.44655722        0
127 127 Treatment 51.47985 69.86806 82.97869  82.97869  0.17480270        0
128 128 Treatment 50.40685 60.89740 70.47551  70.47551  0.07455118        0
129 129 Treatment 38.24060 52.42676 56.88987  56.88987  0.42816676        0
130 130 Treatment 49.16354 54.80204 63.16826  63.16826  0.02467498        0
131 131 Treatment 72.78288 74.63155 78.65472  78.65472 -1.66747510        0
132 132 Treatment 50.83256 65.87814 77.87877  77.87877  0.73649596        0
133 133 Treatment 48.48220 60.95029 67.72458  67.72458  0.38602657        0
134 134 Treatment 47.10329 52.25573 60.89598  60.89598 -0.26565163        0
135 135 Treatment 28.87681 35.05111 37.39896  37.39896  0.11814451        0
136 136 Treatment 60.64318 70.35241 80.69810  80.69810  0.13403865        0
137 137 Treatment 34.28850 44.04215 52.27946  52.27946  0.22101947        0
138 138 Treatment 49.19524 70.36080 84.33694  84.33694  1.64084617        0
139 139 Treatment 70.18629 76.01115 88.32928  88.32928 -0.21905038        0
140 140 Treatment 34.72074 45.95551 49.28548  49.28548  0.16806538        0
141 141 Treatment 51.17592 63.66729 68.50745  68.50745  1.16838387        0
142 142 Treatment 42.10712 56.33170 69.14555  69.14555  1.05418102        0
143 143 Treatment 28.55224 39.51238 50.22346  50.22346  1.14526311        0
144 144 Treatment 37.74066 42.50972 46.80125  46.80125 -0.57746800        0
145 145 Treatment 23.97222 31.63172 41.05596  41.05596  2.00248273        0
146 146 Treatment 44.35743 54.02075       NA  58.83627  0.06670087        1
147 147 Treatment 26.04818 37.43709 46.16568  46.16568  1.86685184        0
148 148 Treatment 63.63368 70.41403 70.39546  70.39546 -1.35090269        0
149 149 Treatment 70.89617 79.06716 94.55373  94.55373  0.02098359        0
150 150 Treatment 30.88012 36.00676 49.23778  49.23778  1.24991457        0
        change1    change2 p_observed
1   -2.14572656         NA  0.7026072
2   -2.25806690         NA  0.7530176
3   -2.81561611 -1.5097493  0.9322465
4   -3.15753984 -1.0120046  0.8817455
5   -1.31147860  1.4400462  0.8475247
6    0.99353752         NA  0.9507123
7   -6.04263149 -2.7118002  0.8480717
8    0.63594130 -0.8190215  0.6812758
9    3.71002514         NA  0.6637013
10   6.11272205  5.2272487  0.7960534
11   3.90352798  6.5194228  0.8893658
12   2.27032429         NA  0.9027574
13  -5.18019120 -3.6246799  0.9134175
14  -1.80452012         NA  0.6087989
15  -1.05613937 -4.3345010  0.7879057
16   2.11057171  5.7406032  0.9423358
17  -0.31701400  1.9056860  0.8462943
18  -3.77594588  1.3968408  0.5709799
19   5.05330712  5.2487689  0.8687993
20   2.73417388         NA  0.7447438
21   0.71229082  6.6385480  0.7002514
22   3.65432583  2.8098795  0.7979552
23  -4.01632286 -7.9851762  0.6949347
24   1.98246089  1.2644062  0.5549364
25  -1.56873713         NA  0.7995322
26   2.05123657  2.5062781  0.6706943
27  -0.18246586  4.9544491  0.8988977
28   1.89888214  0.9204505  0.8269818
29   4.00655285         NA  0.6325822
30   0.02187027 -0.6611819  0.9359958
31   3.05267591  3.1140280  0.9073461
32  -3.56530211         NA  0.7076375
33  -2.16481332  1.8198308  0.9151449
34   4.55765313  4.9216083  0.9270754
35   1.13216392  3.2706909  0.9065727
36  -6.15666846 -3.8200884  0.8980483
37  -4.09211236 -1.3477925  0.8291314
38  -0.60234305 -2.3255267  0.8166202
39   2.59733821         NA  0.7411232
40  -0.30564977 -1.4485200  0.8135111
41   1.87256242  1.5552099  0.7239926
42   2.87701613  7.0891669  0.8218950
43   5.01316449  8.8954162  0.6396080
44   0.16805020 -3.1019254  0.9716015
45  -0.15594572 -2.7751587  0.9511255
46  -5.25971208         NA  0.4979176
47   0.29798278  0.8435244  0.7392710
48  -1.71555017 -1.2210276  0.8447189
49  -2.92202875 -1.8296847  0.9161896
50  -0.53971869  1.1167544  0.8758539
51   3.04482952  1.2391510  0.7167506
52  -5.97824547         NA  0.7448282
53  -1.28183786  1.7985173  0.8376378
54   0.34991185  2.6030958  0.9162422
55  -2.67962271 -7.2071223  0.8267691
56   1.00170883  0.7162665  0.9470502
57   1.23428976 -1.4535537  0.6685165
58  -0.09910848 -6.3113617  0.9030963
59  -7.39769458 -6.9473342  0.7430748
60   7.71437444  7.4767393  0.8499187
61  -0.61589777 -0.9080056  0.8595909
62   1.95357984  2.6020375  0.7497896
63   0.82129947  3.4686950  0.7018763
64   3.07401970  3.6908122  0.7295799
65   2.45297834  0.6036708  0.7563477
66  -0.62937951         NA  0.7633482
67   1.13450332  0.7390949  0.8878802
68  -2.83622649 -1.9061755  0.8685455
69   2.57076903 -0.5482720  0.9381711
70  -1.38311502 -1.9360416  0.9732268
71   7.25032006 10.1521218  0.8021534
72  -4.95314669         NA  0.4057806
73  -1.39196173 -3.4872237  0.8712300
74   2.47613959  1.6483041  0.6828889
75   1.53039764  4.8743433  0.7662061
76  10.58119217 23.0227800  0.9826984
77   3.57414787 13.5103885  0.9664389
78   5.74143901 11.5370069  0.9344858
79  13.62737368 26.7097152  0.9564585
80  -0.08565386  3.5575242  0.9732771
81  16.03604087 31.8055701  0.9276079
82  10.94109619 18.9142729  0.9737798
83  10.53848001 15.2387868  0.9495159
84   4.42098963 12.1047064  0.9831738
85   8.65155576 21.6833068  0.9660185
86   8.22698186 16.3627995  0.9827261
87  12.61331513 26.6021616  0.9849180
88   9.23408745 20.8224853  0.9696814
89   9.18013011 16.3798273  0.9493078
90   9.00654544 16.6527627  0.9884705
91   5.79692166 12.6810733  0.9871968
92   2.21355401  8.3269002  0.9804025
93  18.35251701 34.6859533  0.9474436
94   1.77393062  2.9486094  0.9633678
95  10.02476098 23.1356361  0.9876508
96  17.96922877 33.4193125  0.8919809
97  11.42236799 19.9734991  0.9930988
98   7.15436338 15.5744040  0.9930393
99   3.02320010 16.6178401  0.9671834
100  8.20924894 14.4701156  0.9126523
101  7.05239932 16.3877580  0.9482998
102  4.45811828  9.4059321  0.9761275
103  6.25240457 16.9558421  0.9625679
104  9.54483047 18.8885001  0.9525992
105 13.70410008         NA  0.8778105
106  4.60411047  8.1749291  0.9646530
107 10.27173820 19.7115381  0.9088237
108 10.20536529 15.9536618  0.8588734
109  7.20531179 14.4025398  0.9551374
110  3.80463495  7.0990907  0.9897810
111  8.40556415 12.7528988  0.9552899
112  9.64214159 19.9342280  0.9808227
113  8.83522324 12.0355907  0.8875236
114 13.80404490 30.4573993  0.9402282
115 17.53203691 30.1863070  0.9429713
116  8.13173978 20.5782393  0.9499830
117  9.37699000 19.7341110  0.9684700
118  2.56605590  7.7421827  0.9704082
119  8.60644142 14.4973323  0.9429946
120  6.54739761 13.8694671  0.9241980
121 18.69624336 34.2008381  0.9545398
122 11.43923504 16.4118633  0.9019385
123 11.56523762         NA  0.9349723
124  7.10744217 13.0050173  0.9742253
125 16.13657541         NA  0.9871770
126  5.75028172 16.4307576  0.9517916
127 18.38820960 31.4988368  0.9672260
128 10.49054710 20.0686560  0.9652230
129 14.18616062 18.6492726  0.9169742
130  5.63849987 14.0047191  0.9623800
131  1.84866174  5.8718338  0.9934559
132 15.04558144 27.0462125  0.9659185
133 12.46809650 19.2423844  0.9598542
134  5.15244263 13.7926856  0.9564166
135  6.17430247  8.5221541  0.8479933
136  9.70922678 20.0549187  0.9835861
137  9.75365301 17.9909624  0.8924686
138 21.16555692 35.1416923  0.9610866
139  5.82486114 18.1429941  0.9919839
140 11.23476416 14.5647353  0.8952053
141 12.49136374 17.3315245  0.9669541
142 14.22458449 27.0384348  0.9365439
143 10.96013953 21.6712201  0.8433064
144  4.76906066  9.0605827  0.9158451
145  7.65949963 17.0837361  0.7937182
146  9.66331707         NA  0.9464275
147 11.38890330 20.1174956  0.8167051
148  6.78035361  6.7617783  0.9869324
149  8.17098894 23.6575613  0.9923535
150  5.12663816 18.3576536  0.8666596</code></pre>
</div>
</div>
<p>We can compare covariates based on treatment group. Notice that those in the control group are more likely to be censored and therefore have a lower probability of being observed at time2:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>table2 <span class="ot">&lt;-</span> <span class="fu">tbl_summary</span>(data, <span class="at">by =</span> group) <span class="sc">|&gt;</span> <span class="fu">add_p</span>() <span class="sc">|&gt;</span> <span class="fu">bold_labels</span>()</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>table2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="cvyocbeegb" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#cvyocbeegb table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#cvyocbeegb thead, #cvyocbeegb tbody, #cvyocbeegb tfoot, #cvyocbeegb tr, #cvyocbeegb td, #cvyocbeegb th {
  border-style: none;
}

#cvyocbeegb p {
  margin: 0;
  padding: 0;
}

#cvyocbeegb .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#cvyocbeegb .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#cvyocbeegb .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#cvyocbeegb .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#cvyocbeegb .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cvyocbeegb .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cvyocbeegb .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cvyocbeegb .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#cvyocbeegb .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#cvyocbeegb .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#cvyocbeegb .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#cvyocbeegb .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#cvyocbeegb .gt_spanner_row {
  border-bottom-style: hidden;
}

#cvyocbeegb .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#cvyocbeegb .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#cvyocbeegb .gt_from_md > :first-child {
  margin-top: 0;
}

#cvyocbeegb .gt_from_md > :last-child {
  margin-bottom: 0;
}

#cvyocbeegb .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#cvyocbeegb .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#cvyocbeegb .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#cvyocbeegb .gt_row_group_first td {
  border-top-width: 2px;
}

#cvyocbeegb .gt_row_group_first th {
  border-top-width: 2px;
}

#cvyocbeegb .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cvyocbeegb .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#cvyocbeegb .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#cvyocbeegb .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cvyocbeegb .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cvyocbeegb .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#cvyocbeegb .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#cvyocbeegb .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#cvyocbeegb .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cvyocbeegb .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cvyocbeegb .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cvyocbeegb .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cvyocbeegb .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cvyocbeegb .gt_left {
  text-align: left;
}

#cvyocbeegb .gt_center {
  text-align: center;
}

#cvyocbeegb .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#cvyocbeegb .gt_font_normal {
  font-weight: normal;
}

#cvyocbeegb .gt_font_bold {
  font-weight: bold;
}

#cvyocbeegb .gt_font_italic {
  font-style: italic;
}

#cvyocbeegb .gt_super {
  font-size: 65%;
}

#cvyocbeegb .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#cvyocbeegb .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#cvyocbeegb .gt_indent_1 {
  text-indent: 5px;
}

#cvyocbeegb .gt_indent_2 {
  text-indent: 10px;
}

#cvyocbeegb .gt_indent_3 {
  text-indent: 15px;
}

#cvyocbeegb .gt_indent_4 {
  text-indent: 20px;
}

#cvyocbeegb .gt_indent_5 {
  text-indent: 25px;
}

#cvyocbeegb .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#cvyocbeegb div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header gt_col_headings">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="stat_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Control</strong><br>
N = 75<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Treatment</strong><br>
N = 75<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">id</td>
<td class="gt_row gt_center" headers="stat_1">38 (19, 57)</td>
<td class="gt_row gt_center" headers="stat_2">113 (94, 132)</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">baseline</td>
<td class="gt_row gt_center" headers="stat_1">50 (42, 58)</td>
<td class="gt_row gt_center" headers="stat_2">48 (41, 55)</td>
<td class="gt_row gt_center" headers="p.value">0.5</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">time1</td>
<td class="gt_row gt_center" headers="stat_1">50 (42, 59)</td>
<td class="gt_row gt_center" headers="stat_2">56 (52, 66)</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">time2</td>
<td class="gt_row gt_center" headers="stat_1">52 (45, 61)</td>
<td class="gt_row gt_center" headers="stat_2">67 (57, 76)</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Unknown</td>
<td class="gt_row gt_center" headers="stat_1">15</td>
<td class="gt_row gt_center" headers="stat_2">4</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">time2_all</td>
<td class="gt_row gt_center" headers="stat_1">50 (43, 60)</td>
<td class="gt_row gt_center" headers="stat_2">66 (58, 76)</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">severity</td>
<td class="gt_row gt_center" headers="stat_1">-0.12 (-0.57, 0.62)</td>
<td class="gt_row gt_center" headers="stat_2">0.06 (-0.52, 0.85)</td>
<td class="gt_row gt_center" headers="p.value">0.6</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">censored</td>
<td class="gt_row gt_center" headers="stat_1">15 (20%)</td>
<td class="gt_row gt_center" headers="stat_2">4 (5.3%)</td>
<td class="gt_row gt_center" headers="p.value">0.007</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">change1</td>
<td class="gt_row gt_center" headers="stat_1">0.2 (-2.1, 2.5)</td>
<td class="gt_row gt_center" headers="stat_2">9.2 (5.8, 11.4)</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">change2</td>
<td class="gt_row gt_center" headers="stat_1">1 (-2, 3)</td>
<td class="gt_row gt_center" headers="stat_2">17 (14, 21)</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Unknown</td>
<td class="gt_row gt_center" headers="stat_1">15</td>
<td class="gt_row gt_center" headers="stat_2">4</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">p_observed</td>
<td class="gt_row gt_center" headers="stat_1">0.82 (0.72, 0.90)</td>
<td class="gt_row gt_center" headers="stat_2">0.96 (0.93, 0.98)</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="4" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> Median (Q1, Q3); n (%)</td>
</tr>
<tr class="even">
<td colspan="4" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span> Wilcoxon rank sum test; Pearson’s Chi-squared test</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p>Now we add the IP weights to the data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create weights as inverse of probability of being observed</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>ipw <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> data<span class="sc">$</span>p_observed</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finally, we can do a second regression with the IP weights to estimate the average treatment effect:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Weighted analysis</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>model_ipw <span class="ot">&lt;-</span> <span class="fu">glm</span>(time2 <span class="sc">~</span> group <span class="sc">+</span> baseline, </span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> <span class="fu">subset</span>(data, <span class="sc">!</span><span class="fu">is.na</span>(time2)),</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">weights =</span> ipw)</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_ipw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = time2 ~ group + baseline, data = subset(data, !is.na(time2)), 
    weights = ipw)

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     4.26106    2.51950   1.691   0.0932 .  
groupTreatment 16.87712    1.04851  16.096   &lt;2e-16 ***
baseline        0.93346    0.04761  19.605   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for gaussian family taken to be 40.56733)

    Null deviance: 28883.2  on 130  degrees of freedom
Residual deviance:  5192.6  on 128  degrees of freedom
AIC: 845.73

Number of Fisher Scoring iterations: 2</code></pre>
</div>
</div>
<p>FInally we use this model and G-Computation to create the counterfactuals (the outcomes when treated and untreaded) for all patients.</p>
<p>To do this, we copy the dataset, set all patients to the Treatment group, then use the model to predict time2_1. Then we do the same for the control to create time2_0. The difference in means give us the effect.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Copy dataset</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>datap <span class="ot">&lt;-</span> data</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set all patients to Treatment</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>datap <span class="ot">&lt;-</span> datap <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">group =</span> <span class="st">"Treatment"</span>)</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict and store time2_1</span></span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>time2_1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_ipw, <span class="at">newdata =</span> datap, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Set all patients to Control</span></span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>datap <span class="ot">&lt;-</span> datap <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">group =</span> <span class="st">"Control"</span>)</span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict time2_0 (for control)</span></span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a>time2_0 <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_ipw, <span class="at">newdata =</span> datap, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the difference in means</span></span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(time2_1) <span class="sc">-</span> <span class="fu">mean</span>(time2_0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 16.87712</code></pre>
</div>
</div>
<p>This estimand does not adjust the outcome for baseline scores.</p>
</section>
<section id="analyzing-censored-dataset" class="level1">
<h1>Analyzing Censored Dataset</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create interaction term for the model - do this BEFORE creating the uncensored subset</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>group_numeric <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(data<span class="sc">$</span>group) <span class="sc">-</span> <span class="dv">1</span>  <span class="co"># Convert to 0/1</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>baseline_by_group <span class="ot">&lt;-</span> data<span class="sc">$</span>baseline <span class="sc">*</span> data<span class="sc">$</span>group_numeric</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create uncensored subset - AFTER creating all derived variables</span></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>data_uncensored <span class="ot">&lt;-</span> <span class="fu">subset</span>(data, censored <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Number of censored observations:"</span>, <span class="fu">sum</span>(data<span class="sc">$</span>censored)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Number of censored observations: 19"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Proportion of censored observations:"</span>, <span class="fu">mean</span>(data<span class="sc">$</span>censored)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Proportion of censored observations: 0.126666666666667"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic visualization - compare baseline by censoring status</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(censored), <span class="at">y =</span> baseline, <span class="at">fill =</span> group)) <span class="sc">+</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Baseline Scores by Group and Censoring Status"</span>) <span class="sc">+</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Censored (1 = yes, 0 = no)"</span>) <span class="sc">+</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Baseline Score"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Baseline-Change_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create change scores</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>change1 <span class="ot">&lt;-</span> data<span class="sc">$</span>time1 <span class="sc">-</span> data<span class="sc">$</span>baseline</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>change2 <span class="ot">&lt;-</span> data<span class="sc">$</span>time2 <span class="sc">-</span> data<span class="sc">$</span>baseline</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Longitudinal plot with censoring indicated</span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>data_long <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(baseline, time1, time2),</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"time"</span>,</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"score"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> <span class="fu">factor</span>(time, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"baseline"</span>, <span class="st">"time1"</span>, <span class="st">"time2"</span>),</span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Baseline"</span>, <span class="st">"Time 1"</span>, <span class="st">"Time 2"</span>)))</span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Add transparency based on censoring (censored data points are more transparent)</span></span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_long, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> score, <span class="at">group =</span> <span class="fu">interaction</span>(id, group), </span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a>                      <span class="at">color =</span> group, <span class="at">alpha =</span> <span class="fu">factor</span>(censored))) <span class="sc">+</span></span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_alpha_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"0"</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"1"</span> <span class="ot">=</span> <span class="fl">0.2</span>), <span class="at">name =</span> <span class="st">"Censored"</span>) <span class="sc">+</span></span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">data =</span> <span class="fu">subset</span>(data_long, <span class="sc">!</span>(time <span class="sc">==</span> <span class="st">"Time 2"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(score))),</span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">group =</span> group), <span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb99-20"><a href="#cb99-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">data =</span> <span class="fu">subset</span>(data_long, <span class="sc">!</span>(time <span class="sc">==</span> <span class="st">"Time 2"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(score))),</span>
<span id="cb99-21"><a href="#cb99-21" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">group =</span> group), <span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb99-22"><a href="#cb99-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb99-23"><a href="#cb99-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Change in Scores Over Time by Group (with Censoring)"</span>) <span class="sc">+</span></span>
<span id="cb99-24"><a href="#cb99-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Score"</span>) <span class="sc">+</span></span>
<span id="cb99-25"><a href="#cb99-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Measurement Time"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 19 rows containing missing values or values outside the scale range
(`geom_line()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Baseline-Change_files/figure-html/unnamed-chunk-36-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define SEM model for uncensored data</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="co"># We need a separate model because the censoring variable has no variance in the uncensored subset</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>model_uncens <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a><span class="st">  # Latent variable for true change</span></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a><span class="st">  change =~ change1 + change2</span></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a><span class="st">  # Regression paths: group, baseline, and severity predict change</span></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a><span class="st">  # Group represents treatment effect</span></span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a><span class="st">  # Baseline represents the proportional nature of the effect</span></span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a><span class="st">  # Severity represents the hidden confounding variable</span></span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a><span class="st">  change ~ group + baseline + severity</span></span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a><span class="st">  # Allow residual correlation between time points</span></span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a><span class="st">  change1 ~~ change2</span></span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb101-16"><a href="#cb101-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-17"><a href="#cb101-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model using only uncensored data (creates bias)</span></span>
<span id="cb101-18"><a href="#cb101-18" aria-hidden="true" tabindex="-1"></a>fit_uncens <span class="ot">&lt;-</span> <span class="fu">sem</span>(model_uncens, <span class="at">data =</span> data_uncensored)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: lavaan-&gt;lav_model_vcov():  
   Could not compute standard errors! The information matrix could not be 
   inverted. This may be a symptom that the model is not identified.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_uncens, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 45 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         8

  Number of observations                           131

Model Test User Model:
                                                      
  Test statistic                                 3.983
  Degrees of freedom                                 1
  P-value (Chi-square)                           0.046

Model Test Baseline Model:

  Test statistic                               471.982
  Degrees of freedom                                 7
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.994
  Tucker-Lewis Index (TLI)                       0.955

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)               -677.067
  Loglikelihood unrestricted model (H1)       -675.076
                                                      
  Akaike (AIC)                                1370.135
  Bayesian (BIC)                              1393.136
  Sample-size adjusted Bayesian (SABIC)       1367.833

Root Mean Square Error of Approximation:

  RMSEA                                          0.151
  90 Percent confidence interval - lower         0.017
  90 Percent confidence interval - upper         0.318
  P-value H_0: RMSEA &lt;= 0.050                    0.082
  P-value H_0: RMSEA &gt;= 0.080                    0.858

Standardized Root Mean Square Residual:

  SRMR                                           0.019

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  change =~                                                             
    change1           1.000                               5.300    0.903
    change2           1.931       NA                     10.234    0.979

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  change ~                                                              
    group             8.567       NA                      1.617    0.805
    baseline          0.061       NA                      0.011    0.126
    severity          2.213       NA                      0.417    0.372

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
 .change1 ~~                                                            
   .change2           3.363       NA                      3.363    0.619

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .change1           6.338       NA                      6.338    0.184
   .change2           4.649       NA                      4.649    0.043
   .change            5.727       NA                      0.204    0.204</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model that ignores severity (misspecified)</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>model_misspec <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="st">  # Latent variable for true change</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="st">  change =~ change1 + change2</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a><span class="st">  # Regression paths: only group and baseline predict change</span></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a><span class="st">  # Missing the severity variable (creates omitted variable bias)</span></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a><span class="st">  change ~ group + baseline</span></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a><span class="st">  # Allow residual correlation between time points</span></span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a><span class="st">  change1 ~~ change2</span></span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the misspecified model with all data using FIML</span></span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a>fit_misspec <span class="ot">&lt;-</span> <span class="fu">sem</span>(model_misspec, <span class="at">data =</span> data, <span class="at">missing =</span> <span class="st">"fiml"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: lavaan-&gt;lav_model_vcov():  
   The variance-covariance matrix of the estimated parameters (vcov) does not 
   appear to be positive definite! The smallest eigenvalue (= -1.976555e+10) 
   is smaller than zero. This may be a symptom that the model is not 
   identified.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_misspec, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: lavaan-&gt;lav_fit_cfi_lavobject():  
   computation of robust CFI failed.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: lavaan-&gt;lav_fit_rmsea_lavobject():  
   computation of robust RMSEA failed.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 56 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         9

  Number of observations                           150
  Number of missing patterns                         2

Model Test User Model:
                                                      
  Test statistic                                 2.107
  Degrees of freedom                                 0

Model Test Baseline Model:

  Test statistic                               450.334
  Degrees of freedom                                 5
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.995
  Tucker-Lewis Index (TLI)                       1.000
                                                      
  Robust Comparative Fit Index (CFI)                NA
  Robust Tucker-Lewis Index (TLI)                   NA

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)               -751.195
  Loglikelihood unrestricted model (H1)       -750.141
                                                      
  Akaike (AIC)                                1520.389
  Bayesian (BIC)                              1547.485
  Sample-size adjusted Bayesian (SABIC)       1519.002

Root Mean Square Error of Approximation:

  RMSEA                                          0.000
  90 Percent confidence interval - lower         0.000
  90 Percent confidence interval - upper         0.000
  P-value H_0: RMSEA &lt;= 0.050                       NA
  P-value H_0: RMSEA &gt;= 0.080                       NA
                                                      
  Robust RMSEA                                      NA
  90 Percent confidence interval - lower            NA
  90 Percent confidence interval - upper            NA
  P-value H_0: Robust RMSEA &lt;= 0.050                NA
  P-value H_0: Robust RMSEA &gt;= 0.080                NA

Standardized Root Mean Square Residual:

  SRMR                                           0.011

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Observed
  Observed information based on                Hessian

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  change =~                                                             
    change1           1.000                               5.417    0.901
    change2           1.911    0.072   26.529    0.000   10.350    0.969

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  change ~                                                              
    group             9.199    0.628   14.654    0.000    1.698    0.849
    baseline         -0.017    0.024   -0.709    0.478   -0.003   -0.035

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
 .change1 ~~                                                            
   .change2           4.398       NA                      4.398    0.644

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .change1          -8.258    1.537   -5.373    0.000   -8.258   -1.374
   .change2         -15.405    2.876   -5.356    0.000  -15.405   -1.443

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .change1           6.801       NA                      6.801    0.188
   .change2           6.848       NA                      6.848    0.060
   .change            8.051       NA                      0.274    0.274</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the misspecified model with uncensored data only (double bias)</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>fit_misspec_uncens <span class="ot">&lt;-</span> <span class="fu">sem</span>(model_misspec, <span class="at">data =</span> data_uncensored)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: lavaan-&gt;lav_model_vcov():  
   Could not compute standard errors! The information matrix could not be 
   inverted. This may be a symptom that the model is not identified.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_misspec_uncens, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 45 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         7

  Number of observations                           131

Model Test User Model:
                                                      
  Test statistic                                 3.982
  Degrees of freedom                                 0

Model Test Baseline Model:

  Test statistic                               427.674
  Degrees of freedom                                 5
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.991
  Tucker-Lewis Index (TLI)                       1.000

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)               -699.221
  Loglikelihood unrestricted model (H1)       -697.230
                                                      
  Akaike (AIC)                                1412.442
  Bayesian (BIC)                              1432.569
  Sample-size adjusted Bayesian (SABIC)       1410.428

Root Mean Square Error of Approximation:

  RMSEA                                          0.000
  90 Percent confidence interval - lower         0.000
  90 Percent confidence interval - upper         0.000
  P-value H_0: RMSEA &lt;= 0.050                       NA
  P-value H_0: RMSEA &gt;= 0.080                       NA

Standardized Root Mean Square Residual:

  SRMR                                           0.021

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  change =~                                                             
    change1           1.000                               5.253    0.895
    change2           1.932       NA                     10.148    0.970

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  change ~                                                              
    group             8.747       NA                      1.665    0.830
    baseline         -0.033       NA                     -0.006   -0.069

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
 .change1 ~~                                                            
   .change2           4.289       NA                      4.289    0.649

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .change1           6.829       NA                      6.829    0.198
   .change2           6.393       NA                      6.393    0.058
   .change            8.037       NA                      0.291    0.291</code></pre>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare treatment effect estimates across models </span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="co"># We need to handle the case where some models may not have been successfully fit</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>treatmentEffect <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">character</span>(),</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Estimate =</span> <span class="fu">numeric</span>(),</span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract treatment effect from model1 </span></span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">exists</span>(<span class="st">"fit_cens"</span>)) {</span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a>  idx <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">parameterEstimates</span>(fit_cens)<span class="sc">$</span>lhs <span class="sc">==</span> <span class="st">"change"</span> <span class="sc">&amp;</span> </span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a>               <span class="fu">parameterEstimates</span>(fit_cens)<span class="sc">$</span>rhs <span class="sc">==</span> <span class="st">"group"</span>)</span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(idx) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb115-14"><a href="#cb115-14" aria-hidden="true" tabindex="-1"></a>    treatmentEffect <span class="ot">&lt;-</span> <span class="fu">rbind</span>(treatmentEffect, </span>
<span id="cb115-15"><a href="#cb115-15" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">data.frame</span>(<span class="at">Model =</span> <span class="st">"Complete + Severity"</span>, </span>
<span id="cb115-16"><a href="#cb115-16" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">Estimate =</span> <span class="fu">parameterEstimates</span>(fit_cens)[idx, <span class="st">"est"</span>]))</span>
<span id="cb115-17"><a href="#cb115-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb115-18"><a href="#cb115-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb115-19"><a href="#cb115-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-20"><a href="#cb115-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract from model with uncensored data + severity</span></span>
<span id="cb115-21"><a href="#cb115-21" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">exists</span>(<span class="st">"fit_uncens"</span>)) {</span>
<span id="cb115-22"><a href="#cb115-22" aria-hidden="true" tabindex="-1"></a>  idx <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">parameterEstimates</span>(fit_uncens)<span class="sc">$</span>lhs <span class="sc">==</span> <span class="st">"change"</span> <span class="sc">&amp;</span> </span>
<span id="cb115-23"><a href="#cb115-23" aria-hidden="true" tabindex="-1"></a>               <span class="fu">parameterEstimates</span>(fit_uncens)<span class="sc">$</span>rhs <span class="sc">==</span> <span class="st">"group"</span>)</span>
<span id="cb115-24"><a href="#cb115-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(idx) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb115-25"><a href="#cb115-25" aria-hidden="true" tabindex="-1"></a>    treatmentEffect <span class="ot">&lt;-</span> <span class="fu">rbind</span>(treatmentEffect, </span>
<span id="cb115-26"><a href="#cb115-26" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">data.frame</span>(<span class="at">Model =</span> <span class="st">"Uncensored + Severity"</span>, </span>
<span id="cb115-27"><a href="#cb115-27" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">Estimate =</span> <span class="fu">parameterEstimates</span>(fit_uncens)[idx, <span class="st">"est"</span>]))</span>
<span id="cb115-28"><a href="#cb115-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb115-29"><a href="#cb115-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb115-30"><a href="#cb115-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-31"><a href="#cb115-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract from misspecified model</span></span>
<span id="cb115-32"><a href="#cb115-32" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">exists</span>(<span class="st">"fit_misspec"</span>)) {</span>
<span id="cb115-33"><a href="#cb115-33" aria-hidden="true" tabindex="-1"></a>  idx <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">parameterEstimates</span>(fit_misspec)<span class="sc">$</span>lhs <span class="sc">==</span> <span class="st">"change"</span> <span class="sc">&amp;</span> </span>
<span id="cb115-34"><a href="#cb115-34" aria-hidden="true" tabindex="-1"></a>               <span class="fu">parameterEstimates</span>(fit_misspec)<span class="sc">$</span>rhs <span class="sc">==</span> <span class="st">"group"</span>)</span>
<span id="cb115-35"><a href="#cb115-35" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(idx) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb115-36"><a href="#cb115-36" aria-hidden="true" tabindex="-1"></a>    treatmentEffect <span class="ot">&lt;-</span> <span class="fu">rbind</span>(treatmentEffect, </span>
<span id="cb115-37"><a href="#cb115-37" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">data.frame</span>(<span class="at">Model =</span> <span class="st">"Complete w/o Severity"</span>, </span>
<span id="cb115-38"><a href="#cb115-38" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">Estimate =</span> <span class="fu">parameterEstimates</span>(fit_misspec)[idx, <span class="st">"est"</span>]))</span>
<span id="cb115-39"><a href="#cb115-39" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb115-40"><a href="#cb115-40" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb115-41"><a href="#cb115-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-42"><a href="#cb115-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract from misspecified model with uncensored data</span></span>
<span id="cb115-43"><a href="#cb115-43" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">exists</span>(<span class="st">"fit_misspec_uncens"</span>)) {</span>
<span id="cb115-44"><a href="#cb115-44" aria-hidden="true" tabindex="-1"></a>  idx <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">parameterEstimates</span>(fit_misspec_uncens)<span class="sc">$</span>lhs <span class="sc">==</span> <span class="st">"change"</span> <span class="sc">&amp;</span> </span>
<span id="cb115-45"><a href="#cb115-45" aria-hidden="true" tabindex="-1"></a>               <span class="fu">parameterEstimates</span>(fit_misspec_uncens)<span class="sc">$</span>rhs <span class="sc">==</span> <span class="st">"group"</span>)</span>
<span id="cb115-46"><a href="#cb115-46" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(idx) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb115-47"><a href="#cb115-47" aria-hidden="true" tabindex="-1"></a>    treatmentEffect <span class="ot">&lt;-</span> <span class="fu">rbind</span>(treatmentEffect, </span>
<span id="cb115-48"><a href="#cb115-48" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">data.frame</span>(<span class="at">Model =</span> <span class="st">"Uncensored w/o Severity"</span>, </span>
<span id="cb115-49"><a href="#cb115-49" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">Estimate =</span> <span class="fu">parameterEstimates</span>(fit_misspec_uncens)[idx, <span class="st">"est"</span>]))</span>
<span id="cb115-50"><a href="#cb115-50" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb115-51"><a href="#cb115-51" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb115-52"><a href="#cb115-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-53"><a href="#cb115-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the comparison table</span></span>
<span id="cb115-54"><a href="#cb115-54" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Treatment Effect Estimates Across Models:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Treatment Effect Estimates Across Models:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(treatmentEffect)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    Model Estimate
1   Uncensored + Severity 8.567213
2   Complete w/o Severity 9.199172
3 Uncensored w/o Severity 8.747494</code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This comparison table shows the bias introduced by analyzing only uncensored participants</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="co"># and by omitting important confounding variables from the model</span></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative model with latent variables for each time point</span></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="co"># For proportional effects, we need interaction terms</span></span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a><span class="st">  # Latent variables for each time point</span></span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a><span class="st">  baseline =~ 1*baseline</span></span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a><span class="st">  followup1 =~ 1*time1</span></span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a><span class="st">  followup2 =~ 1*time2</span></span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb119-12"><a href="#cb119-12" aria-hidden="true" tabindex="-1"></a><span class="st">  # Regression paths from baseline to follow-ups</span></span>
<span id="cb119-13"><a href="#cb119-13" aria-hidden="true" tabindex="-1"></a><span class="st">  followup1 ~ baseline</span></span>
<span id="cb119-14"><a href="#cb119-14" aria-hidden="true" tabindex="-1"></a><span class="st">  followup2 ~ baseline + followup1</span></span>
<span id="cb119-15"><a href="#cb119-15" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb119-16"><a href="#cb119-16" aria-hidden="true" tabindex="-1"></a><span class="st">  # Effect of treatment on follow-ups</span></span>
<span id="cb119-17"><a href="#cb119-17" aria-hidden="true" tabindex="-1"></a><span class="st">  # Direct effects of group</span></span>
<span id="cb119-18"><a href="#cb119-18" aria-hidden="true" tabindex="-1"></a><span class="st">  followup1 ~ group</span></span>
<span id="cb119-19"><a href="#cb119-19" aria-hidden="true" tabindex="-1"></a><span class="st">  followup2 ~ group</span></span>
<span id="cb119-20"><a href="#cb119-20" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb119-21"><a href="#cb119-21" aria-hidden="true" tabindex="-1"></a><span class="st">  # Interaction effects (proportional effects)</span></span>
<span id="cb119-22"><a href="#cb119-22" aria-hidden="true" tabindex="-1"></a><span class="st">  # Create interaction term in the data first</span></span>
<span id="cb119-23"><a href="#cb119-23" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb119-24"><a href="#cb119-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-25"><a href="#cb119-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative model with latent variables and missing data handling</span></span>
<span id="cb119-26"><a href="#cb119-26" aria-hidden="true" tabindex="-1"></a>model2_cens <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb119-27"><a href="#cb119-27" aria-hidden="true" tabindex="-1"></a><span class="st">  # Latent variables for each time point - avoid name collisions with observed variables</span></span>
<span id="cb119-28"><a href="#cb119-28" aria-hidden="true" tabindex="-1"></a><span class="st">  latent_baseline =~ 1*baseline</span></span>
<span id="cb119-29"><a href="#cb119-29" aria-hidden="true" tabindex="-1"></a><span class="st">  latent_followup1 =~ 1*time1</span></span>
<span id="cb119-30"><a href="#cb119-30" aria-hidden="true" tabindex="-1"></a><span class="st">  latent_followup2 =~ 1*time2</span></span>
<span id="cb119-31"><a href="#cb119-31" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb119-32"><a href="#cb119-32" aria-hidden="true" tabindex="-1"></a><span class="st">  # Regression paths from baseline to follow-ups</span></span>
<span id="cb119-33"><a href="#cb119-33" aria-hidden="true" tabindex="-1"></a><span class="st">  latent_followup1 ~ latent_baseline</span></span>
<span id="cb119-34"><a href="#cb119-34" aria-hidden="true" tabindex="-1"></a><span class="st">  latent_followup2 ~ latent_baseline + latent_followup1</span></span>
<span id="cb119-35"><a href="#cb119-35" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb119-36"><a href="#cb119-36" aria-hidden="true" tabindex="-1"></a><span class="st">  # Effect of treatment on follow-ups</span></span>
<span id="cb119-37"><a href="#cb119-37" aria-hidden="true" tabindex="-1"></a><span class="st">  # Direct effects of group</span></span>
<span id="cb119-38"><a href="#cb119-38" aria-hidden="true" tabindex="-1"></a><span class="st">  latent_followup1 ~ group</span></span>
<span id="cb119-39"><a href="#cb119-39" aria-hidden="true" tabindex="-1"></a><span class="st">  latent_followup2 ~ group</span></span>
<span id="cb119-40"><a href="#cb119-40" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb119-41"><a href="#cb119-41" aria-hidden="true" tabindex="-1"></a><span class="st">  # Severity affects outcomes</span></span>
<span id="cb119-42"><a href="#cb119-42" aria-hidden="true" tabindex="-1"></a><span class="st">  latent_baseline ~ severity</span></span>
<span id="cb119-43"><a href="#cb119-43" aria-hidden="true" tabindex="-1"></a><span class="st">  latent_followup1 ~ severity</span></span>
<span id="cb119-44"><a href="#cb119-44" aria-hidden="true" tabindex="-1"></a><span class="st">  latent_followup2 ~ severity</span></span>
<span id="cb119-45"><a href="#cb119-45" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb119-46"><a href="#cb119-46" aria-hidden="true" tabindex="-1"></a><span class="st">  # Censoring is related to severity and treatment</span></span>
<span id="cb119-47"><a href="#cb119-47" aria-hidden="true" tabindex="-1"></a><span class="st">  censored ~ severity + group</span></span>
<span id="cb119-48"><a href="#cb119-48" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb119-49"><a href="#cb119-49" aria-hidden="true" tabindex="-1"></a><span class="st">  # Interaction effects (proportional effects)</span></span>
<span id="cb119-50"><a href="#cb119-50" aria-hidden="true" tabindex="-1"></a><span class="st">  latent_followup1 ~ baseline_by_group</span></span>
<span id="cb119-51"><a href="#cb119-51" aria-hidden="true" tabindex="-1"></a><span class="st">  latent_followup2 ~ baseline_by_group</span></span>
<span id="cb119-52"><a href="#cb119-52" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb119-53"><a href="#cb119-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-54"><a href="#cb119-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Create interaction term for the model if not already there</span></span>
<span id="cb119-55"><a href="#cb119-55" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="st">"baseline_by_group"</span> <span class="sc">%in%</span> <span class="fu">names</span>(data)) {</span>
<span id="cb119-56"><a href="#cb119-56" aria-hidden="true" tabindex="-1"></a>  data<span class="sc">$</span>group_numeric <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(data<span class="sc">$</span>group) <span class="sc">-</span> <span class="dv">1</span>  <span class="co"># Convert to 0/1</span></span>
<span id="cb119-57"><a href="#cb119-57" aria-hidden="true" tabindex="-1"></a>  data<span class="sc">$</span>baseline_by_group <span class="ot">&lt;-</span> data<span class="sc">$</span>baseline <span class="sc">*</span> data<span class="sc">$</span>group_numeric</span>
<span id="cb119-58"><a href="#cb119-58" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb119-59"><a href="#cb119-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-60"><a href="#cb119-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the censoring-aware model with FIML</span></span>
<span id="cb119-61"><a href="#cb119-61" aria-hidden="true" tabindex="-1"></a>fit2_cens <span class="ot">&lt;-</span> <span class="fu">sem</span>(model2_cens, <span class="at">data =</span> data, <span class="at">missing =</span> <span class="st">"fiml"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: lavaan-&gt;lav_data_full():  
   some observed variances are (at least) a factor 1000 times larger than 
   others; use varTable(fit) to investigate</code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit2_cens, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: lavaan-&gt;lav_fit_cfi_lavobject():  
   computation of robust CFI failed.
Warning: lavaan-&gt;lav_fit_rmsea_lavobject():  
   computation of robust RMSEA failed.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 195 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        21

  Number of observations                           150
  Number of missing patterns                         2

Model Test User Model:
                                                      
  Test statistic                                96.083
  Degrees of freedom                                 5
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                               946.156
  Degrees of freedom                                18
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.902
  Tucker-Lewis Index (TLI)                       0.647
                                                      
  Robust Comparative Fit Index (CFI)                NA
  Robust Tucker-Lewis Index (TLI)                   NA

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -1314.125
  Loglikelihood unrestricted model (H1)      -1266.083
                                                      
  Akaike (AIC)                                2670.249
  Bayesian (BIC)                              2733.472
  Sample-size adjusted Bayesian (SABIC)       2667.011

Root Mean Square Error of Approximation:

  RMSEA                                          0.348
  90 Percent confidence interval - lower         0.290
  90 Percent confidence interval - upper         0.411
  P-value H_0: RMSEA &lt;= 0.050                    0.000
  P-value H_0: RMSEA &gt;= 0.080                    1.000
                                                      
  Robust RMSEA                                      NA
  90 Percent confidence interval - lower            NA
  90 Percent confidence interval - upper            NA
  P-value H_0: Robust RMSEA &lt;= 0.050                NA
  P-value H_0: Robust RMSEA &gt;= 0.080                NA

Standardized Root Mean Square Residual:

  SRMR                                           0.109

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Observed
  Observed information based on                Hessian

Latent Variables:
                      Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  latent_baseline =~                                                       
    baseline             1.000                              11.235    1.000
  latent_followup1 =~                                                      
    time1                1.000                              12.644    1.000
  latent_followup2 =~                                                      
    time2                1.000                              15.864    1.000

Regressions:
                     Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  latent_followup1 ~                                                      
    latent_baselin      1.088    0.042   26.105    0.000    0.967    0.967
  latent_followup2 ~                                                      
    latent_baselin     -0.172    0.085   -2.009    0.045   -0.122   -0.122
    latent_follwp1      1.210    0.074   16.419    0.000    0.965    0.965
  latent_followup1 ~                                                      
    group              13.495    2.637    5.117    0.000    1.067    0.534
  latent_followup2 ~                                                      
    group               4.058  257.424    0.016    0.987    0.256    0.128
  latent_baseline ~                                                       
    severity           -6.661    0.813   -8.197    0.000   -0.593   -0.556
  latent_followup1 ~                                                      
    severity            1.712    0.374    4.579    0.000    0.135    0.127
  latent_followup2 ~                                                      
    severity            0.757  177.032    0.004    0.997    0.048    0.045
  censored ~                                                              
    severity            0.105    0.027    3.919    0.000    0.105    0.297
    group              -0.153    0.050   -3.037    0.002   -0.153   -0.230
  latent_followup1 ~                                                      
    baselin_by_grp     -0.088    0.052   -1.690    0.091   -0.007   -0.179
  latent_followup2 ~                                                      
    baselin_by_grp      0.071    0.048    1.469    0.142    0.004    0.115

Covariances:
                      Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
 .latent_followup2 ~~                                                      
   .censored            -0.809  160.289   -0.005    0.996   -0.207   -0.669

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .baseline         49.911    0.766   65.150    0.000   49.911    4.443
   .time1            36.409    2.857   12.743    0.000   36.409    2.880
   .time2            28.438  582.291    0.049    0.961   28.438    1.793
   .censored          0.347    0.080    4.347    0.000    0.347    1.043

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .baseline          0.000                               0.000    0.000
   .time1             0.000                               0.000    0.000
   .time2             0.000                               0.000    0.000
   .censored          0.095    0.011    8.660    0.000    0.095    0.863
   .latent_baselin   87.174   10.066    8.660    0.000    0.691    0.691
   .latent_follwp1   12.735    1.471    8.660    0.000    0.080    0.080
   .latent_follwp2   15.332 2717.042    0.006    0.995    0.061    0.061</code></pre>
</div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the censoring-aware model</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(fit2_cens, <span class="at">what =</span> <span class="st">"est"</span>, <span class="at">fade =</span> <span class="cn">FALSE</span>, <span class="at">residuals =</span> <span class="cn">FALSE</span>, </span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">edge.label.cex =</span> <span class="fl">0.8</span>, </span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="cn">FALSE</span>, </span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">layout =</span> <span class="st">"tree2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Baseline-Change_files/figure-html/unnamed-chunk-36-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a simplified version for uncensored data only</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>model2_simple <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="st">  # Latent variables for each time point - avoid name collisions</span></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a><span class="st">  latent_baseline =~ 1*baseline</span></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a><span class="st">  latent_followup1 =~ 1*time1</span></span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a><span class="st">  latent_followup2 =~ 1*time2</span></span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a><span class="st">  # Regression paths from baseline to follow-ups</span></span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a><span class="st">  latent_followup1 ~ latent_baseline</span></span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a><span class="st">  latent_followup2 ~ latent_baseline + latent_followup1</span></span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a><span class="st">  # Effect of treatment on follow-ups</span></span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a><span class="st">  # Direct effects of group</span></span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a><span class="st">  latent_followup1 ~ group</span></span>
<span id="cb125-15"><a href="#cb125-15" aria-hidden="true" tabindex="-1"></a><span class="st">  latent_followup2 ~ group</span></span>
<span id="cb125-16"><a href="#cb125-16" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb125-17"><a href="#cb125-17" aria-hidden="true" tabindex="-1"></a><span class="st">  # Interaction effects (proportional effects)</span></span>
<span id="cb125-18"><a href="#cb125-18" aria-hidden="true" tabindex="-1"></a><span class="st">  latent_followup1 ~ baseline_by_group</span></span>
<span id="cb125-19"><a href="#cb125-19" aria-hidden="true" tabindex="-1"></a><span class="st">  latent_followup2 ~ baseline_by_group</span></span>
<span id="cb125-20"><a href="#cb125-20" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb125-21"><a href="#cb125-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-22"><a href="#cb125-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the simplified model with uncensored data only</span></span>
<span id="cb125-23"><a href="#cb125-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Check first that required variables exist in the dataset</span></span>
<span id="cb125-24"><a href="#cb125-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Variables in data_uncensored:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Variables in data_uncensored:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">names</span>(data_uncensored))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "id"                "group"             "baseline"         
 [4] "time1"             "time2"             "time2_all"        
 [7] "severity"          "censored"          "change1"          
[10] "change2"           "p_observed"        "ipw"              
[13] "group_numeric"     "baseline_by_group"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify that baseline_by_group exists in the dataset</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="st">"baseline_by_group"</span> <span class="sc">%in%</span> <span class="fu">names</span>(data_uncensored)) {</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>  fit2_uncens <span class="ot">&lt;-</span> <span class="fu">sem</span>(model2_simple, <span class="at">data =</span> data_uncensored)</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(fit2_uncens, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"Error: baseline_by_group missing from data_uncensored"</span>)</span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create it again just to be sure</span></span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a>  data_uncensored<span class="sc">$</span>group_numeric <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(data_uncensored<span class="sc">$</span>group) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a>  data_uncensored<span class="sc">$</span>baseline_by_group <span class="ot">&lt;-</span> data_uncensored<span class="sc">$</span>baseline <span class="sc">*</span> data_uncensored<span class="sc">$</span>group_numeric</span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Now try fitting the model</span></span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true" tabindex="-1"></a>  fit2_uncens <span class="ot">&lt;-</span> <span class="fu">sem</span>(model2_simple, <span class="at">data =</span> data_uncensored)</span>
<span id="cb129-13"><a href="#cb129-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(fit2_uncens, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span>
<span id="cb129-14"><a href="#cb129-14" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 79 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        10

  Number of observations                           131

Model Test User Model:
                                                      
  Test statistic                               127.045
  Degrees of freedom                                 2
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                               797.394
  Degrees of freedom                                 9
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.841
  Tucker-Lewis Index (TLI)                       0.286

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -1196.655
  Loglikelihood unrestricted model (H1)      -1133.132
                                                      
  Akaike (AIC)                                2413.309
  Bayesian (BIC)                              2442.061
  Sample-size adjusted Bayesian (SABIC)       2410.432

Root Mean Square Error of Approximation:

  RMSEA                                          0.691
  90 Percent confidence interval - lower         0.592
  90 Percent confidence interval - upper         0.795
  P-value H_0: RMSEA &lt;= 0.050                    0.000
  P-value H_0: RMSEA &gt;= 0.080                    1.000

Standardized Root Mean Square Residual:

  SRMR                                           0.107

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                      Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  latent_baseline =~                                                       
    baseline             1.000                              11.017    1.000
  latent_followup1 =~                                                      
    time1                1.000                              12.086    1.000
  latent_followup2 =~                                                      
    time2                1.000                              14.666    1.000

Regressions:
                     Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  latent_followup1 ~                                                      
    latent_baselin      0.963    0.030   31.745    0.000    0.878    0.878
  latent_followup2 ~                                                      
    latent_baselin     -0.358    0.073   -4.906    0.000   -0.269   -0.269
    latent_follwp1      1.350    0.071   18.959    0.000    1.112    1.112
  latent_followup1 ~                                                      
    group              11.204    2.023    5.540    0.000    0.927    0.462
  latent_followup2 ~                                                      
    group               2.833    1.831    1.547    0.122    0.193    0.096
  latent_followup1 ~                                                      
    baselin_by_grp     -0.052    0.039   -1.328    0.184   -0.004   -0.111
  latent_followup2 ~                                                      
    baselin_by_grp      0.049    0.032    1.513    0.130    0.003    0.085

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .baseline          0.000                               0.000    0.000
   .time1             0.000                               0.000    0.000
   .time2             0.000                               0.000    0.000
    latent_baselin  121.377   14.997    8.093    0.000    1.000    1.000
   .latent_follwp1   14.635    1.808    8.093    0.000    0.100    0.100
   .latent_follwp2    9.714    1.200    8.093    0.000    0.045    0.045</code></pre>
</div>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Interpretation</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="co"># For data with censoring and proportional treatment effects:</span></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a><span class="co"># In this simulation:</span></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. SELECTION BIAS MECHANISM:</span></span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a><span class="co">#    - We created a "severity" latent variable that affects:</span></span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a><span class="co">#      a) Baseline scores (sicker patients have lower scores)</span></span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a><span class="co">#      b) Treatment effect (treatment works better for sicker patients)</span></span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a><span class="co">#      c) Censoring probability (sicker patients more likely to drop out)</span></span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a><span class="co">#    - Treatment group participants are less likely to be censored</span></span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a><span class="co">#    - Participants with less improvement are more likely to be censored</span></span>
<span id="cb131-13"><a href="#cb131-13" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb131-14"><a href="#cb131-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. BIAS IN THE TREATMENT EFFECT ESTIMATE:</span></span>
<span id="cb131-15"><a href="#cb131-15" aria-hidden="true" tabindex="-1"></a><span class="co">#    - Complete model with severity included (fit_cens): Most accurate estimate</span></span>
<span id="cb131-16"><a href="#cb131-16" aria-hidden="true" tabindex="-1"></a><span class="co">#    - Uncensored data with severity included (fit_uncens): Biased estimate</span></span>
<span id="cb131-17"><a href="#cb131-17" aria-hidden="true" tabindex="-1"></a><span class="co">#      (typically underestimates treatment effect because sicker patients</span></span>
<span id="cb131-18"><a href="#cb131-18" aria-hidden="true" tabindex="-1"></a><span class="co">#      who would benefit more are more likely to drop out)</span></span>
<span id="cb131-19"><a href="#cb131-19" aria-hidden="true" tabindex="-1"></a><span class="co">#    - Models without severity (fit_misspec &amp; fit_misspec_uncens): Biased due to</span></span>
<span id="cb131-20"><a href="#cb131-20" aria-hidden="true" tabindex="-1"></a><span class="co">#      omitted variable bias (severity affects both censoring and outcomes)</span></span>
<span id="cb131-21"><a href="#cb131-21" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb131-22"><a href="#cb131-22" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. THE BIASES INTERACT:</span></span>
<span id="cb131-23"><a href="#cb131-23" aria-hidden="true" tabindex="-1"></a><span class="co">#    - Selection bias: Analyzing only uncensored participants</span></span>
<span id="cb131-24"><a href="#cb131-24" aria-hidden="true" tabindex="-1"></a><span class="co">#    - Omitted variable bias: Not including severity variable</span></span>
<span id="cb131-25"><a href="#cb131-25" aria-hidden="true" tabindex="-1"></a><span class="co">#    - The combined effect typically leads to underestimating treatment efficacy</span></span>
<span id="cb131-26"><a href="#cb131-26" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb131-27"><a href="#cb131-27" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. PROPER HANDLING APPROACHES:</span></span>
<span id="cb131-28"><a href="#cb131-28" aria-hidden="true" tabindex="-1"></a><span class="co">#    - Full Information Maximum Likelihood (FIML) for missing data</span></span>
<span id="cb131-29"><a href="#cb131-29" aria-hidden="true" tabindex="-1"></a><span class="co">#    - Including all relevant confounders in the model</span></span>
<span id="cb131-30"><a href="#cb131-30" aria-hidden="true" tabindex="-1"></a><span class="co">#    - Sensitivity analyses for different missing data mechanisms</span></span>
<span id="cb131-31"><a href="#cb131-31" aria-hidden="true" tabindex="-1"></a><span class="co">#    - Inverse probability weighting to account for selection bias</span></span>
<span id="cb131-32"><a href="#cb131-32" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb131-33"><a href="#cb131-33" aria-hidden="true" tabindex="-1"></a><span class="co"># The comparison of treatment effect estimates across models shows how much</span></span>
<span id="cb131-34"><a href="#cb131-34" aria-hidden="true" tabindex="-1"></a><span class="co"># the estimated effect changes when using different approaches, demonstrating</span></span>
<span id="cb131-35"><a href="#cb131-35" aria-hidden="true" tabindex="-1"></a><span class="co"># the magnitude of bias from censoring and model misspecification.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># GLM Analysis for Treatment Effect with Censoring</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming the data has already been generated as in the previous code</span></span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a><span class="co"># and variables are in the 'data' dataframe</span></span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Naive GLM analysis ignoring censoring</span></span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a><span class="co"># This ignores the missing data problem and just analyzes what is observed</span></span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Model for time2 outcome, complete cases only</span></span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a>model_naive <span class="ot">&lt;-</span> <span class="fu">glm</span>(time2 <span class="sc">~</span> group <span class="sc">+</span> baseline, </span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> <span class="fu">subset</span>(data, <span class="sc">!</span><span class="fu">is.na</span>(time2)),</span>
<span id="cb132-12"><a href="#cb132-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> <span class="fu">gaussian</span>())</span>
<span id="cb132-13"><a href="#cb132-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-14"><a href="#cb132-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of naive model</span></span>
<span id="cb132-15"><a href="#cb132-15" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_naive)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = time2 ~ group + baseline, family = gaussian(), 
    data = subset(data, !is.na(time2)))

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     4.50580    2.65221   1.699   0.0918 .  
groupTreatment 16.86218    1.08034  15.608   &lt;2e-16 ***
baseline        0.92902    0.04886  19.015   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for gaussian family taken to be 37.23453)

    Null deviance: 24634  on 130  degrees of freedom
Residual deviance:  4766  on 128  degrees of freedom
AIC: 850.58

Number of Fisher Scoring iterations: 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Model for change from baseline</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate absolute change and use as outcome</span></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>abs_change <span class="ot">&lt;-</span> data<span class="sc">$</span>time2 <span class="sc">-</span> data<span class="sc">$</span>baseline</span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>model_change <span class="ot">&lt;-</span> <span class="fu">glm</span>(abs_change <span class="sc">~</span> group <span class="sc">+</span> baseline, </span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> <span class="fu">subset</span>(data, <span class="sc">!</span><span class="fu">is.na</span>(time2)),</span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">gaussian</span>())</span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_change)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = abs_change ~ group + baseline, family = gaussian(), 
    data = subset(data, !is.na(time2)))

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     4.50580    2.65221   1.699   0.0918 .  
groupTreatment 16.86218    1.08034  15.608   &lt;2e-16 ***
baseline       -0.07098    0.04886  -1.453   0.1487    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for gaussian family taken to be 37.23453)

    Null deviance: 14329  on 130  degrees of freedom
Residual deviance:  4766  on 128  degrees of freedom
AIC: 850.58

Number of Fisher Scoring iterations: 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Model for proportional change</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate proportional change and use as outcome</span></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>prop_change <span class="ot">&lt;-</span> (data<span class="sc">$</span>time2 <span class="sc">-</span> data<span class="sc">$</span>baseline) <span class="sc">/</span> data<span class="sc">$</span>baseline</span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>model_prop_change <span class="ot">&lt;-</span> <span class="fu">glm</span>(prop_change <span class="sc">~</span> group <span class="sc">+</span> baseline, </span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data =</span> <span class="fu">subset</span>(data, <span class="sc">!</span><span class="fu">is.na</span>(time2)),</span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">family =</span> <span class="fu">gaussian</span>())</span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_prop_change)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = prop_change ~ group + baseline, family = gaussian(), 
    data = subset(data, !is.na(time2)))

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     0.358680   0.060290   5.949 2.41e-08 ***
groupTreatment  0.355424   0.024558  14.473  &lt; 2e-16 ***
baseline       -0.006560   0.001111  -5.906 2.96e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for gaussian family taken to be 0.01924071)

    Null deviance: 7.7166  on 130  degrees of freedom
Residual deviance: 2.4628  on 128  degrees of freedom
AIC: -140.82

Number of Fisher Scoring iterations: 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Model that includes severity (the hidden confounder)</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>model_with_severity <span class="ot">&lt;-</span> <span class="fu">glm</span>(time2 <span class="sc">~</span> group <span class="sc">+</span> baseline <span class="sc">+</span> severity, </span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">data =</span> <span class="fu">subset</span>(data, <span class="sc">!</span><span class="fu">is.na</span>(time2)),</span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">family =</span> <span class="fu">gaussian</span>())</span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_with_severity)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = time2 ~ group + baseline + severity, family = gaussian(), 
    data = subset(data, !is.na(time2)))

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     -4.3207     2.5694  -1.682   0.0951 .  
groupTreatment  16.5067     0.9182  17.977  &lt; 2e-16 ***
baseline         1.1096     0.0486  22.831  &lt; 2e-16 ***
severity         4.2742     0.6001   7.122 7.02e-11 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for gaussian family taken to be 26.81698)

    Null deviance: 24633.8  on 130  degrees of freedom
Residual deviance:  3405.8  on 127  degrees of freedom
AIC: 808.56

Number of Fisher Scoring iterations: 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Model for censoring process - modeling factors affecting dropout</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>model_censoring <span class="ot">&lt;-</span> <span class="fu">glm</span>(censored <span class="sc">~</span> group <span class="sc">+</span> baseline <span class="sc">+</span> severity, </span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> data,</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_censoring)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = censored ~ group + baseline + severity, family = binomial(link = "logit"), 
    data = data)

Coefficients:
               Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)     0.19381    1.55197   0.125  0.90062   
groupTreatment -1.81860    0.64088  -2.838  0.00454 **
baseline       -0.03786    0.03140  -1.206  0.22785   
severity        0.79392    0.33521   2.368  0.01787 * 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 114.000  on 149  degrees of freedom
Residual deviance:  91.343  on 146  degrees of freedom
AIC: 99.343

Number of Fisher Scoring iterations: 6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Inverse probability weighting to account for censoring</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="co"># First, predict probability of being observed (not censored)</span></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>p_observed <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">predict</span>(model_censoring, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create weights as inverse of probability of being observed</span></span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>ipw <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> data<span class="sc">$</span>p_observed</span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Weighted analysis</span></span>
<span id="cb142-9"><a href="#cb142-9" aria-hidden="true" tabindex="-1"></a>model_ipw <span class="ot">&lt;-</span> <span class="fu">glm</span>(time2 <span class="sc">~</span> group <span class="sc">+</span> baseline, </span>
<span id="cb142-10"><a href="#cb142-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> <span class="fu">subset</span>(data, <span class="sc">!</span><span class="fu">is.na</span>(time2)),</span>
<span id="cb142-11"><a href="#cb142-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">family =</span> <span class="fu">gaussian</span>(),</span>
<span id="cb142-12"><a href="#cb142-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">weights =</span> ipw)</span>
<span id="cb142-13"><a href="#cb142-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-14"><a href="#cb142-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_ipw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = time2 ~ group + baseline, family = gaussian(), 
    data = subset(data, !is.na(time2)), weights = ipw)

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     4.25045    2.52366   1.684   0.0946 .  
groupTreatment 17.12982    1.05458  16.243   &lt;2e-16 ***
baseline        0.93238    0.04769  19.552   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for gaussian family taken to be 41.10012)

    Null deviance: 29350.8  on 130  degrees of freedom
Residual deviance:  5260.8  on 128  degrees of freedom
AIC: 848.08

Number of Fisher Scoring iterations: 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 7. Model with interaction between baseline and treatment</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>model_interaction <span class="ot">&lt;-</span> <span class="fu">glm</span>(time2 <span class="sc">~</span> group <span class="sc">*</span> baseline <span class="sc">+</span> severity, </span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> <span class="fu">subset</span>(data, <span class="sc">!</span><span class="fu">is.na</span>(time2)),</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">family =</span> <span class="fu">gaussian</span>())</span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_interaction)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = time2 ~ group * baseline + severity, family = gaussian(), 
    data = subset(data, !is.na(time2)))

Coefficients:
                        Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)             -2.64457    3.64385  -0.726  0.46933    
groupTreatment          13.66879    4.46062   3.064  0.00267 ** 
baseline                 1.07739    0.06948  15.506  &lt; 2e-16 ***
severity                 4.32395    0.60635   7.131 6.88e-11 ***
groupTreatment:baseline  0.05594    0.08603   0.650  0.51675    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for gaussian family taken to be 26.93943)

    Null deviance: 24633.8  on 130  degrees of freedom
Residual deviance:  3394.4  on 126  degrees of freedom
AIC: 810.12

Number of Fisher Scoring iterations: 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 8. Compare treatment effect estimates across different models</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract coefficients for the treatment effect (group)</span></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>treatment_effects <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">c</span>(</span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Naive (Complete Cases)"</span>,</span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Change Score"</span>,</span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Proportional Change"</span>,</span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"With Severity"</span>,</span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"IPW for Censoring"</span>,</span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"With Interaction"</span></span>
<span id="cb146-11"><a href="#cb146-11" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb146-12"><a href="#cb146-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Estimate =</span> <span class="fu">c</span>(</span>
<span id="cb146-13"><a href="#cb146-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coef</span>(model_naive)[<span class="st">"groupTreatment"</span>],</span>
<span id="cb146-14"><a href="#cb146-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coef</span>(model_change)[<span class="st">"groupTreatment"</span>],</span>
<span id="cb146-15"><a href="#cb146-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coef</span>(model_prop_change)[<span class="st">"groupTreatment"</span>],</span>
<span id="cb146-16"><a href="#cb146-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coef</span>(model_with_severity)[<span class="st">"groupTreatment"</span>],</span>
<span id="cb146-17"><a href="#cb146-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coef</span>(model_ipw)[<span class="st">"groupTreatment"</span>],</span>
<span id="cb146-18"><a href="#cb146-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coef</span>(model_interaction)[<span class="st">"groupTreatment"</span>]</span>
<span id="cb146-19"><a href="#cb146-19" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb146-20"><a href="#cb146-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">SE =</span> <span class="fu">c</span>(</span>
<span id="cb146-21"><a href="#cb146-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(model_naive)<span class="sc">$</span>coefficients[<span class="st">"groupTreatment"</span>, <span class="st">"Std. Error"</span>],</span>
<span id="cb146-22"><a href="#cb146-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(model_change)<span class="sc">$</span>coefficients[<span class="st">"groupTreatment"</span>, <span class="st">"Std. Error"</span>],</span>
<span id="cb146-23"><a href="#cb146-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(model_prop_change)<span class="sc">$</span>coefficients[<span class="st">"groupTreatment"</span>, <span class="st">"Std. Error"</span>],</span>
<span id="cb146-24"><a href="#cb146-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(model_with_severity)<span class="sc">$</span>coefficients[<span class="st">"groupTreatment"</span>, <span class="st">"Std. Error"</span>],</span>
<span id="cb146-25"><a href="#cb146-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(model_ipw)<span class="sc">$</span>coefficients[<span class="st">"groupTreatment"</span>, <span class="st">"Std. Error"</span>],</span>
<span id="cb146-26"><a href="#cb146-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(model_interaction)<span class="sc">$</span>coefficients[<span class="st">"groupTreatment"</span>, <span class="st">"Std. Error"</span>]</span>
<span id="cb146-27"><a href="#cb146-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb146-28"><a href="#cb146-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb146-29"><a href="#cb146-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-30"><a href="#cb146-30" aria-hidden="true" tabindex="-1"></a>treatment_effects<span class="sc">$</span>Lower_CI <span class="ot">&lt;-</span> treatment_effects<span class="sc">$</span>Estimate <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> treatment_effects<span class="sc">$</span>SE</span>
<span id="cb146-31"><a href="#cb146-31" aria-hidden="true" tabindex="-1"></a>treatment_effects<span class="sc">$</span>Upper_CI <span class="ot">&lt;-</span> treatment_effects<span class="sc">$</span>Estimate <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> treatment_effects<span class="sc">$</span>SE</span>
<span id="cb146-32"><a href="#cb146-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-33"><a href="#cb146-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Print comparison table</span></span>
<span id="cb146-34"><a href="#cb146-34" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(treatment_effects)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   Model   Estimate        SE   Lower_CI   Upper_CI
1 Naive (Complete Cases) 16.8621809 1.0803362 14.7447219 18.9796399
2           Change Score 16.8621809 1.0803362 14.7447219 18.9796399
3    Proportional Change  0.3554238 0.0245582  0.3072897  0.4035579
4          With Severity 16.5066881 0.9181923 14.7070313 18.3063450
5      IPW for Censoring 17.1298197 1.0545752 15.0628523 19.1967870
6       With Interaction 13.6687894 4.4606174  4.9259793 22.4115996</code></pre>
</div>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 9. Visualization of treatment effects across models</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(treatment_effects, <span class="fu">aes</span>(<span class="at">x =</span> Model, <span class="at">y =</span> Estimate)) <span class="sc">+</span></span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Lower_CI, <span class="at">ymax =</span> Upper_CI), <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Treatment Effect Estimates Across Different GLM Models"</span>) <span class="sc">+</span></span>
<span id="cb148-10"><a href="#cb148-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Estimated Treatment Effect"</span>) <span class="sc">+</span></span>
<span id="cb148-11"><a href="#cb148-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Baseline-Change_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 10. Calculate marginal effects of treatment at different baseline values</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="co"># This shows how the treatment effect varies with baseline</span></span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a><span class="co"># if(requireNamespace("margins", quietly = TRUE)) {</span></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   library(margins)</span></span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   # For the interaction model</span></span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   marg_effects &lt;- margins(model_interaction, </span></span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                          variables = "group",</span></span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                          at = list(baseline = seq(min(data$baseline, na.rm = TRUE),</span></span>
<span id="cb149-10"><a href="#cb149-10" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                 max(data$baseline, na.rm = TRUE),</span></span>
<span id="cb149-11"><a href="#cb149-11" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                 length.out = 10)))</span></span>
<span id="cb149-12"><a href="#cb149-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb149-13"><a href="#cb149-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   summary(marg_effects)</span></span>
<span id="cb149-14"><a href="#cb149-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb149-15"><a href="#cb149-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   # Plot the marginal effects</span></span>
<span id="cb149-16"><a href="#cb149-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   plot(marg_effects)</span></span>
<span id="cb149-17"><a href="#cb149-17" aria-hidden="true" tabindex="-1"></a><span class="co"># } else {</span></span>
<span id="cb149-18"><a href="#cb149-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Manual calculation of marginal effects at different baseline values</span></span>
<span id="cb149-19"><a href="#cb149-19" aria-hidden="true" tabindex="-1"></a>  baseline_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(data<span class="sc">$</span>baseline, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb149-20"><a href="#cb149-20" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">max</span>(data<span class="sc">$</span>baseline, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb149-21"><a href="#cb149-21" aria-hidden="true" tabindex="-1"></a>                        <span class="at">length.out =</span> <span class="dv">10</span>)</span>
<span id="cb149-22"><a href="#cb149-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb149-23"><a href="#cb149-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract coefficients</span></span>
<span id="cb149-24"><a href="#cb149-24" aria-hidden="true" tabindex="-1"></a>  b_group <span class="ot">&lt;-</span> <span class="fu">coef</span>(model_interaction)[<span class="st">"groupTreatment"</span>]</span>
<span id="cb149-25"><a href="#cb149-25" aria-hidden="true" tabindex="-1"></a>  b_interaction <span class="ot">&lt;-</span> <span class="fu">coef</span>(model_interaction)[<span class="st">"groupTreatment:baseline"</span>]</span>
<span id="cb149-26"><a href="#cb149-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb149-27"><a href="#cb149-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate marginal effect at each baseline value</span></span>
<span id="cb149-28"><a href="#cb149-28" aria-hidden="true" tabindex="-1"></a>  marginal_effects <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb149-29"><a href="#cb149-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">baseline =</span> baseline_values,</span>
<span id="cb149-30"><a href="#cb149-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">effect =</span> b_group <span class="sc">+</span> b_interaction <span class="sc">*</span> baseline_values</span>
<span id="cb149-31"><a href="#cb149-31" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb149-32"><a href="#cb149-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb149-33"><a href="#cb149-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot the marginal effects</span></span>
<span id="cb149-34"><a href="#cb149-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(marginal_effects, <span class="fu">aes</span>(<span class="at">x =</span> baseline, <span class="at">y =</span> effect)) <span class="sc">+</span></span>
<span id="cb149-35"><a href="#cb149-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb149-36"><a href="#cb149-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb149-37"><a href="#cb149-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb149-38"><a href="#cb149-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"Marginal Effect of Treatment at Different Baseline Values"</span>) <span class="sc">+</span></span>
<span id="cb149-39"><a href="#cb149-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Treatment Effect"</span>) <span class="sc">+</span></span>
<span id="cb149-40"><a href="#cb149-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Baseline Value"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Baseline-Change_files/figure-html/unnamed-chunk-37-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co">#}</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 11. Calculate the total effect of treatment on time2</span></span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a><span class="co"># For models without interaction, this is just the coefficient of group</span></span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a><span class="co"># For models with interaction, we need to evaluate at the mean baseline</span></span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Mean baseline value</span></span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a>mean_baseline <span class="ot">&lt;-</span> <span class="fu">mean</span>(data<span class="sc">$</span>baseline, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb150-9"><a href="#cb150-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-10"><a href="#cb150-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Total effect in interaction model</span></span>
<span id="cb150-11"><a href="#cb150-11" aria-hidden="true" tabindex="-1"></a>total_effect <span class="ot">&lt;-</span> <span class="fu">coef</span>(model_interaction)[<span class="st">"groupTreatment"</span>] <span class="sc">+</span> </span>
<span id="cb150-12"><a href="#cb150-12" aria-hidden="true" tabindex="-1"></a>               <span class="fu">coef</span>(model_interaction)[<span class="st">"groupTreatment:baseline"</span>] <span class="sc">*</span> mean_baseline</span>
<span id="cb150-13"><a href="#cb150-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-14"><a href="#cb150-14" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Total effect of treatment on time2 at mean baseline:"</span>, total_effect, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Total effect of treatment on time2 at mean baseline: 16.42597 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 12. Predicted outcomes for treatment vs control</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Create prediction data for a range of baseline values</span></span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>pred_data <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"Control"</span>, <span class="st">"Treatment"</span>), <span class="at">levels =</span> <span class="fu">levels</span>(data<span class="sc">$</span>group)),</span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">baseline =</span> <span class="fu">seq</span>(<span class="fu">min</span>(data<span class="sc">$</span>baseline, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">max</span>(data<span class="sc">$</span>baseline, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb152-7"><a href="#cb152-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">length.out =</span> <span class="dv">20</span>),</span>
<span id="cb152-8"><a href="#cb152-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">severity =</span> <span class="fu">mean</span>(data<span class="sc">$</span>severity, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)  <span class="co"># Fix severity at mean</span></span>
<span id="cb152-9"><a href="#cb152-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb152-10"><a href="#cb152-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-11"><a href="#cb152-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Predictions from different models</span></span>
<span id="cb152-12"><a href="#cb152-12" aria-hidden="true" tabindex="-1"></a>pred_data<span class="sc">$</span>pred_naive <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_naive, <span class="at">newdata =</span> pred_data, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb152-13"><a href="#cb152-13" aria-hidden="true" tabindex="-1"></a>pred_data<span class="sc">$</span>pred_with_severity <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_with_severity, <span class="at">newdata =</span> pred_data, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb152-14"><a href="#cb152-14" aria-hidden="true" tabindex="-1"></a>pred_data<span class="sc">$</span>pred_interaction <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_interaction, <span class="at">newdata =</span> pred_data, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb152-15"><a href="#cb152-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-16"><a href="#cb152-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot predictions</span></span>
<span id="cb152-17"><a href="#cb152-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pred_data, <span class="fu">aes</span>(<span class="at">x =</span> baseline, <span class="at">y =</span> pred_interaction, <span class="at">color =</span> group)) <span class="sc">+</span></span>
<span id="cb152-18"><a href="#cb152-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb152-19"><a href="#cb152-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb152-20"><a href="#cb152-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Predicted Time2 Values by Treatment Group and Baseline"</span>) <span class="sc">+</span></span>
<span id="cb152-21"><a href="#cb152-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Predicted Time2"</span>) <span class="sc">+</span></span>
<span id="cb152-22"><a href="#cb152-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Baseline Value"</span>) <span class="sc">+</span></span>
<span id="cb152-23"><a href="#cb152-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb152-24"><a href="#cb152-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Baseline-Change_files/figure-html/unnamed-chunk-37-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Additional analysis: Marginal effects for IPW interaction model</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>model_interaction_ipw <span class="ot">&lt;-</span> <span class="fu">glm</span>(time2 <span class="sc">~</span> group <span class="sc">*</span> baseline <span class="sc">+</span> severity, </span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">data =</span> <span class="fu">subset</span>(data, <span class="sc">!</span><span class="fu">is.na</span>(time2)),</span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">family =</span> <span class="fu">gaussian</span>(),</span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">weights =</span> ipw)</span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-8"><a href="#cb153-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">requireNamespace</span>(<span class="st">"margins"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb153-9"><a href="#cb153-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(margins)</span>
<span id="cb153-10"><a href="#cb153-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb153-11"><a href="#cb153-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Marginal effects for standard interaction model</span></span>
<span id="cb153-12"><a href="#cb153-12" aria-hidden="true" tabindex="-1"></a>  marg_effects_std <span class="ot">&lt;-</span> <span class="fu">margins</span>(model_interaction, </span>
<span id="cb153-13"><a href="#cb153-13" aria-hidden="true" tabindex="-1"></a>                            <span class="at">variables =</span> <span class="st">"group"</span>,</span>
<span id="cb153-14"><a href="#cb153-14" aria-hidden="true" tabindex="-1"></a>                            <span class="at">at =</span> <span class="fu">list</span>(<span class="at">baseline =</span> <span class="fu">seq</span>(<span class="fu">min</span>(data<span class="sc">$</span>baseline, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb153-15"><a href="#cb153-15" aria-hidden="true" tabindex="-1"></a>                                                   <span class="fu">max</span>(data<span class="sc">$</span>baseline, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb153-16"><a href="#cb153-16" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">length.out =</span> <span class="dv">10</span>)))</span>
<span id="cb153-17"><a href="#cb153-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb153-18"><a href="#cb153-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Marginal effects for IPW interaction model</span></span>
<span id="cb153-19"><a href="#cb153-19" aria-hidden="true" tabindex="-1"></a>  marg_effects_ipw <span class="ot">&lt;-</span> <span class="fu">margins</span>(model_interaction_ipw, </span>
<span id="cb153-20"><a href="#cb153-20" aria-hidden="true" tabindex="-1"></a>                            <span class="at">variables =</span> <span class="st">"group"</span>,</span>
<span id="cb153-21"><a href="#cb153-21" aria-hidden="true" tabindex="-1"></a>                            <span class="at">at =</span> <span class="fu">list</span>(<span class="at">baseline =</span> <span class="fu">seq</span>(<span class="fu">min</span>(data<span class="sc">$</span>baseline, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb153-22"><a href="#cb153-22" aria-hidden="true" tabindex="-1"></a>                                                   <span class="fu">max</span>(data<span class="sc">$</span>baseline, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb153-23"><a href="#cb153-23" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">length.out =</span> <span class="dv">10</span>)))</span>
<span id="cb153-24"><a href="#cb153-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb153-25"><a href="#cb153-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine for comparison</span></span>
<span id="cb153-26"><a href="#cb153-26" aria-hidden="true" tabindex="-1"></a>  marg_combined <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb153-27"><a href="#cb153-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">baseline =</span> <span class="fu">attr</span>(marg_effects_std, <span class="st">"at"</span>)<span class="sc">$</span>baseline,</span>
<span id="cb153-28"><a href="#cb153-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">effect_std =</span> <span class="fu">summary</span>(marg_effects_std)<span class="sc">$</span>AME,</span>
<span id="cb153-29"><a href="#cb153-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">effect_ipw =</span> <span class="fu">summary</span>(marg_effects_ipw)<span class="sc">$</span>AME</span>
<span id="cb153-30"><a href="#cb153-30" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb153-31"><a href="#cb153-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb153-32"><a href="#cb153-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot comparison of marginal effects</span></span>
<span id="cb153-33"><a href="#cb153-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(marg_combined) <span class="sc">+</span></span>
<span id="cb153-34"><a href="#cb153-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> baseline, <span class="at">y =</span> effect_std, <span class="at">color =</span> <span class="st">"Standard Model"</span>)) <span class="sc">+</span></span>
<span id="cb153-35"><a href="#cb153-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> baseline, <span class="at">y =</span> effect_ipw, <span class="at">color =</span> <span class="st">"IPW Model"</span>)) <span class="sc">+</span></span>
<span id="cb153-36"><a href="#cb153-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> baseline, <span class="at">y =</span> effect_std, <span class="at">color =</span> <span class="st">"Standard Model"</span>)) <span class="sc">+</span></span>
<span id="cb153-37"><a href="#cb153-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> baseline, <span class="at">y =</span> effect_ipw, <span class="at">color =</span> <span class="st">"IPW Model"</span>)) <span class="sc">+</span></span>
<span id="cb153-38"><a href="#cb153-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb153-39"><a href="#cb153-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"Marginal Effect of Treatment at Different Baseline Values"</span>) <span class="sc">+</span></span>
<span id="cb153-40"><a href="#cb153-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Treatment Effect"</span>) <span class="sc">+</span></span>
<span id="cb153-41"><a href="#cb153-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Baseline Value"</span>) <span class="sc">+</span></span>
<span id="cb153-42"><a href="#cb153-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>), <span class="at">name =</span> <span class="st">"Model Type"</span>)</span>
<span id="cb153-43"><a href="#cb153-43" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb153-44"><a href="#cb153-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Manual calculation for both models</span></span>
<span id="cb153-45"><a href="#cb153-45" aria-hidden="true" tabindex="-1"></a>  baseline_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(data<span class="sc">$</span>baseline, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb153-46"><a href="#cb153-46" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">max</span>(data<span class="sc">$</span>baseline, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb153-47"><a href="#cb153-47" aria-hidden="true" tabindex="-1"></a>                        <span class="at">length.out =</span> <span class="dv">10</span>)</span>
<span id="cb153-48"><a href="#cb153-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb153-49"><a href="#cb153-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract coefficients for standard model</span></span>
<span id="cb153-50"><a href="#cb153-50" aria-hidden="true" tabindex="-1"></a>  b_group_std <span class="ot">&lt;-</span> <span class="fu">coef</span>(model_interaction)[<span class="st">"groupTreatment"</span>]</span>
<span id="cb153-51"><a href="#cb153-51" aria-hidden="true" tabindex="-1"></a>  b_interaction_std <span class="ot">&lt;-</span> <span class="fu">coef</span>(model_interaction)[<span class="st">"groupTreatment:baseline"</span>]</span>
<span id="cb153-52"><a href="#cb153-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb153-53"><a href="#cb153-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract coefficients for IPW model</span></span>
<span id="cb153-54"><a href="#cb153-54" aria-hidden="true" tabindex="-1"></a>  b_group_ipw <span class="ot">&lt;-</span> <span class="fu">coef</span>(model_interaction_ipw)[<span class="st">"groupTreatment"</span>]</span>
<span id="cb153-55"><a href="#cb153-55" aria-hidden="true" tabindex="-1"></a>  b_interaction_ipw <span class="ot">&lt;-</span> <span class="fu">coef</span>(model_interaction_ipw)[<span class="st">"groupTreatment:baseline"</span>]</span>
<span id="cb153-56"><a href="#cb153-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb153-57"><a href="#cb153-57" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate marginal effects</span></span>
<span id="cb153-58"><a href="#cb153-58" aria-hidden="true" tabindex="-1"></a>  marginal_effects <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb153-59"><a href="#cb153-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">baseline =</span> baseline_values,</span>
<span id="cb153-60"><a href="#cb153-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">effect_std =</span> b_group_std <span class="sc">+</span> b_interaction_std <span class="sc">*</span> baseline_values,</span>
<span id="cb153-61"><a href="#cb153-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">effect_ipw =</span> b_group_ipw <span class="sc">+</span> b_interaction_ipw <span class="sc">*</span> baseline_values</span>
<span id="cb153-62"><a href="#cb153-62" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb153-63"><a href="#cb153-63" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb153-64"><a href="#cb153-64" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot comparison</span></span>
<span id="cb153-65"><a href="#cb153-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(marginal_effects) <span class="sc">+</span></span>
<span id="cb153-66"><a href="#cb153-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> baseline, <span class="at">y =</span> effect_std, <span class="at">color =</span> <span class="st">"Standard Model"</span>)) <span class="sc">+</span></span>
<span id="cb153-67"><a href="#cb153-67" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> baseline, <span class="at">y =</span> effect_ipw, <span class="at">color =</span> <span class="st">"IPW Model"</span>)) <span class="sc">+</span></span>
<span id="cb153-68"><a href="#cb153-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> baseline, <span class="at">y =</span> effect_std, <span class="at">color =</span> <span class="st">"Standard Model"</span>)) <span class="sc">+</span></span>
<span id="cb153-69"><a href="#cb153-69" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> baseline, <span class="at">y =</span> effect_ipw, <span class="at">color =</span> <span class="st">"IPW Model"</span>)) <span class="sc">+</span></span>
<span id="cb153-70"><a href="#cb153-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb153-71"><a href="#cb153-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"Marginal Effect of Treatment at Different Baseline Values"</span>) <span class="sc">+</span></span>
<span id="cb153-72"><a href="#cb153-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Treatment Effect"</span>) <span class="sc">+</span></span>
<span id="cb153-73"><a href="#cb153-73" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Baseline Value"</span>) <span class="sc">+</span></span>
<span id="cb153-74"><a href="#cb153-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>), <span class="at">name =</span> <span class="st">"Model Type"</span>)</span>
<span id="cb153-75"><a href="#cb153-75" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in check_values(data, at): A 'at' value for 'baseline' is outside
observed data range (23.9722246127899,76.9244254678604)!
Warning in check_values(data, at): A 'at' value for 'baseline' is outside
observed data range (23.9722246127899,76.9244254678604)!</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Baseline-Change_files/figure-html/unnamed-chunk-37-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="analyze-non-censored-version-including-severity.-when-no-patients-are-censored-severity-should-not-be-needed." class="level2">
<h2 class="anchored" data-anchor-id="analyze-non-censored-version-including-severity.-when-no-patients-are-censored-severity-should-not-be-needed.">Analyze non-censored version, including severity. When no patients are censored severity should not be needed.</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(<span class="at">formula =</span> time2_all <span class="sc">~</span> group <span class="sc">+</span> baseline <span class="sc">+</span> severity, <span class="at">family =</span> <span class="fu">gaussian</span>(), </span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:  glm(formula = time2_all ~ group + baseline + severity, family = gaussian(), 
    data = data)

Coefficients:
   (Intercept)  groupTreatment        baseline        severity  
        -5.336          17.648           1.112           3.406  

Degrees of Freedom: 149 Total (i.e. Null);  146 Residual
Null Deviance:      32770 
Residual Deviance: 4478     AIC: 945.1</code></pre>
</div>
</div>
</section>
</section>
<section id="removing-severity-from-the-model" class="level1">
<h1>Removing severity from the model</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(<span class="at">formula =</span> time2_all <span class="sc">~</span> group <span class="sc">+</span> baseline, <span class="at">family =</span> <span class="fu">gaussian</span>(), </span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:  glm(formula = time2_all ~ group + baseline, family = gaussian(), 
    data = data)

Coefficients:
   (Intercept)  groupTreatment        baseline  
         2.777          17.653           0.954  

Degrees of Freedom: 149 Total (i.e. Null);  147 Residual
Null Deviance:      32770 
Residual Deviance: 5536     AIC: 974.9</code></pre>
</div>
</div>
</section>
<section id="adding-baseline-as-an-interaction-with-treatment-group" class="level1">
<h1>Adding baseline as an interaction with treatment group</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(<span class="at">formula =</span> time2_all <span class="sc">~</span> group<span class="sc">*</span>baseline, <span class="at">family =</span> <span class="fu">gaussian</span>(), </span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:  glm(formula = time2_all ~ group * baseline, family = gaussian(), 
    data = data)

Coefficients:
            (Intercept)           groupTreatment                 baseline  
                1.19398                 20.56053                  0.98564  
groupTreatment:baseline  
               -0.05894  

Degrees of Freedom: 149 Total (i.e. Null);  146 Residual
Null Deviance:      32770 
Residual Deviance: 5520     AIC: 976.5</code></pre>
</div>
</div>
<section id="analysis-using-stabilized-inverse-probability-weights-to-adjust-for-censoring." class="level2">
<h2 class="anchored" data-anchor-id="analysis-using-stabilized-inverse-probability-weights-to-adjust-for-censoring.">Analysis using stabilized inverse probability weights to adjust for censoring.</h2>
<p>Treatment is randomized in this data, so no need to adjust for treatment assignment</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Estimate stabilized inverse probability weights for censoring </span><span class="al">###</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a pooled logistic model that predicts the probability of remaining uncensored </span></span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a><span class="co"># (not being lost to follow-up)</span></span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a>psc.denom <span class="ot">&lt;-</span> <span class="fu">glm</span>(censored <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> group <span class="sc">+</span> baseline <span class="sc">+</span> severity , </span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span><span class="st">"logit"</span>),</span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">data=</span>data)</span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(psc.denom)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = censored == 0 ~ group + baseline + severity, family = binomial(link = "logit"), 
    data = data)

Coefficients:
               Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)    -0.19381    1.55197  -0.125  0.90062   
groupTreatment  1.81860    0.64088   2.838  0.00454 **
baseline        0.03786    0.03140   1.206  0.22785   
severity       -0.79392    0.33521  -2.368  0.01787 * 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 114.000  on 149  degrees of freedom
Residual deviance:  91.343  on 146  degrees of freedom
AIC: 99.343

Number of Fisher Scoring iterations: 6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain predicted probabilities for the denominator</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>psc.denom <span class="ot">&lt;-</span> <span class="fu">predict</span>(psc.denom, data, <span class="at">type=</span><span class="st">"response"</span>) </span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model for the numerator of the stabilized weights</span></span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a>psc.num <span class="ot">&lt;-</span> <span class="fu">glm</span>(censored<span class="sc">==</span><span class="dv">0</span> <span class="sc">~</span> group, </span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span><span class="st">"logit"</span>), <span class="at">data=</span>data)</span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(psc.num)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = censored == 0 ~ group, family = binomial(link = "logit"), 
    data = data)

Coefficients:
               Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)      1.3863     0.2887   4.802 1.57e-06 ***
groupTreatment   1.4901     0.5894   2.528   0.0115 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 114.00  on 149  degrees of freedom
Residual deviance: 106.29  on 148  degrees of freedom
AIC: 110.29

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate stabilized weights</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>psc.num <span class="ot">&lt;-</span> <span class="fu">predict</span>(psc.num, data, <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span></span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">sw_c =</span> <span class="fu">cumprod</span>(psc.num)<span class="sc">/</span><span class="fu">cumprod</span>(psc.denom)</span>
<span id="cb165-8"><a href="#cb165-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb165-9"><a href="#cb165-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb165-10"><a href="#cb165-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sw_c =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(censored), <span class="dv">1</span>, sw_c)) </span>
<span id="cb165-11"><a href="#cb165-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-12"><a href="#cb165-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-13"><a href="#cb165-13" aria-hidden="true" tabindex="-1"></a><span class="do">###  Min, 25th percentile, median, mean, SD, 75th percentile, and max: stabilized weights </span><span class="al">###</span></span>
<span id="cb165-14"><a href="#cb165-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data<span class="sc">$</span>sw_c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.8190  0.9303  0.9712  1.0433  1.0347  4.1950 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(data<span class="sc">$</span>sw_c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3372924</code></pre>
</div>
</div>
<p>Note that the <code>echo = FALSE</code> parameter was added to the code chunk to prevent printing of the R code that generated the plot.</p>

</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-tennant2021" class="csl-entry" role="listitem">
Tennant, Peter W G, Kellyn F Arnold, George T H Ellison, and Mark S Gilthorpe. 2021. <span>“Analyses of <span>‘</span>Change Scores<span>’</span> Do Not Estimate Causal Effects in Observational Data.”</span> <em>International Journal of Epidemiology</em> 51 (5): 1604–15. <a href="https://doi.org/10.1093/ije/dyab050">https://doi.org/10.1093/ije/dyab050</a>.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>