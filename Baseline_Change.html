<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Todd R. Johnson">

<title>Causal Effect Analysis of Baseline Change</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="Baseline_Change_files/libs/clipboard/clipboard.min.js"></script>
<script src="Baseline_Change_files/libs/quarto-html/quarto.js"></script>
<script src="Baseline_Change_files/libs/quarto-html/popper.min.js"></script>
<script src="Baseline_Change_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Baseline_Change_files/libs/quarto-html/anchor.min.js"></script>
<link href="Baseline_Change_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Baseline_Change_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Baseline_Change_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Baseline_Change_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Baseline_Change_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="Baseline_Change_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="Baseline_Change_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="Baseline_Change_files/libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="Baseline_Change_files/libs/datatables-binding-0.33/datatables.js"></script>
<script src="Baseline_Change_files/libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="Baseline_Change_files/libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="Baseline_Change_files/libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="Baseline_Change_files/libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="Baseline_Change_files/libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="Baseline_Change_files/libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Causal Effect Analysis of Baseline Change</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Todd R. Johnson </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"jtextor/dagitty/r"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dagitty)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdag)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  usethis::use_github_pages("main") # Tell github to publish on github pages</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<style type="text/css">
table caption {
  caption-side: top;
}
</style>
</div>
<p>The goal of this notebook is to demonstrate how to estimate treatment effects of a dichotomous (binary) treatment on change from a continuous baseline measure, such as in <span class="citation" data-cites="tennant2021">(<a href="#ref-tennant2021" role="doc-biblioref">Tennant et al. 2021</a>)</span>. For example, suppose we want to estimate the effect of a new drug vs.&nbsp;placebo for reducing blood pressure after 6 months of use. Here, the blood pressure at treatment assignment is the baseline value and blood pressure measured 6 months after treatment assignment is the follow-up measure. There are two common approaches to analyzing the outcome: (1) Compare the difference in the follow-up measures between the experimental and control group; or (2) Compare the difference in change scores between the two groups, where a change score for an individual is the difference between the follow-up blood pressure and the baseline blood pressure.</p>
<p>We will use five increasingly complex data generating models to explore this problem:</p>
<ol type="1">
<li>A ground truth model where the potential outcomes (the outcome measure under both treatment and control) are known for all participants.</li>
<li>A Randomized Controlled Trial (RCT) with no loss to follow-up.</li>
<li>An RCT with differential loss to follow-up.</li>
<li>An observational study with treatment assignment confounding</li>
<li>An observational study with treatment assignment counfounding and loss to follow-up.</li>
</ol>
<p>We will also consider four causal estimands based on the two approaches discussed above:</p>
<ol type="1">
<li><p>The average treatment effect (ATE) on the outcome at follow-up, expressed as the difference between the outcome under treatment vs.&nbsp;control:<br>
<span id="eq-att-outcome"><span class="math display">\[\mathrm{E}(Y_1^x) - \mathrm{E}(Y_1^{x'}) \tag{1}\]</span></span><br>
Here, we use the potential outcomes notation, where <span class="math inline">\(Y_1\)</span> is the follow-up outcome, <span class="math inline">\(x\)</span> is the treatment, and <span class="math inline">\(x'\)</span> is the control. <span class="math inline">\(Y_1^x\)</span> represents the value that a participant would have if treated. Hence this effect estimate is the difference between the expected outcome if all patients in the study were treated and the expected outcome if all patients were not treated.</p></li>
<li><p>The average treatment effect on the change score:<br>
<span id="eq-att-changescore"><span class="math display">\[
\mathrm{E}(Y_1^x - Y_0^x) - \mathrm{E}(Y_1^{x'} - Y_0^{x'})
\tag{2}\]</span></span><br>
This is the difference between the change score <span class="math inline">\(Y_1 - Y_0\)</span> under treatment vs.&nbsp;control, where <span class="math inline">\(Y_0\)</span> is the baseline score.</p></li>
<li><p>The conditional treatment effect on the follow-up outcome, conditioned on the observed baseline value <span class="math inline">\(Y_0\)</span>:<br>
<span id="eq-CTE-fu"><span class="math display">\[
E[Y_1^x - Y_1^{x'} | Y_0 = y_0]
\tag{3}\]</span></span><br>
This estimand represents the effect of treatment on the part of the follow-up outcome that hasn’t already been determined by the baseline value.</p></li>
<li><p>The conditional treatment effect on the change score, conditioned on the observed baseline value <span class="math inline">\(Y_0\)</span>:<br>
<span id="eq-CTE-cs"><span class="math display">\[
E[(Y_1^x - Y_0^x) - (Y_1^{x'} - Y_0^{x'}) | Y_0 = y_0]
\tag{4}\]</span></span><br>
This estimand represents the effect of treatment on the part of the change score that hasn’t already been determined by the baseline value. Note that because the change score includes the baseline value <span class="math inline">\(Y_0\)</span>, this estimand is equivalent to <a href="#eq-CTE-fu" class="quarto-xref">Equation&nbsp;3</a>.</p></li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Estimands vs Estimators
</div>
</div>
<div class="callout-body-container callout-body">
<p>A <em>causal estimand</em> expresses the value that we wish to estimate. A <em>statistical estimator</em> is how we estimate that value. For any given estimand there are often multiple possible estimators, each with possible strengths and weaknesses. For example, with an RCT we can estimate ATE by subtracting the differences in the means of the outcome variable across the groups or by using linear regression or a number of other approaches.</p>
</div>
</div>
<p>There is considerable controversy in the literature over whether and when to use the difference in outcome at follow-up <a href="#eq-att-outcome" class="quarto-xref">Equation&nbsp;1</a> vs the difference in the change score <a href="#eq-att-changescore" class="quarto-xref">Equation&nbsp;2</a> as well as whether to adjust for baseline values. We will explore some of these issues below.</p>
<section id="model-1-additive-treatment-effect-potential-outcomes-known" class="level2">
<h2 class="anchored" data-anchor-id="model-1-additive-treatment-effect-potential-outcomes-known">Model 1: Additive Treatment Effect, Potential Outcomes Known</h2>
<p>The Causal DAG for the first and simplest model looks like this:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the DAG using dagify</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>dagMod1 <span class="ot">&lt;-</span> <span class="fu">dagify</span>(</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  time1 <span class="sc">~</span> baseline <span class="sc">+</span> group <span class="sc">+</span> L,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  change1 <span class="sc">~</span> baseline <span class="sc">+</span> time1,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="st">"group"</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="st">"time1"</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">coords =</span> <span class="fu">data.frame</span>(</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="fu">c</span>(<span class="st">"baseline"</span>, <span class="st">"L"</span>, <span class="st">"group"</span>, <span class="st">"time1"</span>, <span class="st">"change1"</span>),</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="fl">1.5</span>)<span class="sc">*</span>.<span class="dv">5</span>,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>)<span class="sc">*</span>.<span class="dv">5</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the dagitty graph to a ggdag group for prettier printing</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>tidy_dagMod1 <span class="ot">&lt;-</span> <span class="fu">tidy_dagitty</span>(dagMod1) </span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot with custom node shapes</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the status (exposure, outcome) information and set variables without a status to "observed"</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>status_dataMod1 <span class="ot">&lt;-</span> <span class="fu">ggdag_status</span>(tidy_dagMod1)<span class="sc">$</span>data <span class="sc">|&gt;</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">status =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(status), <span class="st">"observed"</span>, <span class="fu">as.character</span>(status)))</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot with custom node shapes while preserving status coloring</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(status_dataMod1, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_edges</span>(<span class="at">arrow_directed =</span> grid<span class="sc">::</span><span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"cm"</span>), <span class="at">type =</span> <span class="st">"closed"</span>)) <span class="sc">+</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> status), <span class="at">size =</span> <span class="dv">24</span>) <span class="sc">+</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_text</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="at">circle =</span> <span class="dv">16</span>, <span class="at">square =</span> <span class="dv">15</span>), <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">name =</span> <span class="st">"Status"</span>, <span class="at">na.value =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_dag</span>() <span class="sc">+</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Baseline_Change_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<p>The DAG uses common sense names instead of the typical variables used in potential outcomes:</p>
<p><span class="math inline">\(Y_0\)</span>: <code>baseline</code></p>
<p><span class="math inline">\(Y_1\)</span>: <code>time1</code> or <code>change1</code> depending on which outcome we are interested in</p>
<p><span class="math inline">\(X\)</span>: <code>group</code> where 0 is control and 1 is treatment</p>
<p>Now let’s simulate potential outcomes for the causal DAG shown above. In this simulation, the causal effect of treatment on <code>time1</code> is 10, meaning that treated patients will see their baseline score increase by 10 plus a random amount of normally distributed noise with mean 0 and standard deviation of 3 (<span class="math inline">\(\mu = 0\)</span>, <span class="math inline">\(\sigma = 3\)</span>), whereas control will see only the random change. The simulation calculates the potential outcomes <code>time1_x0</code> and <code>time1_x1</code> for all participants, where <code>x1</code> is the outcome under treatment, and <code>x0</code> under control. Likewise, the simulation also calculates potential outcomes of the change score: <code>change1_x0</code>, and <code>change1_x1</code>.</p>
<p>Finally, we use the potential outcomes for each participant to calculate the individual treatment effect for both <code>time1</code> and <code>change1</code>. An individual treatment effect for a participant is the difference between that person’s outcome under treatment and outcome under control.</p>
<section id="data-generating-model" class="level3">
<h3 class="anchored" data-anchor-id="data-generating-model">Data Generating Model</h3>
<p>Here is the data generating model code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">124</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 150 participants</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">150</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate baseline scores</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>baseline <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Set additive effect</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>additive_effect <span class="ot">&lt;-</span> <span class="dv">10</span>  <span class="co"># improvement of +10 to time1 for treatment group</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a prognostic factor (L) - binary (0: favorable, 1: unfavorable)</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>L <span class="ot">&lt;-</span> prognostic_factor <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, <span class="fl">0.3</span>)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>baseline_outcome_effect <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co"># Effect of prognostic factor on outcome: time1</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate potential outcomes for time1 for all participants</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="co"># time1 under control adds a small amount of random noise, so on average there is no effect of control on the baseline value</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>time1_x0 <span class="ot">&lt;-</span> baseline <span class="sc">+</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>  baseline_outcome_effect<span class="sc">*</span>L <span class="sc">+</span> </span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="co"># time1 under treatment is on average 10 units higher than baseline</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>time1_x1 <span class="ot">&lt;-</span> baseline <span class="sc">+</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>  additive_effect <span class="sc">+</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  baseline_outcome_effect<span class="sc">*</span>L <span class="sc">+</span> </span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate potential outcomes for the change score</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>change1_x0 <span class="ot">&lt;-</span> time1_x0 <span class="sc">-</span> baseline</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>change1_x1 <span class="ot">&lt;-</span> time1_x1 <span class="sc">-</span> baseline</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate individual treatment effects (ITE) for time1 and change1 for each participant</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>ite_time1 <span class="ot">&lt;-</span> time1_x1 <span class="sc">-</span> time1_x0</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>ite_change1 <span class="ot">&lt;-</span> change1_x1 <span class="sc">-</span> change1_x0</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>dataMod1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span>n,</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">baseline =</span> baseline,</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">L =</span> L,</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">time1_x0 =</span> time1_x0,</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">time1_x1 =</span> time1_x1,</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">change1_x0 =</span> change1_x0,</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">change1_x1 =</span> change1_x1,</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">ite_time1 =</span> ite_time1,</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">ite_change1 =</span> ite_change1</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(dataMod1, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">pageLength =</span> <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-197d77f7bd33125c1074" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-197d77f7bd33125c1074">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150"],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150],[36.1492938140562,50.38323181021901,42.36969837638026,52.12306135525839,64.25537966867792,57.44479822333976,57.0022940298623,47.70645386548274,51.97093861895352,62.07153773872257,53.18336726424769,35.76201146372445,45.94909141950813,59.95386565684022,59.58817787640257,59.1808789631995,48.4903039811839,37.76931211133796,41.31175711362206,39.57514635095707,38.9636221693313,54.44185061636591,47.95049387752277,66.75632433148326,48.6867775006957,48.00117022068815,50.54912415432123,43.17834511454831,42.72295851857338,41.38095714059664,49.62476885005964,33.68576759763806,51.7716659588745,49.87499200921824,46.05682873574104,53.51562931221001,58.78767562719921,52.04654080230588,41.12619289608275,45.22783941705452,47.32259046645307,65.85859163151744,50.46900594697962,53.56496777244958,48.78619994679629,49.63908157900605,40.18852513273207,45.65740172347076,49.32515644708256,59.81894565963953,45.37947608705008,47.74900717356022,41.53552199738108,50.7304631935885,47.24963580453851,46.13573642741976,49.5379685855967,41.74106278163622,41.45965762254298,51.18736809402656,52.83596905517313,69.30086466248267,38.5947238195217,36.77881757133585,62.28831605394996,44.51543967644129,48.73992507865754,56.87718721631207,57.05200375971499,58.01478429090865,45.37116820836361,41.15445015899184,33.6907242657997,55.62230587919655,46.74108165373376,52.4137562009856,60.85869099457267,69.07061614660081,58.12927449301863,54.94888787113184,49.0485223648262,61.38780499501301,55.02314628861913,44.84585945975069,25.3160953291529,41.27447256274069,59.64088079895252,59.10796248707817,69.25808837446685,46.97093052078708,39.45292949887301,54.18116085183897,57.01272821932616,52.46758282351839,54.64295161386731,46.04531812298992,57.13070305154749,61.85012556327626,30.88850711896562,61.1493056406232,45.3069979374733,38.51997246608669,61.03997956657752,47.10750083048119,47.22671378990475,41.24217361194295,50.03279151814386,52.65591625375043,48.75975868342836,48.71074094413365,52.99112314061662,50.18299211822657,38.49938669161833,45.70603652970917,58.50002976678222,47.85170508156628,43.82585983946465,51.09427384034174,42.93488936081676,65.4297581655436,53.50801720173732,61.72620574095716,49.66626469488467,53.61443995656251,60.45575638501893,51.03212392415602,53.31795557645035,34.3144118526109,54.4026994419263,68.81871322324494,63.49106265191625,33.64917228422103,42.84467267827526,40.83505677118566,26.38973055324857,65.2845000149248,43.70212776144518,39.31907978582351,62.44859824206127,54.59876146065523,51.6770582831924,47.24996977390859,54.92322618045394,63.3975457108875,45.23255775698019,35.03204463451998,37.98576029350947,45.92538971792439,40.5225190465432,58.51666398410158],[0,1,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,1,0,1,0,0,0,0,1,0,0,1,1,0,0,0,1,0,0,0,1,0,1,1,0,1,0,0,0,0,1,1,0,1,1,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,1,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,1,0,0,1,1,1,1,0,0,1,0,0,0,0,0,0,1,1,0,0,1,0,0,1,0,0,0,0,0,1,0,1,0,1,0,0,0,0,0,0,0,1,0,0,0,0,1,0,1,0,0,0,0,1,0,0],[34.87067748596235,55.8281416387037,49.95312670406218,56.69286109140374,67.35458259720528,56.37120354352962,59.27545947235477,54.60268195561349,51.74422833269585,75.655283126767,48.95699717359015,35.99132474202099,40.62946412471763,59.32228139184009,58.67681495648782,57.34541337516896,48.0690411290302,38.13338443439935,43.51287564202813,46.2534424226104,40.69399814369142,54.93537908294647,55.33516967190703,69.86911340107429,44.32874741313569,54.48365826785727,48.0566647152062,50.60230704806548,43.35118892616044,45.5482525486624,45.22001043411207,35.1777368419676,52.21097874764608,51.79976718217534,51.26375720337204,53.57122162228654,57.97640733819982,56.34947382997218,43.28249762617214,46.04905845347878,47.11349936073555,64.52460294589417,55.58531457881465,52.62127561655934,54.40475541379831,45.47107504587864,47.28015216769703,42.17161295597239,51.54193281590328,65.7004689633157,45.99589460997009,53.93827293558662,41.01068102042228,48.13233520724143,44.99559055673623,41.15631767671267,47.14863360666967,49.73314086598293,45.0633841226962,49.92044532389235,60.84427663823608,68.69777410242656,39.80569359720521,37.64391284091071,62.29320733969929,42.49849646081402,51.38248096058659,60.0422455455877,58.9653933859129,68.91364954596486,41.55627920794279,41.43360387792814,34.61190874416981,55.6509037182506,44.65497395122955,52.26679479426374,68.53025703512603,82.50191043969525,59.11204424076854,51.81656585683285,46.67864516038578,61.98228709207982,54.55871253924379,47.09797765789119,22.38377481792852,45.94475029516773,59.45865614708202,58.77281301337008,65.8120886612855,56.48955873146564,42.53116781157733,51.15458521359147,58.53676555651955,51.92423748875289,56.02250408375,47.88458350552015,62.0716464907301,68.09849677004861,36.24885167919318,65.10869131999331,45.33368954062072,41.75139992838793,58.81333736973677,52.62201627268923,49.10235505017007,37.82486015547357,48.47840495806992,58.77242645544862,46.16686804161862,46.27736927465013,60.18065987110545,51.03556969498944,32.35602668758902,46.43036773971703,61.55280557746782,42.85540441439052,44.06771268087589,52.89701673786944,44.37015545418566,69.53668254826354,47.89073049714036,63.24054919675296,51.99420379420361,61.13985134302035,62.06030562457484,54.0028308383195,48.96956227075007,41.10108538482493,56.73885001776527,68.30020950399749,65.46231695639665,34.95495516936496,40.93874488768206,46.78767858351716,28.37227000598114,70.10700803513539,44.13668130405101,39.50100041611087,58.79730904229035,57.39268261149824,51.12321046338355,48.30041974771794,60.18005349241459,64.50046917251811,47.87304365653502,32.72182018906206,28.39981973041586,48.11140743624401,43.23062391339541,60.2725683639522],[46.33937207262399,70.69306810651048,51.0636643521776,68.71228127265449,74.56049925264222,62.84715141467228,66.67967909943025,59.99345201972395,61.26955796587975,79.20356773596214,63.15028591211251,46.28852670454548,52.84968227478206,76.11126532297878,65.75694956065658,68.2785470963821,60.94136110669855,46.34663130361011,51.27278893104343,49.04755993524028,48.29889370815746,62.67467898820649,63.05930849703402,74.44469522695056,52.75008997368671,62.65517829936678,60.93683318046469,58.97982193640527,48.54407849511713,54.60977661554863,65.99379778333785,43.90553291348529,60.61021040081943,55.8863524574594,62.0915555868075,60.48550910801141,68.75515427977095,64.45121905228388,55.99595704667982,54.30090505850349,61.73164039845851,77.2563758672901,66.75764622527704,67.77761744533325,57.1467976644178,55.34081558733595,56.30402926736734,58.27015761576793,67.43432881603322,74.49434702892171,49.47097751147948,58.56449930733962,48.62689463304714,59.9994515484661,60.61131069414215,55.41397826996359,62.95123672590255,50.96166519245229,50.01043098853597,70.34583473092937,66.72103073864588,77.70487178380453,53.38665792742064,41.83442845882347,73.90194608417906,55.55845534776049,54.85388037175682,67.75404484026789,72.34249035369851,72.3284545768314,53.7304562935078,49.84443285144428,43.40024141812547,64.03330188898836,55.18373169204289,66.64657595160911,75.31616331392505,82.20776792735796,63.69371584128629,62.66909464375735,58.60044293836651,72.49850891091003,62.54691397335684,55.47245986454331,30.06620929650495,53.29121146257172,72.27238954385564,68.07724145925553,85.81579287779195,65.17161727488849,48.52084342254355,62.76687954101198,66.40241904945643,63.3845653974247,71.92918429042489,62.35757628055472,63.55922340880252,80.32508714199334,44.8251996689664,80.58479185245046,57.33550932109895,46.19343040808479,75.04294000325169,61.03803801216949,52.82876019591376,51.17382997477117,61.84538930642899,60.12881452797978,58.1652923510141,57.49995452129577,71.40707580542535,64.67147172212812,45.04336699682654,56.6372547302712,69.26387025264364,58.8146240329402,51.60778043818837,66.99547600002391,50.17198689938162,74.50156635373585,60.48707270807397,68.04956838754767,57.13076391707875,69.36470156845235,69.97043481666464,64.46904175029123,63.15602825597627,54.89524638210268,64.89994180022536,81.2268037976671,71.40364721034859,41.0258151863067,52.33608835245281,52.30508075519099,32.0910883728428,80.12116572178232,52.05553722379989,50.28297835827317,70.43644857264758,64.08027955378246,66.9463515554113,55.55414328477285,72.02337397443885,73.13161171802173,53.0050435296269,48.82663249241416,53.33494769068677,57.33440286471608,52.56767692501152,73.0816852751561],[-1.278616328093854,5.44490982848469,7.583428327681922,4.569799736145356,3.099202928527362,-1.073594679810142,2.27316544249247,6.896228090130755,-0.2267102862576635,13.58374538804443,-4.226370090657539,0.2293132782965372,-5.3196272947905,-0.6315842650001287,-0.9113629199147439,-1.835465588030544,-0.4212628521537027,0.3640723230613858,2.20111852840607,6.678296071653328,1.730375974360122,0.4935284665805568,7.384675794384265,3.112789069591031,-4.358030087560017,6.48248804716912,-2.492459439115038,7.423961933517162,0.6282304075870613,4.167295408065769,-4.404758415947569,1.491969244329539,0.4393127887715806,1.924775172957105,5.206928467631002,0.05559231007653409,-0.8112682889993863,4.302933027666306,2.156304730089388,0.8212190364242602,-0.2090911057175262,-1.333988685623268,5.116308631835032,-0.9436921558902398,5.618555467002025,-4.168006533127411,7.091627034964965,-3.48578876749837,2.216776368820717,5.881523303676168,0.6164185229200143,6.189265762026402,-0.5248409769588065,-2.598127986347066,-2.254045247802274,-4.979418750707097,-2.389334978927032,7.992078084346716,3.603726500153222,-1.266922770134208,8.008307583062951,-0.6030905600561027,1.210969777683502,0.8650952695748586,0.004891285749330621,-2.016943215627265,2.642555881929049,3.165058329275638,1.913389626197919,10.89886525505621,-3.814889000420827,0.2791537189362927,0.9211844783701082,0.02859783905405067,-2.086107702504208,-0.1469614067218643,7.671566040553358,13.43129429309444,0.9827697477499129,-3.132322014298992,-2.369877204440421,0.5944820970668019,-0.4644337493753454,2.252118198140501,-2.932320511224383,4.670277732427039,-0.1822246518705057,-0.3351494737080927,-3.445999713181351,9.518628210678564,3.078238312704322,-3.0265756382475,1.524037337193391,-0.5433453347654975,1.37955246988269,1.839265382530236,4.940943439182604,6.248371206772354,5.360344560227563,3.959385679370115,0.02669160314741958,3.231427462301234,-2.22664219684075,5.514515442208044,1.875641260265319,-3.417313456469387,-1.554386560073944,6.116510201698198,-2.592890641809738,-2.43337166948352,7.189536730488832,0.8525775767628758,-6.143360004029319,0.7243312100078612,3.052775810685596,-4.99630066717576,0.2418528414112373,1.802742897527693,1.435266093368895,4.106924382719939,-5.617286704596964,1.514343455795803,2.327939099318939,7.525411386457833,1.604549239555915,2.970706914163479,-4.348393305700284,6.786673532214031,2.336150575838971,-0.5185037192474482,1.971254304480397,1.305782885143934,-1.905927790593203,5.9526218123315,1.982539452732567,4.822508020210591,0.4345535426058262,0.1819206302873582,-3.651289199770922,2.793921150843019,-0.5538478198088512,1.05044997380935,5.256827311960656,1.10292346163061,2.640485899554825,-2.310224445457919,-9.585940563093615,2.186017718319619,2.70810486685221,1.755904379850627],[10.19007825856779,20.30983629629147,8.693965975797347,16.58921991739611,10.3051195839643,5.402353191332523,9.677385069567947,12.28699815424122,9.29861934692623,17.13202999723957,9.966918647864816,10.52651524082103,6.900590855273933,16.15739966613856,6.168771684254011,9.097668133182594,12.45105712551465,8.577319192272149,9.961031817421365,9.47241358428321,9.335271538826163,8.232828371840583,15.10881461951125,7.688370895467301,4.063312472991001,14.65400807867864,10.38770902614345,15.80147682185696,5.821119976543756,13.228819474952,16.36902893327822,10.21976531584723,8.838544441944933,6.011360448241156,16.03472685106646,6.969879795801404,9.967478652571742,12.404678249978,14.86976415059707,9.07306564144897,14.40904993200544,11.39778423577266,16.28864027829742,14.21264967288366,8.360597717621509,5.701734008329908,16.11550413463527,12.61275589229717,18.10917236895065,14.67540136928218,4.091501424429403,10.8154921337794,7.091372635666062,9.2689883548776,13.36167488960364,9.278241842543821,13.41326814030585,9.220602410816078,8.550773365992988,19.15846663690281,13.88506168347275,8.404007121321868,14.79193410789894,5.055610887487624,11.6136300302291,11.0430156713192,6.113955293099274,10.87685762395583,15.29048659398352,14.31367028592275,8.359288085144186,8.689982692452439,9.709517152325766,8.410996009791809,8.442650038309132,14.23281975062351,14.45747231935238,13.13715178075715,5.564441348267664,7.720206772625502,9.551920573540315,11.11070391589702,7.523767684737706,10.62660040479262,4.750113967352053,12.01673889983103,12.63150874490312,8.969278972177364,16.5577045033251,18.20068675410141,9.067913923670538,8.585718689173014,9.38969083013027,10.91698257390631,17.28623267655757,16.31225815756481,6.428520357255032,18.47496157871708,13.93669255000078,19.43548621182727,12.02851138362565,7.673457941998102,14.00296043667417,13.9305371816883,5.602046406009009,9.931656362828214,11.81259778828513,7.472898274229358,9.405533667585743,8.789213577162116,18.41595266480873,14.48847960390155,6.543980305208208,10.93121820056203,10.76384048586142,10.96291895137392,7.781920598723723,15.90120215968217,7.237097538564861,9.07180818819225,6.97905550633665,6.32336264659051,7.464499222194078,15.75026161188983,9.514678431645706,13.43691782613521,9.838072679525922,20.58083452949178,10.49724235829906,12.40809057442216,7.912584558432343,7.376642902085671,9.491415674177553,11.47002398400534,5.701357819594236,14.83666570685752,8.353409462354705,10.96389857244966,7.987850330586305,9.481518093127235,15.2692932722189,8.30417351086426,17.10014779398492,9.734066007134231,7.772485772646711,13.79458785789419,15.3491873971773,11.40901314679169,12.04515787846832,14.56502129105453],[11.46869458666164,14.86492646780678,1.110537648115425,12.01942018125075,7.205916655436937,6.475947871142665,7.404219627075477,5.390770064110463,9.525329633183894,3.548284609195136,14.19328873852236,10.2972019625245,12.22021815006443,16.78898393113869,7.080134604168755,10.93313372121314,12.87231997766835,8.213246869210764,7.759913289015294,2.794117512629882,7.604895564466041,7.739299905260026,7.724138825126985,4.57558182587627,8.421342560551018,8.171520031509516,12.88016846525849,8.377514888339796,5.192889568956694,9.061524066886228,20.77378734922578,8.727796071517687,8.399231653173352,4.086585275284051,10.82779838343546,6.91428748572487,10.77874694157113,8.101745222311692,12.71345942050768,8.25184660502471,14.61814103772296,12.73177292139593,11.17233164646239,15.1563418287739,2.742042250619484,9.869740541457318,9.023877099670308,16.09854465979554,15.89239600012993,8.793878065606009,3.475082901509388,4.626226371752999,7.616213612624868,11.86711634122467,15.61572013740592,14.25766059325092,15.80260311923288,1.228524326469362,4.947046865839766,20.42538940703702,5.876754100409798,9.007097681377971,13.58096433021544,4.190515617912766,11.60873874447977,13.05995888694647,3.471399411170225,7.711799294680191,13.3770969677856,3.414805030866546,12.17417708556501,8.410828973516146,8.788332673955658,8.382398170737758,10.52875774081334,14.37978115734537,6.785906278799018,-0.2941425123372881,4.581671600517751,10.85252878692449,11.92179777798074,10.51622181883022,7.988201434113051,8.374482206652118,7.682434478576436,7.346461167403987,12.81373339677362,9.304428445885456,20.00370421650645,8.682058543422848,5.989675610966216,11.61229432742051,7.865653492936879,11.46032790867181,15.90668020667488,14.47299277503457,1.487576918072428,12.22659037194472,8.576347989773218,15.47610053245715,12.00181978047823,4.442030479696868,16.22960263351492,8.416021739480257,3.726405145743691,13.3489698192976,13.36698434835908,1.356388072531161,11.99842430939548,11.22258524664564,11.2264159343199,13.63590202713868,12.68734030923753,10.20688699055417,7.711064675175827,15.95921961854968,7.540067757312485,14.09845926215448,5.801831445195965,4.964883805472311,12.59634221093361,4.809019190794707,5.136560122875139,8.224850225432,7.910129192089791,10.46621091197173,14.18646598522621,13.79416099727775,8.16109178246009,12.92659429366961,5.941330253951946,6.070860016941737,11.39734346477076,5.517402171673837,3.718818366861669,10.01415768664693,7.918855919748879,10.7819779421623,11.63913953035723,6.687596942284216,15.82314109202775,7.25372353705491,11.84332048202426,8.631142545503621,5.131999873091885,16.10481230335211,24.93512796027091,9.222995428472075,9.337053011616113,12.8091169112039],[11.46869458666164,14.86492646780678,1.110537648115425,12.01942018125075,7.205916655436937,6.475947871142665,7.404219627075477,5.390770064110463,9.525329633183894,3.548284609195136,14.19328873852236,10.2972019625245,12.22021815006443,16.78898393113869,7.080134604168755,10.93313372121314,12.87231997766835,8.213246869210764,7.759913289015294,2.794117512629882,7.604895564466041,7.739299905260026,7.724138825126985,4.57558182587627,8.421342560551018,8.171520031509516,12.88016846525849,8.377514888339796,5.192889568956694,9.061524066886228,20.77378734922578,8.727796071517687,8.399231653173352,4.086585275284051,10.82779838343546,6.91428748572487,10.77874694157113,8.101745222311692,12.71345942050768,8.25184660502471,14.61814103772296,12.73177292139593,11.17233164646239,15.1563418287739,2.742042250619484,9.869740541457318,9.023877099670308,16.09854465979554,15.89239600012993,8.793878065606009,3.475082901509388,4.626226371752999,7.616213612624868,11.86711634122467,15.61572013740592,14.25766059325092,15.80260311923288,1.228524326469362,4.947046865839766,20.42538940703702,5.876754100409798,9.007097681377971,13.58096433021544,4.190515617912766,11.60873874447977,13.05995888694647,3.471399411170225,7.711799294680191,13.3770969677856,3.414805030866546,12.17417708556501,8.410828973516146,8.788332673955658,8.382398170737758,10.52875774081334,14.37978115734537,6.785906278799018,-0.2941425123372881,4.581671600517751,10.85252878692449,11.92179777798074,10.51622181883022,7.988201434113051,8.374482206652118,7.682434478576436,7.346461167403987,12.81373339677362,9.304428445885456,20.00370421650645,8.682058543422848,5.989675610966216,11.61229432742051,7.865653492936879,11.46032790867181,15.90668020667488,14.47299277503457,1.487576918072428,12.22659037194472,8.576347989773218,15.47610053245715,12.00181978047823,4.442030479696868,16.22960263351492,8.416021739480257,3.726405145743691,13.3489698192976,13.36698434835908,1.356388072531161,11.99842430939548,11.22258524664564,11.2264159343199,13.63590202713868,12.68734030923753,10.20688699055417,7.711064675175827,15.95921961854968,7.540067757312485,14.09845926215448,5.801831445195965,4.964883805472311,12.59634221093361,4.809019190794707,5.136560122875139,8.224850225432,7.910129192089791,10.46621091197173,14.18646598522621,13.79416099727775,8.16109178246009,12.92659429366961,5.941330253951946,6.070860016941737,11.39734346477076,5.517402171673837,3.718818366861669,10.01415768664693,7.918855919748879,10.7819779421623,11.63913953035723,6.687596942284216,15.82314109202775,7.25372353705491,11.84332048202426,8.631142545503621,5.131999873091885,16.10481230335211,24.93512796027091,9.222995428472075,9.337053011616113,12.8091169112039]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>id<\/th>\n      <th>baseline<\/th>\n      <th>L<\/th>\n      <th>time1_x0<\/th>\n      <th>time1_x1<\/th>\n      <th>change1_x0<\/th>\n      <th>change1_x1<\/th>\n      <th>ite_time1<\/th>\n      <th>ite_change1<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"id","targets":1},{"name":"baseline","targets":2},{"name":"L","targets":3},{"name":"time1_x0","targets":4},{"name":"time1_x1","targets":5},{"name":"change1_x0","targets":6},{"name":"change1_x1","targets":7},{"name":"ite_time1","targets":8},{"name":"ite_change1","targets":9}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>In this data there is no variable for <code>group</code>, because we generated the potential outcomes for all participants under both control and treatment. We will use <code>group</code> in the next model to simulate treatment assignment for an RCT.</p>
</section>
<section id="summary-statistics" class="level3">
<h3 class="anchored" data-anchor-id="summary-statistics">Summary Statistics</h3>
<p>Let’s look at a summary of the data:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>table1 <span class="ot">&lt;-</span> dataMod1 <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>id) <span class="sc">|&gt;</span> <span class="fu">tbl_summary</span>()</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>table1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="zxxtsqudkr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#zxxtsqudkr table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#zxxtsqudkr thead, #zxxtsqudkr tbody, #zxxtsqudkr tfoot, #zxxtsqudkr tr, #zxxtsqudkr td, #zxxtsqudkr th {
  border-style: none;
}

#zxxtsqudkr p {
  margin: 0;
  padding: 0;
}

#zxxtsqudkr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#zxxtsqudkr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#zxxtsqudkr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#zxxtsqudkr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#zxxtsqudkr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zxxtsqudkr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zxxtsqudkr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zxxtsqudkr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#zxxtsqudkr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#zxxtsqudkr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#zxxtsqudkr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#zxxtsqudkr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#zxxtsqudkr .gt_spanner_row {
  border-bottom-style: hidden;
}

#zxxtsqudkr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#zxxtsqudkr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#zxxtsqudkr .gt_from_md > :first-child {
  margin-top: 0;
}

#zxxtsqudkr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#zxxtsqudkr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#zxxtsqudkr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#zxxtsqudkr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#zxxtsqudkr .gt_row_group_first td {
  border-top-width: 2px;
}

#zxxtsqudkr .gt_row_group_first th {
  border-top-width: 2px;
}

#zxxtsqudkr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zxxtsqudkr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#zxxtsqudkr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#zxxtsqudkr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zxxtsqudkr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zxxtsqudkr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#zxxtsqudkr .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#zxxtsqudkr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#zxxtsqudkr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zxxtsqudkr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zxxtsqudkr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zxxtsqudkr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zxxtsqudkr .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zxxtsqudkr .gt_left {
  text-align: left;
}

#zxxtsqudkr .gt_center {
  text-align: center;
}

#zxxtsqudkr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#zxxtsqudkr .gt_font_normal {
  font-weight: normal;
}

#zxxtsqudkr .gt_font_bold {
  font-weight: bold;
}

#zxxtsqudkr .gt_font_italic {
  font-style: italic;
}

#zxxtsqudkr .gt_super {
  font-size: 65%;
}

#zxxtsqudkr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#zxxtsqudkr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#zxxtsqudkr .gt_indent_1 {
  text-indent: 5px;
}

#zxxtsqudkr .gt_indent_2 {
  text-indent: 10px;
}

#zxxtsqudkr .gt_indent_3 {
  text-indent: 15px;
}

#zxxtsqudkr .gt_indent_4 {
  text-indent: 20px;
}

#zxxtsqudkr .gt_indent_5 {
  text-indent: 25px;
}

#zxxtsqudkr .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#zxxtsqudkr div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="stat_0" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>N = 150</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">baseline</td>
<td class="gt_row gt_center" headers="stat_0">50 (44, 57)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">L</td>
<td class="gt_row gt_center" headers="stat_0">43 (29%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">time1_x0</td>
<td class="gt_row gt_center" headers="stat_0">51 (45, 59)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">time1_x1</td>
<td class="gt_row gt_center" headers="stat_0">61 (53, 68)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">change1_x0</td>
<td class="gt_row gt_center" headers="stat_0">1.1 (-0.9, 3.6)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">change1_x1</td>
<td class="gt_row gt_center" headers="stat_0">10.3 (8.4, 14.2)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">ite_time1</td>
<td class="gt_row gt_center" headers="stat_0">9.0 (7.2, 12.7)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">ite_change1</td>
<td class="gt_row gt_center" headers="stat_0">9.0 (7.2, 12.7)</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="2" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> Median (Q1, Q3); n (%)</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p>From the summary, we can see, as expected, that under treatment <code>time1_x1</code> and <code>change1_x1</code> are close to 10 points higher than control.</p>
</section>
<section id="ate-on-follow-up-mean-difference" class="level3">
<h3 class="anchored" data-anchor-id="ate-on-follow-up-mean-difference">ATE on Follow-Up (Mean difference)</h3>
<p>Since we have the potential outcomes for all patients we can calculate the Average Treatment Effect of the treatment on <code>time1</code> (<a href="#eq-att-outcome" class="quarto-xref">Equation&nbsp;1</a>) as the difference between the mean follow-up outcome between the treated and control groups:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>po_estimate <span class="ot">&lt;-</span> <span class="fu">mean</span>(dataMod1<span class="sc">$</span>time1_x1) <span class="sc">-</span> <span class="fu">mean</span>(dataMod1<span class="sc">$</span>time1_x0)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Mean difference time1 (Treatment - Control):"</span>, <span class="fu">round</span>(po_estimate, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean difference time1 (Treatment - Control): 9.707 </code></pre>
</div>
</div>
<p>This is close to the true value of 10, but not perfect due to random noise added by the model and the relatively small sample size (150 participants).</p>
</section>
<section id="ate-on-change-scores-mean-difference" class="level3">
<h3 class="anchored" data-anchor-id="ate-on-change-scores-mean-difference">ATE on Change Scores (Mean difference)</h3>
<p>We can also compute the difference in <em>change scores</em> between the treated and untreated (<a href="#eq-changescore" class="quarto-xref">Equation&nbsp;5</a>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>po_change1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(dataMod1<span class="sc">$</span>change1_x1) <span class="sc">-</span> <span class="fu">mean</span>(dataMod1<span class="sc">$</span>change1_x0)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Mean difference change1 (Treatment - Control):"</span>, <span class="fu">round</span>(po_change1, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean difference change1 (Treatment - Control): 9.707 </code></pre>
</div>
</div>
<p>This is identical to the difference in follow-up outcomes. This is because with potential outcomes the baseline value under treatment and control for each patient is the same and hence cancel out across the two means below. To see this, we start with the estimand for the change score:</p>
<p><span id="eq-changescore"><span class="math display">\[
\mathrm{E}(Y_1^x - Y_0^x) - \mathrm{E}(Y_1^{x'} - Y_0^{x'})
\tag{5}\]</span></span></p>
<p>Since</p>
<p><span class="math display">\[\mathrm{E}(X - Y) = \mathrm{E}(X) - \mathrm{E}(Y)\]</span></p>
<p>we can rewrite <a href="#eq-changescore" class="quarto-xref">Equation&nbsp;5</a> as:</p>
<p><span class="math display">\[
\mathrm{E}(Y_1^x) - \mathrm{E}(Y_0^x) - \mathrm{E}(Y_1^{x'}) + \mathrm{E}(Y_0^{x'})
\]</span></p>
<p>When the baseline values under treatment and control are identical for each patient the second and fourth terms are identical and therefore <span class="math inline">\(- \mathrm{E}(Y_0^{x}) + \mathrm{E}(Y_0^{x'}) = 0\)</span> leaving only</p>
<p><span class="math display">\[
\mathrm{E}(Y_1^x)  - \mathrm{E}(Y_1^{x'})
\]</span></p>
<p>which is just the difference between the follow-up outcomes under treatment and control.</p>
<p>So why analyze change scores? First, <span class="citation" data-cites="glymour2022">Glymour (<a href="#ref-glymour2022" role="doc-biblioref">2022</a>)</span> notes that in many clinical and epidemiological studies change is more meaningful as an effect than the difference between the follow-up outcomes. Second if baseline scores are imbalanced between treatment and control, such as in an observational study or insufficiently randomized RCT, analyzing change in follow-up scores can bias the effect estimate.</p>
<p>To calculate a p-value and confidence interval, we can do a paired t-test (to reflect that we have two correlated measures per participant):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform paired t-test</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>t_test_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(dataMod1<span class="sc">$</span>time1_x1, dataMod1<span class="sc">$</span>time1_x0, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># View results</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co">#print(t_test_result)</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract specific values</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>mean_difference <span class="ot">&lt;-</span> t_test_result<span class="sc">$</span>estimate</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>confidence_interval <span class="ot">&lt;-</span> t_test_result<span class="sc">$</span>conf.int</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> t_test_result<span class="sc">$</span>p.value</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Display results nicely</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Mean difference time1 (Treatment - Control):"</span>, <span class="fu">round</span>(mean_difference, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean difference time1 (Treatment - Control): 9.707 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"95% Confidence Interval:"</span>, <span class="fu">round</span>(confidence_interval[<span class="dv">1</span>], <span class="dv">3</span>), <span class="st">"to"</span>, <span class="fu">round</span>(confidence_interval[<span class="dv">2</span>], <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>95% Confidence Interval: 9.014 to 10.399 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"P-value:"</span>, <span class="fu">round</span>(p_value, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>P-value: 0 </code></pre>
</div>
</div>
<p>The paired t-test shows a statistically significant difference between treatment and control conditions.</p>
<p>The t-test for the change score <code>change1</code> gives identical results:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform paired t-test</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>t_test_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(dataMod1<span class="sc">$</span>change1_x1, dataMod1<span class="sc">$</span>change1_x0, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># View results</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co">#print(t_test_result)</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract specific values</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>mean_difference <span class="ot">&lt;-</span> t_test_result<span class="sc">$</span>estimate</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>confidence_interval <span class="ot">&lt;-</span> t_test_result<span class="sc">$</span>conf.int</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> t_test_result<span class="sc">$</span>p.value</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Display results nicely</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Mean difference change1 (Treatment - Control):"</span>, <span class="fu">round</span>(mean_difference, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean difference change1 (Treatment - Control): 9.707 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"95% Confidence Interval:"</span>, <span class="fu">round</span>(confidence_interval[<span class="dv">1</span>], <span class="dv">3</span>), <span class="st">"to"</span>, <span class="fu">round</span>(confidence_interval[<span class="dv">2</span>], <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>95% Confidence Interval: 9.014 to 10.399 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"P-value:"</span>, <span class="fu">round</span>(p_value, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>P-value: 0 </code></pre>
</div>
</div>
<p>For later comparison to regression results, we can use regression instead of t-tests. However, since we have two measures for each participant (both potential outcomes) we need to use a linear mixed-effects model to account for within unit correlation.</p>
<p>The results summarize our analysis thus far:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)  <span class="co"># for p-values</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(merDeriv)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co"># effect on time1: reshape data to long format (2 rows per participant) for time1</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>dataMod1_Long <span class="ot">&lt;-</span> dataMod1 <span class="sc">|&gt;</span> </span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(time1_x0, time1_x1),</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>                         <span class="at">names_to =</span> <span class="st">"treatment"</span>,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"time1_outcome"</span>) <span class="sc">|&gt;</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">ifelse</span>(treatment <span class="sc">==</span> <span class="st">"time1_x1"</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">|&gt;</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">factor</span>(group, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Control"</span>, <span class="st">"Treatment"</span>)))</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Mixed effects model accounting for within-unit correlation</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>res_time1_po <span class="ot">&lt;-</span> <span class="fu">lmer</span>(time1_outcome <span class="sc">~</span> group <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>id),</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> dataMod1_Long)</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>tbl_time1_po <span class="ot">&lt;-</span> <span class="fu">tbl_regression</span>(res_time1_po,</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>                               <span class="at">show_single_row =</span> group)</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="co"># effect on change1: reshape data to long format (2 rows per participant) for time1</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>dataMod1_Long <span class="ot">&lt;-</span> dataMod1 <span class="sc">|&gt;</span> </span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(change1_x0, change1_x1),</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>                         <span class="at">names_to =</span> <span class="st">"treatment"</span>,</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"change1_outcome"</span>) <span class="sc">|&gt;</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">ifelse</span>(treatment <span class="sc">==</span> <span class="st">"change1_x1"</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">|&gt;</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">factor</span>(group, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Control"</span>, <span class="st">"Treatment"</span>)))</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Mixed effects model accounting for within-unit correlation</span></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>res_change1_po <span class="ot">&lt;-</span> <span class="fu">lmer</span>(change1_outcome <span class="sc">~</span> group <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>id), </span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> dataMod1_Long)</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>tbl_change1_po <span class="ot">&lt;-</span> <span class="fu">tbl_regression</span>(res_change1_po,</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">show_single_row =</span> group)</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_stack</span>(</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>    tbl_time1_po <span class="sc">|&gt;</span> <span class="fu">modify_table_body</span>(<span class="sc">~</span>.x <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">label =</span> <span class="st">"time1 (PO)"</span>)),</span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>    tbl_change1_po <span class="sc">|&gt;</span> <span class="fu">modify_table_body</span>(<span class="sc">~</span>.x <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">label =</span> <span class="st">"change1 (PO)"</span>))</span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_caption</span>(<span class="st">"**Treatment Effects Across Different Models and Estimators**"</span>)  <span class="sc">|&gt;</span></span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_footnote</span>(</span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>    label <span class="sc">~</span> <span class="st">"PO = Potential Outcomes"</span></span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_footnote</span>(</span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a>    estimate <span class="sc">~</span> <span class="st">"CI = Confidence Interval"</span></span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="ejtbqtvtsa" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ejtbqtvtsa table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ejtbqtvtsa thead, #ejtbqtvtsa tbody, #ejtbqtvtsa tfoot, #ejtbqtvtsa tr, #ejtbqtvtsa td, #ejtbqtvtsa th {
  border-style: none;
}

#ejtbqtvtsa p {
  margin: 0;
  padding: 0;
}

#ejtbqtvtsa .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ejtbqtvtsa .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ejtbqtvtsa .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ejtbqtvtsa .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ejtbqtvtsa .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ejtbqtvtsa .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ejtbqtvtsa .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ejtbqtvtsa .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ejtbqtvtsa .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ejtbqtvtsa .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ejtbqtvtsa .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ejtbqtvtsa .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ejtbqtvtsa .gt_spanner_row {
  border-bottom-style: hidden;
}

#ejtbqtvtsa .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ejtbqtvtsa .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ejtbqtvtsa .gt_from_md > :first-child {
  margin-top: 0;
}

#ejtbqtvtsa .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ejtbqtvtsa .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ejtbqtvtsa .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ejtbqtvtsa .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ejtbqtvtsa .gt_row_group_first td {
  border-top-width: 2px;
}

#ejtbqtvtsa .gt_row_group_first th {
  border-top-width: 2px;
}

#ejtbqtvtsa .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ejtbqtvtsa .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ejtbqtvtsa .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ejtbqtvtsa .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ejtbqtvtsa .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ejtbqtvtsa .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ejtbqtvtsa .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ejtbqtvtsa .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ejtbqtvtsa .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ejtbqtvtsa .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ejtbqtvtsa .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ejtbqtvtsa .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ejtbqtvtsa .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ejtbqtvtsa .gt_left {
  text-align: left;
}

#ejtbqtvtsa .gt_center {
  text-align: center;
}

#ejtbqtvtsa .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ejtbqtvtsa .gt_font_normal {
  font-weight: normal;
}

#ejtbqtvtsa .gt_font_bold {
  font-weight: bold;
}

#ejtbqtvtsa .gt_font_italic {
  font-style: italic;
}

#ejtbqtvtsa .gt_super {
  font-size: 65%;
}

#ejtbqtvtsa .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ejtbqtvtsa .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ejtbqtvtsa .gt_indent_1 {
  text-indent: 5px;
}

#ejtbqtvtsa .gt_indent_2 {
  text-indent: 10px;
}

#ejtbqtvtsa .gt_indent_3 {
  text-indent: 15px;
}

#ejtbqtvtsa .gt_indent_4 {
  text-indent: 20px;
}

#ejtbqtvtsa .gt_indent_5 {
  text-indent: 25px;
}

#ejtbqtvtsa .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ejtbqtvtsa div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <caption><span data-qmd-base64="KipUcmVhdG1lbnQgRWZmZWN0cyBBY3Jvc3MgRGlmZmVyZW50IE1vZGVscyBhbmQgRXN0aW1hdG9ycyoq"><span class="gt_from_md"><strong>Treatment Effects Across Different Models and Estimators</strong></span></span></caption>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="label"><span data-qmd-base64="KipDaGFyYWN0ZXJpc3RpYyoq"><span class="gt_from_md"><strong>Characteristic</strong></span></span><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="estimate"><span data-qmd-base64="KipCZXRhKio="><span class="gt_from_md"><strong>Beta</strong></span></span><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="conf.low"><span data-qmd-base64="Kio5NSUgQ0kqKg=="><span class="gt_from_md"><strong>95% CI</strong></span></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="p.value"><span data-qmd-base64="KipwLXZhbHVlKio="><span class="gt_from_md"><strong>p-value</strong></span></span></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">time1 (PO)</td>
<td headers="estimate" class="gt_row gt_center">9.7</td>
<td headers="conf.low" class="gt_row gt_center">9.0, 10</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">change1 (PO)</td>
<td headers="estimate" class="gt_row gt_center">9.7</td>
<td headers="conf.low" class="gt_row gt_center">9.0, 10</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
  </tbody>
  <tfoot class="gt_sourcenotes">
    <tr>
      <td class="gt_sourcenote" colspan="4"><span data-qmd-base64="QWJicmV2aWF0aW9uOiBDSSA9IENvbmZpZGVuY2UgSW50ZXJ2YWw="><span class="gt_from_md">Abbreviation: CI = Confidence Interval</span></span></td>
    </tr>
  </tfoot>
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="4"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> <span data-qmd-base64="UE8gPSBQb3RlbnRpYWwgT3V0Y29tZXM="><span class="gt_from_md">PO = Potential Outcomes</span></span></td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="4"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span> <span data-qmd-base64="Q0kgPSBDb25maWRlbmNlIEludGVydmFs"><span class="gt_from_md">CI = Confidence Interval</span></span></td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
<p>Given the small sample size and random noise, the potential outcomes analysis gives us the gold standard causal effect estimate by which we can judge all other effect estimates that use the same data.</p>
<p>We can now consider an RCT using the same data, but with randomization of treatment assignment.</p>
</section>
</section>
<section id="model2-rct-with-additive-treatment-effect" class="level2">
<h2 class="anchored" data-anchor-id="model2-rct-with-additive-treatment-effect">Model2: RCT with Additive Treatment Effect</h2>
<p>This model uses the same causal DAG and potential outcomes generated for Model 1. We copy the dataset from Model 1, but now we add the <code>group</code> variable that reflects the treatment each patient was randomized to. Based on the assigned treatment, we then copy the appropriate potential outcomes to the observed <code>time1</code> and <code>change1</code>. Finally we save all of the data, then create a new data frame that includes only the variables we would see in an RCT.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>dataMod2 <span class="ot">&lt;-</span> dataMod1</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign participants to treatment vs control</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> n<span class="sc">/</span><span class="dv">2</span>) <span class="co"># 0 = control, 1 = treatment</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Copy the potential outcome for time1 and change1 based on treatment assignment</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>time1 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(group <span class="sc">==</span> <span class="dv">0</span>, time1_x0, time1_x1)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>change1 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(group <span class="sc">==</span> <span class="dv">0</span>, change1_x0, change1_x1)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the new variables to the Model 2 dataset</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert group to a factor, but use levels to make sure Treatment is first so that t.test</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="co"># substracts treatment means from control means</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>dataMod2<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">factor</span>(group, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Control"</span>, <span class="st">"Treatment"</span>))</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>dataMod2<span class="sc">$</span>time1 <span class="ot">&lt;-</span> time1</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>dataMod2<span class="sc">$</span>change1 <span class="ot">&lt;-</span> change1</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="co"># dataMod2 contains all of the potential outcomes, lets copy it to preserve it and keep only the data we would see in an RCT</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>dataMod2_all <span class="ot">&lt;-</span> dataMod2</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>dataMod2 <span class="ot">&lt;-</span> dataMod2 <span class="sc">|&gt;</span> <span class="fu">select</span>(id, group, baseline, L, time1, change1)</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(dataMod2, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">pageLength =</span> <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-834af1cf88e099bfd462" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-834af1cf88e099bfd462">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150"],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150],["Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Control","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment","Treatment"],[36.1492938140562,50.38323181021901,42.36969837638026,52.12306135525839,64.25537966867792,57.44479822333976,57.0022940298623,47.70645386548274,51.97093861895352,62.07153773872257,53.18336726424769,35.76201146372445,45.94909141950813,59.95386565684022,59.58817787640257,59.1808789631995,48.4903039811839,37.76931211133796,41.31175711362206,39.57514635095707,38.9636221693313,54.44185061636591,47.95049387752277,66.75632433148326,48.6867775006957,48.00117022068815,50.54912415432123,43.17834511454831,42.72295851857338,41.38095714059664,49.62476885005964,33.68576759763806,51.7716659588745,49.87499200921824,46.05682873574104,53.51562931221001,58.78767562719921,52.04654080230588,41.12619289608275,45.22783941705452,47.32259046645307,65.85859163151744,50.46900594697962,53.56496777244958,48.78619994679629,49.63908157900605,40.18852513273207,45.65740172347076,49.32515644708256,59.81894565963953,45.37947608705008,47.74900717356022,41.53552199738108,50.7304631935885,47.24963580453851,46.13573642741976,49.5379685855967,41.74106278163622,41.45965762254298,51.18736809402656,52.83596905517313,69.30086466248267,38.5947238195217,36.77881757133585,62.28831605394996,44.51543967644129,48.73992507865754,56.87718721631207,57.05200375971499,58.01478429090865,45.37116820836361,41.15445015899184,33.6907242657997,55.62230587919655,46.74108165373376,52.4137562009856,60.85869099457267,69.07061614660081,58.12927449301863,54.94888787113184,49.0485223648262,61.38780499501301,55.02314628861913,44.84585945975069,25.3160953291529,41.27447256274069,59.64088079895252,59.10796248707817,69.25808837446685,46.97093052078708,39.45292949887301,54.18116085183897,57.01272821932616,52.46758282351839,54.64295161386731,46.04531812298992,57.13070305154749,61.85012556327626,30.88850711896562,61.1493056406232,45.3069979374733,38.51997246608669,61.03997956657752,47.10750083048119,47.22671378990475,41.24217361194295,50.03279151814386,52.65591625375043,48.75975868342836,48.71074094413365,52.99112314061662,50.18299211822657,38.49938669161833,45.70603652970917,58.50002976678222,47.85170508156628,43.82585983946465,51.09427384034174,42.93488936081676,65.4297581655436,53.50801720173732,61.72620574095716,49.66626469488467,53.61443995656251,60.45575638501893,51.03212392415602,53.31795557645035,34.3144118526109,54.4026994419263,68.81871322324494,63.49106265191625,33.64917228422103,42.84467267827526,40.83505677118566,26.38973055324857,65.2845000149248,43.70212776144518,39.31907978582351,62.44859824206127,54.59876146065523,51.6770582831924,47.24996977390859,54.92322618045394,63.3975457108875,45.23255775698019,35.03204463451998,37.98576029350947,45.92538971792439,40.5225190465432,58.51666398410158],[0,1,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,1,0,1,0,0,0,0,1,0,0,1,1,0,0,0,1,0,0,0,1,0,1,1,0,1,0,0,0,0,1,1,0,1,1,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,1,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,1,0,0,1,1,1,1,0,0,1,0,0,0,0,0,0,1,1,0,0,1,0,0,1,0,0,0,0,0,1,0,1,0,1,0,0,0,0,0,0,0,1,0,0,0,0,1,0,1,0,0,0,0,1,0,0],[34.87067748596235,55.8281416387037,49.95312670406218,56.69286109140374,67.35458259720528,56.37120354352962,59.27545947235477,54.60268195561349,51.74422833269585,75.655283126767,48.95699717359015,35.99132474202099,40.62946412471763,59.32228139184009,58.67681495648782,57.34541337516896,48.0690411290302,38.13338443439935,43.51287564202813,46.2534424226104,40.69399814369142,54.93537908294647,55.33516967190703,69.86911340107429,44.32874741313569,54.48365826785727,48.0566647152062,50.60230704806548,43.35118892616044,45.5482525486624,45.22001043411207,35.1777368419676,52.21097874764608,51.79976718217534,51.26375720337204,53.57122162228654,57.97640733819982,56.34947382997218,43.28249762617214,46.04905845347878,47.11349936073555,64.52460294589417,55.58531457881465,52.62127561655934,54.40475541379831,45.47107504587864,47.28015216769703,42.17161295597239,51.54193281590328,65.7004689633157,45.99589460997009,53.93827293558662,41.01068102042228,48.13233520724143,44.99559055673623,41.15631767671267,47.14863360666967,49.73314086598293,45.0633841226962,49.92044532389235,60.84427663823608,68.69777410242656,39.80569359720521,37.64391284091071,62.29320733969929,42.49849646081402,51.38248096058659,60.0422455455877,58.9653933859129,68.91364954596486,41.55627920794279,41.43360387792814,34.61190874416981,55.6509037182506,44.65497395122955,66.64657595160911,75.31616331392505,82.20776792735796,63.69371584128629,62.66909464375735,58.60044293836651,72.49850891091003,62.54691397335684,55.47245986454331,30.06620929650495,53.29121146257172,72.27238954385564,68.07724145925553,85.81579287779195,65.17161727488849,48.52084342254355,62.76687954101198,66.40241904945643,63.3845653974247,71.92918429042489,62.35757628055472,63.55922340880252,80.32508714199334,44.8251996689664,80.58479185245046,57.33550932109895,46.19343040808479,75.04294000325169,61.03803801216949,52.82876019591376,51.17382997477117,61.84538930642899,60.12881452797978,58.1652923510141,57.49995452129577,71.40707580542535,64.67147172212812,45.04336699682654,56.6372547302712,69.26387025264364,58.8146240329402,51.60778043818837,66.99547600002391,50.17198689938162,74.50156635373585,60.48707270807397,68.04956838754767,57.13076391707875,69.36470156845235,69.97043481666464,64.46904175029123,63.15602825597627,54.89524638210268,64.89994180022536,81.2268037976671,71.40364721034859,41.0258151863067,52.33608835245281,52.30508075519099,32.0910883728428,80.12116572178232,52.05553722379989,50.28297835827317,70.43644857264758,64.08027955378246,66.9463515554113,55.55414328477285,72.02337397443885,73.13161171802173,53.0050435296269,48.82663249241416,53.33494769068677,57.33440286471608,52.56767692501152,73.0816852751561],[-1.278616328093854,5.44490982848469,7.583428327681922,4.569799736145356,3.099202928527362,-1.073594679810142,2.27316544249247,6.896228090130755,-0.2267102862576635,13.58374538804443,-4.226370090657539,0.2293132782965372,-5.3196272947905,-0.6315842650001287,-0.9113629199147439,-1.835465588030544,-0.4212628521537027,0.3640723230613858,2.20111852840607,6.678296071653328,1.730375974360122,0.4935284665805568,7.384675794384265,3.112789069591031,-4.358030087560017,6.48248804716912,-2.492459439115038,7.423961933517162,0.6282304075870613,4.167295408065769,-4.404758415947569,1.491969244329539,0.4393127887715806,1.924775172957105,5.206928467631002,0.05559231007653409,-0.8112682889993863,4.302933027666306,2.156304730089388,0.8212190364242602,-0.2090911057175262,-1.333988685623268,5.116308631835032,-0.9436921558902398,5.618555467002025,-4.168006533127411,7.091627034964965,-3.48578876749837,2.216776368820717,5.881523303676168,0.6164185229200143,6.189265762026402,-0.5248409769588065,-2.598127986347066,-2.254045247802274,-4.979418750707097,-2.389334978927032,7.992078084346716,3.603726500153222,-1.266922770134208,8.008307583062951,-0.6030905600561027,1.210969777683502,0.8650952695748586,0.004891285749330621,-2.016943215627265,2.642555881929049,3.165058329275638,1.913389626197919,10.89886525505621,-3.814889000420827,0.2791537189362927,0.9211844783701082,0.02859783905405067,-2.086107702504208,14.23281975062351,14.45747231935238,13.13715178075715,5.564441348267664,7.720206772625502,9.551920573540315,11.11070391589702,7.523767684737706,10.62660040479262,4.750113967352053,12.01673889983103,12.63150874490312,8.969278972177364,16.5577045033251,18.20068675410141,9.067913923670538,8.585718689173014,9.38969083013027,10.91698257390631,17.28623267655757,16.31225815756481,6.428520357255032,18.47496157871708,13.93669255000078,19.43548621182727,12.02851138362565,7.673457941998102,14.00296043667417,13.9305371816883,5.602046406009009,9.931656362828214,11.81259778828513,7.472898274229358,9.405533667585743,8.789213577162116,18.41595266480873,14.48847960390155,6.543980305208208,10.93121820056203,10.76384048586142,10.96291895137392,7.781920598723723,15.90120215968217,7.237097538564861,9.07180818819225,6.97905550633665,6.32336264659051,7.464499222194078,15.75026161188983,9.514678431645706,13.43691782613521,9.838072679525922,20.58083452949178,10.49724235829906,12.40809057442216,7.912584558432343,7.376642902085671,9.491415674177553,11.47002398400534,5.701357819594236,14.83666570685752,8.353409462354705,10.96389857244966,7.987850330586305,9.481518093127235,15.2692932722189,8.30417351086426,17.10014779398492,9.734066007134231,7.772485772646711,13.79458785789419,15.3491873971773,11.40901314679169,12.04515787846832,14.56502129105453]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>id<\/th>\n      <th>group<\/th>\n      <th>baseline<\/th>\n      <th>L<\/th>\n      <th>time1<\/th>\n      <th>change1<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"className":"dt-right","targets":[1,3,4,5,6]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"id","targets":1},{"name":"group","targets":2},{"name":"baseline","targets":3},{"name":"L","targets":4},{"name":"time1","targets":5},{"name":"change1","targets":6}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Here is the overall summary of the data:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>table1_Mod2 <span class="ot">&lt;-</span> dataMod2 <span class="sc">|&gt;</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>id) <span class="sc">|&gt;</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tbl_summary</span>() <span class="sc">|&gt;</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_labels</span>()</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>table1_Mod2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="yvnqfhgpvu" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#yvnqfhgpvu table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#yvnqfhgpvu thead, #yvnqfhgpvu tbody, #yvnqfhgpvu tfoot, #yvnqfhgpvu tr, #yvnqfhgpvu td, #yvnqfhgpvu th {
  border-style: none;
}

#yvnqfhgpvu p {
  margin: 0;
  padding: 0;
}

#yvnqfhgpvu .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#yvnqfhgpvu .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#yvnqfhgpvu .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#yvnqfhgpvu .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#yvnqfhgpvu .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yvnqfhgpvu .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yvnqfhgpvu .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yvnqfhgpvu .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#yvnqfhgpvu .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#yvnqfhgpvu .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#yvnqfhgpvu .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#yvnqfhgpvu .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#yvnqfhgpvu .gt_spanner_row {
  border-bottom-style: hidden;
}

#yvnqfhgpvu .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#yvnqfhgpvu .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#yvnqfhgpvu .gt_from_md > :first-child {
  margin-top: 0;
}

#yvnqfhgpvu .gt_from_md > :last-child {
  margin-bottom: 0;
}

#yvnqfhgpvu .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#yvnqfhgpvu .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#yvnqfhgpvu .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#yvnqfhgpvu .gt_row_group_first td {
  border-top-width: 2px;
}

#yvnqfhgpvu .gt_row_group_first th {
  border-top-width: 2px;
}

#yvnqfhgpvu .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yvnqfhgpvu .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#yvnqfhgpvu .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#yvnqfhgpvu .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yvnqfhgpvu .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yvnqfhgpvu .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#yvnqfhgpvu .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#yvnqfhgpvu .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#yvnqfhgpvu .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yvnqfhgpvu .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yvnqfhgpvu .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yvnqfhgpvu .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yvnqfhgpvu .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yvnqfhgpvu .gt_left {
  text-align: left;
}

#yvnqfhgpvu .gt_center {
  text-align: center;
}

#yvnqfhgpvu .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#yvnqfhgpvu .gt_font_normal {
  font-weight: normal;
}

#yvnqfhgpvu .gt_font_bold {
  font-weight: bold;
}

#yvnqfhgpvu .gt_font_italic {
  font-style: italic;
}

#yvnqfhgpvu .gt_super {
  font-size: 65%;
}

#yvnqfhgpvu .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#yvnqfhgpvu .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#yvnqfhgpvu .gt_indent_1 {
  text-indent: 5px;
}

#yvnqfhgpvu .gt_indent_2 {
  text-indent: 10px;
}

#yvnqfhgpvu .gt_indent_3 {
  text-indent: 15px;
}

#yvnqfhgpvu .gt_indent_4 {
  text-indent: 20px;
}

#yvnqfhgpvu .gt_indent_5 {
  text-indent: 25px;
}

#yvnqfhgpvu .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#yvnqfhgpvu div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header gt_col_headings">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="stat_0" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>N = 150</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">group</td>
<td class="gt_row gt_center" headers="stat_0"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Control</td>
<td class="gt_row gt_center" headers="stat_0">75 (50%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Treatment</td>
<td class="gt_row gt_center" headers="stat_0">75 (50%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">baseline</td>
<td class="gt_row gt_center" headers="stat_0">50 (44, 57)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">L</td>
<td class="gt_row gt_center" headers="stat_0">43 (29%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">time1</td>
<td class="gt_row gt_center" headers="stat_0">56 (48, 64)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">change1</td>
<td class="gt_row gt_center" headers="stat_0">7.0 (0.6, 10.9)</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="even">
<td colspan="2" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> n (%); Median (Q1, Q3)</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p>And here is a summary showing the difference between control and treatment:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>table2_Mod2 <span class="ot">&lt;-</span> dataMod2 <span class="sc">|&gt;</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>id) <span class="sc">|&gt;</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">as.factor</span>(group)) <span class="sc">|&gt;</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tbl_summary</span>(<span class="at">by =</span> group) <span class="sc">|&gt;</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_p</span>() <span class="sc">|&gt;</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_labels</span>()</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>table2_Mod2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="odgsrkchye" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#odgsrkchye table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#odgsrkchye thead, #odgsrkchye tbody, #odgsrkchye tfoot, #odgsrkchye tr, #odgsrkchye td, #odgsrkchye th {
  border-style: none;
}

#odgsrkchye p {
  margin: 0;
  padding: 0;
}

#odgsrkchye .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#odgsrkchye .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#odgsrkchye .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#odgsrkchye .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#odgsrkchye .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#odgsrkchye .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#odgsrkchye .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#odgsrkchye .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#odgsrkchye .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#odgsrkchye .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#odgsrkchye .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#odgsrkchye .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#odgsrkchye .gt_spanner_row {
  border-bottom-style: hidden;
}

#odgsrkchye .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#odgsrkchye .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#odgsrkchye .gt_from_md > :first-child {
  margin-top: 0;
}

#odgsrkchye .gt_from_md > :last-child {
  margin-bottom: 0;
}

#odgsrkchye .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#odgsrkchye .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#odgsrkchye .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#odgsrkchye .gt_row_group_first td {
  border-top-width: 2px;
}

#odgsrkchye .gt_row_group_first th {
  border-top-width: 2px;
}

#odgsrkchye .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#odgsrkchye .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#odgsrkchye .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#odgsrkchye .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#odgsrkchye .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#odgsrkchye .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#odgsrkchye .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#odgsrkchye .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#odgsrkchye .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#odgsrkchye .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#odgsrkchye .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#odgsrkchye .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#odgsrkchye .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#odgsrkchye .gt_left {
  text-align: left;
}

#odgsrkchye .gt_center {
  text-align: center;
}

#odgsrkchye .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#odgsrkchye .gt_font_normal {
  font-weight: normal;
}

#odgsrkchye .gt_font_bold {
  font-weight: bold;
}

#odgsrkchye .gt_font_italic {
  font-style: italic;
}

#odgsrkchye .gt_super {
  font-size: 65%;
}

#odgsrkchye .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#odgsrkchye .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#odgsrkchye .gt_indent_1 {
  text-indent: 5px;
}

#odgsrkchye .gt_indent_2 {
  text-indent: 10px;
}

#odgsrkchye .gt_indent_3 {
  text-indent: 15px;
}

#odgsrkchye .gt_indent_4 {
  text-indent: 20px;
}

#odgsrkchye .gt_indent_5 {
  text-indent: 25px;
}

#odgsrkchye .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#odgsrkchye div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header gt_col_headings">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="stat_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Control</strong><br>
N = 75<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Treatment</strong><br>
N = 75<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">baseline</td>
<td class="gt_row gt_center" headers="stat_1">49 (43, 54)</td>
<td class="gt_row gt_center" headers="stat_2">51 (44, 59)</td>
<td class="gt_row gt_center" headers="p.value">0.2</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">L</td>
<td class="gt_row gt_center" headers="stat_1">22 (29%)</td>
<td class="gt_row gt_center" headers="stat_2">21 (28%)</td>
<td class="gt_row gt_center" headers="p.value">0.9</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">time1</td>
<td class="gt_row gt_center" headers="stat_1">50 (44, 56)</td>
<td class="gt_row gt_center" headers="stat_2">63 (53, 70)</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">change1</td>
<td class="gt_row gt_center" headers="stat_1">0.6 (-1.1, 4.3)</td>
<td class="gt_row gt_center" headers="stat_2">10.8 (8.0, 14.0)</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="4" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> Median (Q1, Q3); n (%)</td>
</tr>
<tr class="even">
<td colspan="4" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span> Wilcoxon rank sum test; Pearson’s Chi-squared test</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p>We can see that both <code>time1</code> and <code>change1</code> differ significantly between the two groups. Note that even in this RCT, the baseline values between control and treatment groups are slightly different, though the difference is not significant. We can explore this more using a covariate balance plot:</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code> cobalt (Version 4.6.0, Build Date: 2025-04-15)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Note: `s.d.denom` not specified; assuming "pooled".</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Baseline_Change_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>A general rule of thumb is that the standardized mean differences between covariates should fall between <span class="math inline">\(+/-0.1\)</span>. As seen above, despite randomization, <code>baseline</code> in our RCT is outside this range, while <code>L</code> is inside. If the baseline values of the treatment and control group are balanced, then an unbiased average treatment effect is just the mean of <code>time2</code> for those in the treatment group minus the mean for those in the control group. Let’s calculate that here and see if the baseline imbalance creates a biased estimate:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>means <span class="ot">&lt;-</span> dataMod2 <span class="sc">|&gt;</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(group) <span class="sc">|&gt;</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(time1))</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>rct_time1_mean_diff <span class="ot">&lt;-</span> <span class="fu">filter</span>(means, group<span class="sc">==</span><span class="st">"Treatment"</span>)<span class="sc">$</span>mean <span class="sc">-</span> <span class="fu">filter</span>(means, group<span class="sc">==</span><span class="st">"Control"</span>)<span class="sc">$</span>mean</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Mean difference in time1 from RCT (Treatment - Control):"</span>, <span class="fu">round</span>(rct_time1_mean_diff, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean difference in time1 from RCT (Treatment - Control): 11.108 </code></pre>
</div>
</div>
<p>Recall that the true causal effect is 10 and the estimate from this data based on potential outcomes is 9.7065413. The estimate from the RCT is higher than both. Let’s use regression to estimate the difference in means for <code>time1</code> between the treatment and control groups and give us a p-value and confidence interval:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>res_time1_group <span class="ot">&lt;-</span> <span class="fu">lm</span>(time1 <span class="sc">~</span> group, <span class="at">data =</span> dataMod2)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>tbl_time1_group <span class="ot">&lt;-</span> <span class="fu">tbl_regression</span>(res_time1_group, <span class="at">show_single_row =</span> group)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>tbl_time1_group</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="mostqmexjd" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#mostqmexjd table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#mostqmexjd thead, #mostqmexjd tbody, #mostqmexjd tfoot, #mostqmexjd tr, #mostqmexjd td, #mostqmexjd th {
  border-style: none;
}

#mostqmexjd p {
  margin: 0;
  padding: 0;
}

#mostqmexjd .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mostqmexjd .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#mostqmexjd .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mostqmexjd .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mostqmexjd .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mostqmexjd .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mostqmexjd .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mostqmexjd .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mostqmexjd .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mostqmexjd .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mostqmexjd .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mostqmexjd .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mostqmexjd .gt_spanner_row {
  border-bottom-style: hidden;
}

#mostqmexjd .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#mostqmexjd .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#mostqmexjd .gt_from_md > :first-child {
  margin-top: 0;
}

#mostqmexjd .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mostqmexjd .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#mostqmexjd .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#mostqmexjd .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mostqmexjd .gt_row_group_first td {
  border-top-width: 2px;
}

#mostqmexjd .gt_row_group_first th {
  border-top-width: 2px;
}

#mostqmexjd .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mostqmexjd .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#mostqmexjd .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mostqmexjd .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mostqmexjd .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mostqmexjd .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#mostqmexjd .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#mostqmexjd .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#mostqmexjd .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mostqmexjd .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mostqmexjd .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mostqmexjd .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mostqmexjd .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mostqmexjd .gt_left {
  text-align: left;
}

#mostqmexjd .gt_center {
  text-align: center;
}

#mostqmexjd .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mostqmexjd .gt_font_normal {
  font-weight: normal;
}

#mostqmexjd .gt_font_bold {
  font-weight: bold;
}

#mostqmexjd .gt_font_italic {
  font-style: italic;
}

#mostqmexjd .gt_super {
  font-size: 65%;
}

#mostqmexjd .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#mostqmexjd .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mostqmexjd .gt_indent_1 {
  text-indent: 5px;
}

#mostqmexjd .gt_indent_2 {
  text-indent: 10px;
}

#mostqmexjd .gt_indent_3 {
  text-indent: 15px;
}

#mostqmexjd .gt_indent_4 {
  text-indent: 20px;
}

#mostqmexjd .gt_indent_5 {
  text-indent: 25px;
}

#mostqmexjd .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#mostqmexjd div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Beta</strong></th>
<th id="conf.low" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">group</td>
<td class="gt_row gt_center" headers="estimate">11</td>
<td class="gt_row gt_center" headers="conf.low">7.8, 14</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
</tbody><tfoot class="gt_sourcenotes">
<tr class="even">
<td colspan="4" class="gt_sourcenote">Abbreviation: CI = Confidence Interval</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p>The treatment group showed significantly higher <code>time1</code> scores compared to the control group; however, the effect estimate is biased as a result of the baseline imbalance. Going back to the data, the mean baseline for the control group is lower than the mean in the treatment group:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>baseline_means <span class="ot">&lt;-</span> dataMod2 <span class="sc">|&gt;</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(group) <span class="sc">|&gt;</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(baseline))</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>baseline_means</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  group      mean
  &lt;fct&gt;     &lt;dbl&gt;
1 Control    49.2
2 Treatment  50.6</code></pre>
</div>
</div>
<p>The difference between the mean baselines is</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>rct_mean_baseline_diff <span class="ot">&lt;-</span> <span class="fu">filter</span>(baseline_means, group<span class="sc">==</span><span class="st">"Treatment"</span>)<span class="sc">$</span>mean <span class="sc">-</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(baseline_means, group<span class="sc">==</span><span class="st">"Control"</span>)<span class="sc">$</span>mean</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Mean difference in baseline from RCT (Treatment - Control):"</span>, <span class="fu">round</span>(rct_mean_baseline_diff, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean difference in baseline from RCT (Treatment - Control): 1.415 </code></pre>
</div>
</div>
<p>This baseline imbalance results in a biased effect estimate when we use the difference in follow-up scores. Those differences do not take the imbalance into effect, because they do not use the baseline score.</p>
<p>If we compare the analyses we have done so far, we see that analyzing <code>time1</code> from the RCT gives a biased effect estimate with a confidence interval that is much wider than that from the potential outcomes analysis:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_stack</span>(</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    tbl_time1_po <span class="sc">|&gt;</span> <span class="fu">modify_table_body</span>(<span class="sc">~</span>.x <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">label =</span> <span class="st">"time1 (PO)"</span>)),</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    tbl_change1_po <span class="sc">|&gt;</span> <span class="fu">modify_table_body</span>(<span class="sc">~</span>.x <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">label =</span> <span class="st">"change1 (PO)"</span>)),</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    tbl_time1_group <span class="sc">|&gt;</span> <span class="fu">modify_table_body</span>(<span class="sc">~</span>.x <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">label =</span> <span class="st">"time1 (RCT)"</span>))</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_caption</span>(<span class="st">"**Treatment Effects Across Different Models and Estimators**"</span>) <span class="sc">|&gt;</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_footnote</span>(</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>    label <span class="sc">~</span> <span class="st">"PO = Potential Outcomes; RCT = Randomized Controlled Trial"</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_footnote</span>(</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>    estimate <span class="sc">~</span> <span class="st">"CI = Confidence Interval"</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_table_styling</span>(</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">everything</span>(),</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">rows =</span> label <span class="sc">==</span> <span class="st">"time1 (RCT)"</span>,  <span class="co"># Replace with your specific row label</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">text_format =</span> <span class="st">"bold"</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tdkxfnzjhi" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#tdkxfnzjhi table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#tdkxfnzjhi thead, #tdkxfnzjhi tbody, #tdkxfnzjhi tfoot, #tdkxfnzjhi tr, #tdkxfnzjhi td, #tdkxfnzjhi th {
  border-style: none;
}

#tdkxfnzjhi p {
  margin: 0;
  padding: 0;
}

#tdkxfnzjhi .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#tdkxfnzjhi .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#tdkxfnzjhi .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#tdkxfnzjhi .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#tdkxfnzjhi .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tdkxfnzjhi .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tdkxfnzjhi .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tdkxfnzjhi .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#tdkxfnzjhi .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#tdkxfnzjhi .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#tdkxfnzjhi .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#tdkxfnzjhi .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#tdkxfnzjhi .gt_spanner_row {
  border-bottom-style: hidden;
}

#tdkxfnzjhi .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#tdkxfnzjhi .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#tdkxfnzjhi .gt_from_md > :first-child {
  margin-top: 0;
}

#tdkxfnzjhi .gt_from_md > :last-child {
  margin-bottom: 0;
}

#tdkxfnzjhi .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#tdkxfnzjhi .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#tdkxfnzjhi .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#tdkxfnzjhi .gt_row_group_first td {
  border-top-width: 2px;
}

#tdkxfnzjhi .gt_row_group_first th {
  border-top-width: 2px;
}

#tdkxfnzjhi .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tdkxfnzjhi .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#tdkxfnzjhi .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#tdkxfnzjhi .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tdkxfnzjhi .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tdkxfnzjhi .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#tdkxfnzjhi .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#tdkxfnzjhi .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#tdkxfnzjhi .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tdkxfnzjhi .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tdkxfnzjhi .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tdkxfnzjhi .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tdkxfnzjhi .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tdkxfnzjhi .gt_left {
  text-align: left;
}

#tdkxfnzjhi .gt_center {
  text-align: center;
}

#tdkxfnzjhi .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#tdkxfnzjhi .gt_font_normal {
  font-weight: normal;
}

#tdkxfnzjhi .gt_font_bold {
  font-weight: bold;
}

#tdkxfnzjhi .gt_font_italic {
  font-style: italic;
}

#tdkxfnzjhi .gt_super {
  font-size: 65%;
}

#tdkxfnzjhi .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#tdkxfnzjhi .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#tdkxfnzjhi .gt_indent_1 {
  text-indent: 5px;
}

#tdkxfnzjhi .gt_indent_2 {
  text-indent: 10px;
}

#tdkxfnzjhi .gt_indent_3 {
  text-indent: 15px;
}

#tdkxfnzjhi .gt_indent_4 {
  text-indent: 20px;
}

#tdkxfnzjhi .gt_indent_5 {
  text-indent: 25px;
}

#tdkxfnzjhi .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#tdkxfnzjhi div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <caption><span data-qmd-base64="KipUcmVhdG1lbnQgRWZmZWN0cyBBY3Jvc3MgRGlmZmVyZW50IE1vZGVscyBhbmQgRXN0aW1hdG9ycyoq"><span class="gt_from_md"><strong>Treatment Effects Across Different Models and Estimators</strong></span></span></caption>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="label"><span data-qmd-base64="KipDaGFyYWN0ZXJpc3RpYyoq"><span class="gt_from_md"><strong>Characteristic</strong></span></span><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="estimate"><span data-qmd-base64="KipCZXRhKio="><span class="gt_from_md"><strong>Beta</strong></span></span><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="conf.low"><span data-qmd-base64="Kio5NSUgQ0kqKg=="><span class="gt_from_md"><strong>95% CI</strong></span></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="p.value"><span data-qmd-base64="KipwLXZhbHVlKio="><span class="gt_from_md"><strong>p-value</strong></span></span></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">time1 (PO)</td>
<td headers="estimate" class="gt_row gt_center">9.7</td>
<td headers="conf.low" class="gt_row gt_center">9.0, 10</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">change1 (PO)</td>
<td headers="estimate" class="gt_row gt_center">9.7</td>
<td headers="conf.low" class="gt_row gt_center">9.0, 10</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left" style="font-weight: bold;">time1 (RCT)</td>
<td headers="estimate" class="gt_row gt_center" style="font-weight: bold;">11</td>
<td headers="conf.low" class="gt_row gt_center" style="font-weight: bold;">7.8, 14</td>
<td headers="p.value" class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td></tr>
  </tbody>
  <tfoot class="gt_sourcenotes">
    <tr>
      <td class="gt_sourcenote" colspan="4"><span data-qmd-base64="QWJicmV2aWF0aW9uOiBDSSA9IENvbmZpZGVuY2UgSW50ZXJ2YWw="><span class="gt_from_md">Abbreviation: CI = Confidence Interval</span></span></td>
    </tr>
  </tfoot>
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="4"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> <span data-qmd-base64="UE8gPSBQb3RlbnRpYWwgT3V0Y29tZXM7IFJDVCA9IFJhbmRvbWl6ZWQgQ29udHJvbGxlZCBUcmlhbA=="><span class="gt_from_md">PO = Potential Outcomes; RCT = Randomized Controlled Trial</span></span></td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="4"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span> <span data-qmd-base64="Q0kgPSBDb25maWRlbmNlIEludGVydmFs"><span class="gt_from_md">CI = Confidence Interval</span></span></td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
<p>Now lets consider the effect of treatment on the change score, <code>change1</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>means <span class="ot">&lt;-</span> dataMod2 <span class="sc">|&gt;</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(group) <span class="sc">|&gt;</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(change1))</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>rct_change1_mean_diff <span class="ot">&lt;-</span> <span class="fu">filter</span>(means, group<span class="sc">==</span><span class="st">"Treatment"</span>)<span class="sc">$</span>mean <span class="sc">-</span> <span class="fu">filter</span>(means, group<span class="sc">==</span><span class="st">"Control"</span>)<span class="sc">$</span>mean</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Mean difference in change1 from RCT (Treatment - Control):"</span>, <span class="fu">round</span>(rct_change1_mean_diff, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean difference in change1 from RCT (Treatment - Control): 9.693 </code></pre>
</div>
</div>
<p>This estimate removes the bias due to the imbalanced baseline scores. Let’s use regression to generate stats:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>res_change1_group <span class="ot">&lt;-</span> <span class="fu">lm</span>(change1 <span class="sc">~</span> group, <span class="at">data =</span> dataMod2)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>tbl_change1_group <span class="ot">&lt;-</span> <span class="fu">tbl_regression</span>(res_change1_group, <span class="at">show_single_row =</span> group)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>tbl_change1_group</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="uflmfwnkvr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#uflmfwnkvr table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#uflmfwnkvr thead, #uflmfwnkvr tbody, #uflmfwnkvr tfoot, #uflmfwnkvr tr, #uflmfwnkvr td, #uflmfwnkvr th {
  border-style: none;
}

#uflmfwnkvr p {
  margin: 0;
  padding: 0;
}

#uflmfwnkvr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#uflmfwnkvr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#uflmfwnkvr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#uflmfwnkvr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#uflmfwnkvr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#uflmfwnkvr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uflmfwnkvr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#uflmfwnkvr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#uflmfwnkvr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#uflmfwnkvr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#uflmfwnkvr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#uflmfwnkvr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#uflmfwnkvr .gt_spanner_row {
  border-bottom-style: hidden;
}

#uflmfwnkvr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#uflmfwnkvr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#uflmfwnkvr .gt_from_md > :first-child {
  margin-top: 0;
}

#uflmfwnkvr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#uflmfwnkvr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#uflmfwnkvr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#uflmfwnkvr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#uflmfwnkvr .gt_row_group_first td {
  border-top-width: 2px;
}

#uflmfwnkvr .gt_row_group_first th {
  border-top-width: 2px;
}

#uflmfwnkvr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#uflmfwnkvr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#uflmfwnkvr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#uflmfwnkvr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uflmfwnkvr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#uflmfwnkvr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#uflmfwnkvr .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#uflmfwnkvr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#uflmfwnkvr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uflmfwnkvr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#uflmfwnkvr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#uflmfwnkvr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#uflmfwnkvr .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#uflmfwnkvr .gt_left {
  text-align: left;
}

#uflmfwnkvr .gt_center {
  text-align: center;
}

#uflmfwnkvr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#uflmfwnkvr .gt_font_normal {
  font-weight: normal;
}

#uflmfwnkvr .gt_font_bold {
  font-weight: bold;
}

#uflmfwnkvr .gt_font_italic {
  font-style: italic;
}

#uflmfwnkvr .gt_super {
  font-size: 65%;
}

#uflmfwnkvr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#uflmfwnkvr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#uflmfwnkvr .gt_indent_1 {
  text-indent: 5px;
}

#uflmfwnkvr .gt_indent_2 {
  text-indent: 10px;
}

#uflmfwnkvr .gt_indent_3 {
  text-indent: 15px;
}

#uflmfwnkvr .gt_indent_4 {
  text-indent: 20px;
}

#uflmfwnkvr .gt_indent_5 {
  text-indent: 25px;
}

#uflmfwnkvr .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#uflmfwnkvr div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Beta</strong></th>
<th id="conf.low" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">group</td>
<td class="gt_row gt_center" headers="estimate">9.7</td>
<td class="gt_row gt_center" headers="conf.low">8.5, 11</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
</tbody><tfoot class="gt_sourcenotes">
<tr class="even">
<td colspan="4" class="gt_sourcenote">Abbreviation: CI = Confidence Interval</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p>Here, we see that the means are statistically significantly different. Also, note the tighter confidence interval as compared to the estimates from analysis of the follow-up scores:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_stack</span>(</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    tbl_time1_po <span class="sc">|&gt;</span> <span class="fu">modify_table_body</span>(<span class="sc">~</span>.x <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">label =</span> <span class="st">"time1 (PO)"</span>)),</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    tbl_change1_po <span class="sc">|&gt;</span> <span class="fu">modify_table_body</span>(<span class="sc">~</span>.x <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">label =</span> <span class="st">"change1 (PO)"</span>)),</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    tbl_time1_group <span class="sc">|&gt;</span> <span class="fu">modify_table_body</span>(<span class="sc">~</span>.x <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">label =</span> <span class="st">"time1 (RCT)"</span>)),</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>      tbl_change1_group <span class="sc">|&gt;</span> <span class="fu">modify_table_body</span>(<span class="sc">~</span>.x <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">label =</span> <span class="st">"change1 (RCT)"</span>))</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_caption</span>(<span class="st">"**Treatment Effects Across Different Models and Estimators**"</span>) <span class="sc">|&gt;</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_footnote</span>(</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>    label <span class="sc">~</span> <span class="st">"PO = Potential Outcomes; RCT = Randomized Controlled Trial"</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_footnote</span>(</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>    estimate <span class="sc">~</span> <span class="st">"CI = Confidence Interval"</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_table_styling</span>(</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">everything</span>(),</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">rows =</span> label <span class="sc">==</span> <span class="st">"change1 (RCT)"</span>,  <span class="co"># Replace with your specific row label</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">text_format =</span> <span class="st">"bold"</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="zlnqnffqji" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#zlnqnffqji table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#zlnqnffqji thead, #zlnqnffqji tbody, #zlnqnffqji tfoot, #zlnqnffqji tr, #zlnqnffqji td, #zlnqnffqji th {
  border-style: none;
}

#zlnqnffqji p {
  margin: 0;
  padding: 0;
}

#zlnqnffqji .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#zlnqnffqji .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#zlnqnffqji .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#zlnqnffqji .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#zlnqnffqji .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zlnqnffqji .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zlnqnffqji .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zlnqnffqji .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#zlnqnffqji .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#zlnqnffqji .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#zlnqnffqji .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#zlnqnffqji .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#zlnqnffqji .gt_spanner_row {
  border-bottom-style: hidden;
}

#zlnqnffqji .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#zlnqnffqji .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#zlnqnffqji .gt_from_md > :first-child {
  margin-top: 0;
}

#zlnqnffqji .gt_from_md > :last-child {
  margin-bottom: 0;
}

#zlnqnffqji .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#zlnqnffqji .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#zlnqnffqji .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#zlnqnffqji .gt_row_group_first td {
  border-top-width: 2px;
}

#zlnqnffqji .gt_row_group_first th {
  border-top-width: 2px;
}

#zlnqnffqji .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zlnqnffqji .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#zlnqnffqji .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#zlnqnffqji .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zlnqnffqji .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zlnqnffqji .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#zlnqnffqji .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#zlnqnffqji .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#zlnqnffqji .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zlnqnffqji .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zlnqnffqji .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zlnqnffqji .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zlnqnffqji .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zlnqnffqji .gt_left {
  text-align: left;
}

#zlnqnffqji .gt_center {
  text-align: center;
}

#zlnqnffqji .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#zlnqnffqji .gt_font_normal {
  font-weight: normal;
}

#zlnqnffqji .gt_font_bold {
  font-weight: bold;
}

#zlnqnffqji .gt_font_italic {
  font-style: italic;
}

#zlnqnffqji .gt_super {
  font-size: 65%;
}

#zlnqnffqji .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#zlnqnffqji .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#zlnqnffqji .gt_indent_1 {
  text-indent: 5px;
}

#zlnqnffqji .gt_indent_2 {
  text-indent: 10px;
}

#zlnqnffqji .gt_indent_3 {
  text-indent: 15px;
}

#zlnqnffqji .gt_indent_4 {
  text-indent: 20px;
}

#zlnqnffqji .gt_indent_5 {
  text-indent: 25px;
}

#zlnqnffqji .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#zlnqnffqji div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <caption><span data-qmd-base64="KipUcmVhdG1lbnQgRWZmZWN0cyBBY3Jvc3MgRGlmZmVyZW50IE1vZGVscyBhbmQgRXN0aW1hdG9ycyoq"><span class="gt_from_md"><strong>Treatment Effects Across Different Models and Estimators</strong></span></span></caption>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="label"><span data-qmd-base64="KipDaGFyYWN0ZXJpc3RpYyoq"><span class="gt_from_md"><strong>Characteristic</strong></span></span><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="estimate"><span data-qmd-base64="KipCZXRhKio="><span class="gt_from_md"><strong>Beta</strong></span></span><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="conf.low"><span data-qmd-base64="Kio5NSUgQ0kqKg=="><span class="gt_from_md"><strong>95% CI</strong></span></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="p.value"><span data-qmd-base64="KipwLXZhbHVlKio="><span class="gt_from_md"><strong>p-value</strong></span></span></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">time1 (PO)</td>
<td headers="estimate" class="gt_row gt_center">9.7</td>
<td headers="conf.low" class="gt_row gt_center">9.0, 10</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">change1 (PO)</td>
<td headers="estimate" class="gt_row gt_center">9.7</td>
<td headers="conf.low" class="gt_row gt_center">9.0, 10</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">time1 (RCT)</td>
<td headers="estimate" class="gt_row gt_center">11</td>
<td headers="conf.low" class="gt_row gt_center">7.8, 14</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left" style="font-weight: bold;">change1 (RCT)</td>
<td headers="estimate" class="gt_row gt_center" style="font-weight: bold;">9.7</td>
<td headers="conf.low" class="gt_row gt_center" style="font-weight: bold;">8.5, 11</td>
<td headers="p.value" class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td></tr>
  </tbody>
  <tfoot class="gt_sourcenotes">
    <tr>
      <td class="gt_sourcenote" colspan="4"><span data-qmd-base64="QWJicmV2aWF0aW9uOiBDSSA9IENvbmZpZGVuY2UgSW50ZXJ2YWw="><span class="gt_from_md">Abbreviation: CI = Confidence Interval</span></span></td>
    </tr>
  </tfoot>
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="4"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> <span data-qmd-base64="UE8gPSBQb3RlbnRpYWwgT3V0Y29tZXM7IFJDVCA9IFJhbmRvbWl6ZWQgQ29udHJvbGxlZCBUcmlhbA=="><span class="gt_from_md">PO = Potential Outcomes; RCT = Randomized Controlled Trial</span></span></td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="4"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span> <span data-qmd-base64="Q0kgPSBDb25maWRlbmNlIEludGVydmFs"><span class="gt_from_md">CI = Confidence Interval</span></span></td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
<p>As we have seen, if the baseline values are imbalanced, the effect estimate of the difference in means of <code>time2</code> will be biased. This is why many analysts recommend estimating the mean differences in follow-up scores or change scores using analysis of covariance (ANCOVA) where the outcome is regressed on the treatment and adjusted for the baseline. This corresponds to the estimands presented earlier: <a href="#eq-CTE-fu" class="quarto-xref">Equation&nbsp;3</a> and <a href="#eq-CTE-cs" class="quarto-xref">Equation&nbsp;4</a>.</p>
<p>Let’s do this for the follow-up score, <code>time1</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>res_time1_ANCOVA <span class="ot">&lt;-</span> <span class="fu">lm</span>(time1 <span class="sc">~</span> group <span class="sc">+</span> baseline, <span class="at">data =</span> dataMod2)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>tbl_time1_ANCOVA <span class="ot">&lt;-</span> <span class="fu">tbl_regression</span>(res_time1_ANCOVA,</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">show_single_row =</span> <span class="fu">c</span>(<span class="st">"group"</span>),</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">include =</span> <span class="st">"group"</span>)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>tbl_time1_ANCOVA</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="zeeqzibyvo" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#zeeqzibyvo table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#zeeqzibyvo thead, #zeeqzibyvo tbody, #zeeqzibyvo tfoot, #zeeqzibyvo tr, #zeeqzibyvo td, #zeeqzibyvo th {
  border-style: none;
}

#zeeqzibyvo p {
  margin: 0;
  padding: 0;
}

#zeeqzibyvo .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#zeeqzibyvo .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#zeeqzibyvo .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#zeeqzibyvo .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#zeeqzibyvo .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zeeqzibyvo .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zeeqzibyvo .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zeeqzibyvo .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#zeeqzibyvo .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#zeeqzibyvo .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#zeeqzibyvo .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#zeeqzibyvo .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#zeeqzibyvo .gt_spanner_row {
  border-bottom-style: hidden;
}

#zeeqzibyvo .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#zeeqzibyvo .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#zeeqzibyvo .gt_from_md > :first-child {
  margin-top: 0;
}

#zeeqzibyvo .gt_from_md > :last-child {
  margin-bottom: 0;
}

#zeeqzibyvo .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#zeeqzibyvo .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#zeeqzibyvo .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#zeeqzibyvo .gt_row_group_first td {
  border-top-width: 2px;
}

#zeeqzibyvo .gt_row_group_first th {
  border-top-width: 2px;
}

#zeeqzibyvo .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zeeqzibyvo .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#zeeqzibyvo .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#zeeqzibyvo .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zeeqzibyvo .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zeeqzibyvo .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#zeeqzibyvo .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#zeeqzibyvo .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#zeeqzibyvo .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zeeqzibyvo .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zeeqzibyvo .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zeeqzibyvo .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zeeqzibyvo .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zeeqzibyvo .gt_left {
  text-align: left;
}

#zeeqzibyvo .gt_center {
  text-align: center;
}

#zeeqzibyvo .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#zeeqzibyvo .gt_font_normal {
  font-weight: normal;
}

#zeeqzibyvo .gt_font_bold {
  font-weight: bold;
}

#zeeqzibyvo .gt_font_italic {
  font-style: italic;
}

#zeeqzibyvo .gt_super {
  font-size: 65%;
}

#zeeqzibyvo .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#zeeqzibyvo .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#zeeqzibyvo .gt_indent_1 {
  text-indent: 5px;
}

#zeeqzibyvo .gt_indent_2 {
  text-indent: 10px;
}

#zeeqzibyvo .gt_indent_3 {
  text-indent: 15px;
}

#zeeqzibyvo .gt_indent_4 {
  text-indent: 20px;
}

#zeeqzibyvo .gt_indent_5 {
  text-indent: 25px;
}

#zeeqzibyvo .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#zeeqzibyvo div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Beta</strong></th>
<th id="conf.low" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">group</td>
<td class="gt_row gt_center" headers="estimate">9.6</td>
<td class="gt_row gt_center" headers="conf.low">8.4, 11</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
</tbody><tfoot class="gt_sourcenotes">
<tr class="even">
<td colspan="4" class="gt_sourcenote">Abbreviation: CI = Confidence Interval</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p>Using ANCOVA on the follow-up scores produces the same estimate as the change scores analysis. In other words, ANCOVA provides an unbiased estimate of the effect.</p>
<p>Now lets try ANCOVA on the change score:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>res_change1_ANCOVA <span class="ot">&lt;-</span> <span class="fu">lm</span>(change1 <span class="sc">~</span> group <span class="sc">+</span> baseline, <span class="at">data =</span> dataMod2)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>tbl_change1_ANCOVA <span class="ot">&lt;-</span> <span class="fu">tbl_regression</span>(res_change1_ANCOVA, <span class="at">show_single_row =</span> <span class="fu">c</span>(<span class="st">"group"</span>), <span class="at">include =</span> <span class="st">"group"</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>tbl_change1_ANCOVA</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="yqqhkvkmha" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#yqqhkvkmha table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#yqqhkvkmha thead, #yqqhkvkmha tbody, #yqqhkvkmha tfoot, #yqqhkvkmha tr, #yqqhkvkmha td, #yqqhkvkmha th {
  border-style: none;
}

#yqqhkvkmha p {
  margin: 0;
  padding: 0;
}

#yqqhkvkmha .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#yqqhkvkmha .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#yqqhkvkmha .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#yqqhkvkmha .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#yqqhkvkmha .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yqqhkvkmha .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yqqhkvkmha .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yqqhkvkmha .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#yqqhkvkmha .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#yqqhkvkmha .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#yqqhkvkmha .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#yqqhkvkmha .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#yqqhkvkmha .gt_spanner_row {
  border-bottom-style: hidden;
}

#yqqhkvkmha .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#yqqhkvkmha .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#yqqhkvkmha .gt_from_md > :first-child {
  margin-top: 0;
}

#yqqhkvkmha .gt_from_md > :last-child {
  margin-bottom: 0;
}

#yqqhkvkmha .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#yqqhkvkmha .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#yqqhkvkmha .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#yqqhkvkmha .gt_row_group_first td {
  border-top-width: 2px;
}

#yqqhkvkmha .gt_row_group_first th {
  border-top-width: 2px;
}

#yqqhkvkmha .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yqqhkvkmha .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#yqqhkvkmha .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#yqqhkvkmha .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yqqhkvkmha .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yqqhkvkmha .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#yqqhkvkmha .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#yqqhkvkmha .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#yqqhkvkmha .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yqqhkvkmha .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yqqhkvkmha .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yqqhkvkmha .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yqqhkvkmha .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yqqhkvkmha .gt_left {
  text-align: left;
}

#yqqhkvkmha .gt_center {
  text-align: center;
}

#yqqhkvkmha .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#yqqhkvkmha .gt_font_normal {
  font-weight: normal;
}

#yqqhkvkmha .gt_font_bold {
  font-weight: bold;
}

#yqqhkvkmha .gt_font_italic {
  font-style: italic;
}

#yqqhkvkmha .gt_super {
  font-size: 65%;
}

#yqqhkvkmha .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#yqqhkvkmha .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#yqqhkvkmha .gt_indent_1 {
  text-indent: 5px;
}

#yqqhkvkmha .gt_indent_2 {
  text-indent: 10px;
}

#yqqhkvkmha .gt_indent_3 {
  text-indent: 15px;
}

#yqqhkvkmha .gt_indent_4 {
  text-indent: 20px;
}

#yqqhkvkmha .gt_indent_5 {
  text-indent: 25px;
}

#yqqhkvkmha .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#yqqhkvkmha div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Beta</strong></th>
<th id="conf.low" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">group</td>
<td class="gt_row gt_center" headers="estimate">9.6</td>
<td class="gt_row gt_center" headers="conf.low">8.4, 11</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
</tbody><tfoot class="gt_sourcenotes">
<tr class="even">
<td colspan="4" class="gt_sourcenote">Abbreviation: CI = Confidence Interval</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p>Here, there is little change from the marginal (non-ANCOVA) effect estimate.</p>
<p>Let’s look at the two new results in the context of our prior analyses:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_stack</span>(</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    tbl_time1_po <span class="sc">|&gt;</span> <span class="fu">modify_table_body</span>(<span class="sc">~</span>.x <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">label =</span> <span class="st">"time1 (PO)"</span>)),</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    tbl_change1_po <span class="sc">|&gt;</span> <span class="fu">modify_table_body</span>(<span class="sc">~</span>.x <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">label =</span> <span class="st">"change1 (PO)"</span>)),</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    tbl_time1_group <span class="sc">|&gt;</span> <span class="fu">modify_table_body</span>(<span class="sc">~</span>.x <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">label =</span> <span class="st">"time1 (RCT)"</span>)),</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    tbl_change1_group <span class="sc">|&gt;</span> <span class="fu">modify_table_body</span>(<span class="sc">~</span>.x <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">label =</span> <span class="st">"change1 (RCT)"</span>)),</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>    tbl_time1_ANCOVA <span class="sc">|&gt;</span> <span class="fu">modify_table_body</span>(<span class="sc">~</span>.x <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">label =</span> <span class="st">"time1 (RCT ANCOVA)"</span>)),</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>        tbl_change1_ANCOVA <span class="sc">|&gt;</span> <span class="fu">modify_table_body</span>(<span class="sc">~</span>.x <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">label =</span> <span class="st">"change1 (RCT ANCOVA)"</span>))</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_caption</span>(<span class="st">"**Treatment Effects Across Different Models and Estimators**"</span>) <span class="sc">|&gt;</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_footnote</span>(</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>    label <span class="sc">~</span> <span class="st">"PO = Potential Outcomes; RCT = Randomized Controlled Trial"</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_footnote</span>(</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>    estimate <span class="sc">~</span> <span class="st">"CI = Confidence Interval"</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_table_styling</span>(</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">everything</span>(),</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">rows =</span> label <span class="sc">==</span> <span class="fu">c</span>(<span class="st">"time1 (RCT ANCOVA)"</span>, <span class="st">"change1 (RCT ANCOVA)"</span>),</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">text_format =</span> <span class="st">"bold"</span></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="mrqefhtywh" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#mrqefhtywh table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#mrqefhtywh thead, #mrqefhtywh tbody, #mrqefhtywh tfoot, #mrqefhtywh tr, #mrqefhtywh td, #mrqefhtywh th {
  border-style: none;
}

#mrqefhtywh p {
  margin: 0;
  padding: 0;
}

#mrqefhtywh .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mrqefhtywh .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#mrqefhtywh .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mrqefhtywh .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mrqefhtywh .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mrqefhtywh .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mrqefhtywh .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mrqefhtywh .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mrqefhtywh .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mrqefhtywh .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mrqefhtywh .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mrqefhtywh .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mrqefhtywh .gt_spanner_row {
  border-bottom-style: hidden;
}

#mrqefhtywh .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#mrqefhtywh .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#mrqefhtywh .gt_from_md > :first-child {
  margin-top: 0;
}

#mrqefhtywh .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mrqefhtywh .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#mrqefhtywh .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#mrqefhtywh .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mrqefhtywh .gt_row_group_first td {
  border-top-width: 2px;
}

#mrqefhtywh .gt_row_group_first th {
  border-top-width: 2px;
}

#mrqefhtywh .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mrqefhtywh .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#mrqefhtywh .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mrqefhtywh .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mrqefhtywh .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mrqefhtywh .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#mrqefhtywh .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#mrqefhtywh .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#mrqefhtywh .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mrqefhtywh .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mrqefhtywh .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mrqefhtywh .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mrqefhtywh .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mrqefhtywh .gt_left {
  text-align: left;
}

#mrqefhtywh .gt_center {
  text-align: center;
}

#mrqefhtywh .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mrqefhtywh .gt_font_normal {
  font-weight: normal;
}

#mrqefhtywh .gt_font_bold {
  font-weight: bold;
}

#mrqefhtywh .gt_font_italic {
  font-style: italic;
}

#mrqefhtywh .gt_super {
  font-size: 65%;
}

#mrqefhtywh .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#mrqefhtywh .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mrqefhtywh .gt_indent_1 {
  text-indent: 5px;
}

#mrqefhtywh .gt_indent_2 {
  text-indent: 10px;
}

#mrqefhtywh .gt_indent_3 {
  text-indent: 15px;
}

#mrqefhtywh .gt_indent_4 {
  text-indent: 20px;
}

#mrqefhtywh .gt_indent_5 {
  text-indent: 25px;
}

#mrqefhtywh .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#mrqefhtywh div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <caption><span data-qmd-base64="KipUcmVhdG1lbnQgRWZmZWN0cyBBY3Jvc3MgRGlmZmVyZW50IE1vZGVscyBhbmQgRXN0aW1hdG9ycyoq"><span class="gt_from_md"><strong>Treatment Effects Across Different Models and Estimators</strong></span></span></caption>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="label"><span data-qmd-base64="KipDaGFyYWN0ZXJpc3RpYyoq"><span class="gt_from_md"><strong>Characteristic</strong></span></span><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="estimate"><span data-qmd-base64="KipCZXRhKio="><span class="gt_from_md"><strong>Beta</strong></span></span><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="conf.low"><span data-qmd-base64="Kio5NSUgQ0kqKg=="><span class="gt_from_md"><strong>95% CI</strong></span></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="p.value"><span data-qmd-base64="KipwLXZhbHVlKio="><span class="gt_from_md"><strong>p-value</strong></span></span></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">time1 (PO)</td>
<td headers="estimate" class="gt_row gt_center">9.7</td>
<td headers="conf.low" class="gt_row gt_center">9.0, 10</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">change1 (PO)</td>
<td headers="estimate" class="gt_row gt_center">9.7</td>
<td headers="conf.low" class="gt_row gt_center">9.0, 10</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">time1 (RCT)</td>
<td headers="estimate" class="gt_row gt_center">11</td>
<td headers="conf.low" class="gt_row gt_center">7.8, 14</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">change1 (RCT)</td>
<td headers="estimate" class="gt_row gt_center">9.7</td>
<td headers="conf.low" class="gt_row gt_center">8.5, 11</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left" style="font-weight: bold;">time1 (RCT ANCOVA)</td>
<td headers="estimate" class="gt_row gt_center" style="font-weight: bold;">9.6</td>
<td headers="conf.low" class="gt_row gt_center" style="font-weight: bold;">8.4, 11</td>
<td headers="p.value" class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left" style="font-weight: bold;">change1 (RCT ANCOVA)</td>
<td headers="estimate" class="gt_row gt_center" style="font-weight: bold;">9.6</td>
<td headers="conf.low" class="gt_row gt_center" style="font-weight: bold;">8.4, 11</td>
<td headers="p.value" class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td></tr>
  </tbody>
  <tfoot class="gt_sourcenotes">
    <tr>
      <td class="gt_sourcenote" colspan="4"><span data-qmd-base64="QWJicmV2aWF0aW9uOiBDSSA9IENvbmZpZGVuY2UgSW50ZXJ2YWw="><span class="gt_from_md">Abbreviation: CI = Confidence Interval</span></span></td>
    </tr>
  </tfoot>
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="4"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> <span data-qmd-base64="UE8gPSBQb3RlbnRpYWwgT3V0Y29tZXM7IFJDVCA9IFJhbmRvbWl6ZWQgQ29udHJvbGxlZCBUcmlhbA=="><span class="gt_from_md">PO = Potential Outcomes; RCT = Randomized Controlled Trial</span></span></td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="4"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span> <span data-qmd-base64="Q0kgPSBDb25maWRlbmNlIEludGVydmFs"><span class="gt_from_md">CI = Confidence Interval</span></span></td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
<p>Here we see that the analysis of change scores using either the marginal effect of <code>group</code> on <code>change1</code> or ANCOVA recovers an unbiased estimate similar to marginal effect of <code>change1 (RCT)</code>. When analyzing follow-up scores, the marginal effect of <code>group</code> on <code>time1</code> (<code>time1 (RCT)</code> is biased and has a wide confidence interval, but ANCOVA eliminates the bias and produces a confidence interval equivalent to the the change score analyses.</p>
<p>Recall that with the noise in our data and the small sample size, the potential outcomes analysis (<code>time1 (PO)</code> and <code>change1 (PO)</code>) provide the gold standard estimate of the true effect, which in this model is 10.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Causal DAG Theory and Adjustment
</div>
</div>
<div class="callout-body-container callout-body">
<p>According to Causal DAG theory, since there is no backdoor path from <code>baseline</code> to <code>time1</code> we do not need to adjust for <code>baseline</code> in order to estimate the direct effect of <code>group</code> on <code>time1</code>; however, as we have seen above, the unadjusted analysis produces a biased estimate. This difference is due to the use of adjustment for two separate purposes:</p>
<ol type="1">
<li>To block confounding paths in causal DAGs; and</li>
<li>To improve precision and remove finite sample bias when estimating effects.</li>
</ol>
<p>Since baseline is not a confounder and there are no other confounders in the causal DAG for our data generating model, by causal DAG theory baseline does not need to be adjusted for. However, adjusting for baseline provides a more efficient estimator of the direct effect, because it reduces residual variance and eliminates bias from chance baseline imbalance.</p>
<p>Since the treatment group happened to have higher baseline values, and baseline positively predicts follow-up scores:</p>
<ul>
<li><p><strong>ANCOVA estimate</strong>: 10 (correctly isolates the direct treatment path)</p></li>
<li><p><strong>Marginal estimate</strong>: 10 + (baseline imbalance × baseline-to-followup path coefficient) &gt; 10</p></li>
</ul>
</div>
</div>
<section id="summary" class="level3">
<h3 class="anchored" data-anchor-id="summary">Summary</h3>
<p>Thus far we have seen that there are several nuances to analyzing change from baseline, even with an RCT. We also saw that ANCOVA provided the best estimate when analyzing both follow-up scores and change scores.</p>
<p>Now we turn to an RCT with loss to follow-up</p>
</section>
</section>
<section id="model-3-rct-additive-effect-differential-loss-to-follow-up." class="level2">
<h2 class="anchored" data-anchor-id="model-3-rct-additive-effect-differential-loss-to-follow-up.">Model 3: RCT, Additive Effect, Differential Loss to Follow-Up.</h2>
<p>To be finished.</p>
<p>Model 3 uses the RCT data, but censors patients based on their baseline score and which treatment group they are in. Patients with lower baseline scores and those in the control group are more likely to drop out.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Copy dataMod2</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>dataMod3 <span class="ot">&lt;-</span> dataMod2</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate censoring probabilities</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Logit model for censoring</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>baseline_prob <span class="ot">&lt;-</span> .<span class="dv">3</span> <span class="co"># 30% baseline chance of censoring</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate logit for baseline_prob</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>baseline_logit <span class="ot">&lt;-</span> baseline_logit <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="fl">0.3</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.3</span>))</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>logit_censoring <span class="ot">&lt;-</span> baseline_logit <span class="sc">+</span> </span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>                   <span class="sc">-</span><span class="fl">0.01</span> <span class="sc">*</span> dataMod3<span class="sc">$</span>baseline <span class="sc">+</span>    <span class="co"># patients with higher baseline scores less likely to drop out</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>                   <span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">as.numeric</span>(dataMod3<span class="sc">$</span>group)      <span class="co"># Treatment group less likely to drop out</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to probability</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>p_censored <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>logit_censoring))</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate censoring indicator (1 = censored/dropped out, 0 = observed)</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>censored <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, p_censored)</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply censoring to the data (set values to NA)</span></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>dataMod3<span class="sc">$</span>time1[censored <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>dataMod3<span class="sc">$</span>censored <span class="ot">&lt;-</span> censored</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>dataMod3<span class="sc">$</span>p_censored <span class="ot">&lt;-</span> p_censored</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- ```{r} -->
<!-- # Load required libraries -->
<!-- library(ggplot2) -->
<!-- library(plotly) -->
<!-- mean_baseline = mean(data$baseline) -->
<!-- # Calculate predictions at mean baseline for each group -->
<!-- pred1 <- predict(res, newdata = data.frame(group = levels(data$group)[1], baseline = mean_baseline)) -->
<!-- pred2 <- predict(res, newdata = data.frame(group = levels(data$group)[2], baseline = mean_baseline)) -->
<!-- # Create the plot -->
<!-- p <- ggplot(data, aes(x = baseline, y = time2, color = group)) + -->
<!--   # Add points -->
<!--   geom_point(alpha = 0.6, size = 2) + -->
<!--   # Add regression lines for each group -->
<!--   geom_smooth(method = "lm", se = TRUE, alpha = 0.2) + -->
<!--   # Add vertical line at mean baseline -->
<!--   geom_vline(xintercept = mean_baseline, linetype = "dashed", color = "black", size = 0.8) + -->
<!--   # Add points for the endpoints of the vertical line (these will be invisible) -->
<!--   geom_point(aes(x = mean_baseline, y = pred1,  -->
<!--                 text = paste("Group:", levels(data$group)[1],  -->
<!--                            "<br>Baseline:", round(mean_baseline, 2), -->
<!--                            "<br>Predicted Time2:", round(pred1, 2))), -->
<!--              color = "red", size = 3, alpha = 0.8, inherit.aes = FALSE) + -->
<!--   geom_point(aes(x = mean_baseline, y = pred2, -->
<!--                 text = paste("Group:", levels(data$group)[2],  -->
<!--                            "<br>Baseline:", round(mean_baseline, 2), -->
<!--                            "<br>Predicted Time2:", round(pred2, 2))), -->
<!--              color = "red", size = 3, alpha = 0.8, inherit.aes = FALSE) + -->
<!--   # Add the vertical line showing difference between groups at mean baseline -->
<!--   geom_segment( -->
<!--     x = mean_baseline,  -->
<!--     xend = mean_baseline, -->
<!--     y = pred1, -->
<!--     yend = pred2, -->
<!--     color = "red",  -->
<!--     size = 2, -->
<!--     arrow = arrow(ends = "both", angle = 90, length = unit(0.1, "inches")) -->
<!--   ) + -->
<!--   # Customize the plot -->
<!--   labs( -->
<!--     title = "Time2 vs Baseline by Group", -->
<!--     subtitle = paste("Vertical line shows difference between groups at mean baseline (",  -->
<!--                     round(mean_baseline, 2), ")", sep = ""), -->
<!--     x = "Baseline", -->
<!--     y = "Time2", -->
<!--     color = "Group" -->
<!--   ) + -->
<!--   # Clean theme -->
<!--   theme_minimal() + -->
<!--   theme( -->
<!--     plot.title = element_text(size = 14, face = "bold"), -->
<!--     plot.subtitle = element_text(size = 11, color = "gray40"), -->
<!--     legend.position = "bottom" -->
<!--   ) -->
<!-- # Convert to plotly for interactive tooltips -->
<!-- ggplotly(p, tooltip = "text") %>% -->
<!--   layout(title = list(text = "Time2 vs Baseline by Group<br><sub>Vertical line shows difference between groups at mean baseline</sub>")) -->
<!-- ``` -->
<!-- While there is only one measured covariate here (`baseline`) a covariate balance plot showing the standardized mean differences between covariates in the treated and untreated groups (treatment mean - control mean) will show whether there is covariate imbalance due to the small sample size. Even though we have an RCT, both covariates are skewed to the right. -->
<!-- ```{r} -->
<!-- # Set seed for reproducibility -->
<!-- set.seed(124) -->
<!-- # Simulate data for demonstration -->
<!-- # 150 participants, 2 groups (treatment and control) -->
<!-- n <- 150 group <- rep(c(0, 1), each = n/2) # 0 = control, 1 = treatment -->
<!-- # Generate baseline scores (similar for both groups) -->
<!-- baseline \<- rnorm(n, mean = 50, sd = 10) -->
<!-- # Generate follow-up scores with additive effects -->
<!-- additive_effect \<- 10 \# improvement of +10 to time1 for treatment group -->
<!-- # Calculate potential outcomes -->
<!-- # 0: control -->
<!-- # 1: treatment -->
<!-- time1_x0 \<- baseline + 0*additive_effect + rnorm(n, mean = 0, sd = 3) time1_x1 \<- baseline + 1*additive_effect + rnorm(n, mean = 0, sd = 3) -->
<!-- change1_x0 \<- time1_x0 - baseline change1_x1 \<- time1_x1 - baseline -->
<!-- # Set the observed time1 based on treatment (group) assignment -->
<!-- time1 \<- ifelse(group == 0, time1_x0, time1_x1) -->
<!-- # Calculate observed change score -->
<!-- change1 \<- time1 - baseline -->
<!-- # Create data frame -->
<!-- dataMod1 \<- data.frame( id = 1:n, group = factor(group, labels = c("Control", "Treatment")), baseline = baseline, time1 = time1, change1 = change1, time1_x0 = time1_x0, time1_x1 = time1_x1, change1_x0 = change1_x0, change1_x1 = change1_x1 ) -->
<!-- dataMod1 -->
<!-- ``` -->
<!-- And here is the Canonical Table 2. This shows a significant difference between `time2` for the treatment and control groups, along with the differences in the potential outcomes under treatment and control. -->
<!-- ```{r} -->
<!-- table2 <- dataMod1 |> -->
<!--   select(-id) |> -->
<!--   tbl_summary(by = group) |> -->
<!--   add_p() |> -->
<!--   bold_labels() -->
<!-- table2 -->
<!-- ``` -->
<!-- There is some controversy over how to measure total effect of a treatment on change from baseline. If the baseline values of the treatment and control group are balanced, then an unbiased average treatment effect is just the mean of `time2` for those in the treatment group minus the mean for those in the control group. In an RCT with sufficient sample size, the baselines are expected to be balanced. Let's check our data: -->
<!-- ```{r} -->
<!-- data %>% group_by(group) %>% summarize(meanBaseline = mean(baseline)) -->
<!-- ``` -->
<!-- With the relatively small sample size, the baseline means are close, but not perfectly balanced. This could bias our effect estimate if we simply use the difference in means of `time2` between Treatment and Control. The means of `time2` for the Control and Treatment groups are: -->
<!-- ```{r} -->
<!-- means <- data %>% group_by(group) %>% summarize(mean = mean(time2)) -->
<!-- means -->
<!-- ``` -->
<!-- Subtracting these to get the average treatment effect is: -->
<!-- ```{r} -->
<!-- filter(means, group=="Treatment")$mean - filter(means, group=="Control")$mean -->
<!-- ``` -->
<!-- We can also do a t-test to test for difference in means for `time2` between the treatment and control groups: -->
<!-- ```{r} -->
<!-- t.test(time2 ~ group, data = data) -->
<!-- ``` -->
<!-- Here, we see that the means are statistically significantly different. -->
<!-- If the baseline values are unbalanced, the effect estimate of the difference in means of `time2` will be biased. This is why many analysts recommend always using analysis of covariance (ANCOVA) where the outcome is regressed on the treatment and adjusted for the baseline value: -->
<!-- ```{r} -->
<!-- res <- lm(time2 ~ group + baseline, data = data) -->
<!-- summary(res) -->
<!-- ``` -->
<!-- Here we see that the causal effect of `group` on `time2` when adjusted for baseline is `coef(res)["group"]`. Note above that the baseline means between treatment and control differ by around .5, which explains the difference between the effect as computed on the difference in the mean of `time2` between groups, vs. the regression results. -->
<!-- We can use gtsummary for a nicer view of the results: -->
<!-- ```{r} -->
<!-- tbl_regression(res, estimate_fun = purrr::partial(style_ratio, digits = 2)) -->
<!-- ``` -->
<!-- Interpretation: After adjusting for baseline differences, mean `time2` increased by \`res\$ units for those receiving the treatment compared with those who did not receive the treatment. We can see this here: -->
<!-- ```{r} -->
<!-- # Load required libraries -->
<!-- library(ggplot2) -->
<!-- library(plotly) -->
<!-- mean_baseline = mean(data$baseline) -->
<!-- # Calculate predictions at mean baseline for each group -->
<!-- pred1 <- predict(res, newdata = data.frame(group = levels(data$group)[1], baseline = mean_baseline)) -->
<!-- pred2 <- predict(res, newdata = data.frame(group = levels(data$group)[2], baseline = mean_baseline)) -->
<!-- # Create the plot -->
<!-- p <- ggplot(data, aes(x = baseline, y = time2, color = group)) + -->
<!--   # Add points -->
<!--   geom_point(alpha = 0.6, size = 2) + -->
<!--   # Add regression lines for each group -->
<!--   geom_smooth(method = "lm", se = TRUE, alpha = 0.2) + -->
<!--   # Add vertical line at mean baseline -->
<!--   geom_vline(xintercept = mean_baseline, linetype = "dashed", color = "black", size = 0.8) + -->
<!--   # Add points for the endpoints of the vertical line (these will be invisible) -->
<!--   geom_point(aes(x = mean_baseline, y = pred1,  -->
<!--                 text = paste("Group:", levels(data$group)[1],  -->
<!--                            "<br>Baseline:", round(mean_baseline, 2), -->
<!--                            "<br>Predicted Time2:", round(pred1, 2))), -->
<!--              color = "red", size = 3, alpha = 0.8, inherit.aes = FALSE) + -->
<!--   geom_point(aes(x = mean_baseline, y = pred2, -->
<!--                 text = paste("Group:", levels(data$group)[2],  -->
<!--                            "<br>Baseline:", round(mean_baseline, 2), -->
<!--                            "<br>Predicted Time2:", round(pred2, 2))), -->
<!--              color = "red", size = 3, alpha = 0.8, inherit.aes = FALSE) + -->
<!--   # Add the vertical line showing difference between groups at mean baseline -->
<!--   geom_segment( -->
<!--     x = mean_baseline,  -->
<!--     xend = mean_baseline, -->
<!--     y = pred1, -->
<!--     yend = pred2, -->
<!--     color = "red",  -->
<!--     size = 2, -->
<!--     arrow = arrow(ends = "both", angle = 90, length = unit(0.1, "inches")) -->
<!--   ) + -->
<!--   # Customize the plot -->
<!--   labs( -->
<!--     title = "Time2 vs Baseline by Group", -->
<!--     subtitle = paste("Vertical line shows difference between groups at mean baseline (",  -->
<!--                     round(mean_baseline, 2), ")", sep = ""), -->
<!--     x = "Baseline", -->
<!--     y = "Time2", -->
<!--     color = "Group" -->
<!--   ) + -->
<!--   # Clean theme -->
<!--   theme_minimal() + -->
<!--   theme( -->
<!--     plot.title = element_text(size = 14, face = "bold"), -->
<!--     plot.subtitle = element_text(size = 11, color = "gray40"), -->
<!--     legend.position = "bottom" -->
<!--   ) -->
<!-- # Convert to plotly for interactive tooltips -->
<!-- ggplotly(p, tooltip = "text") %>% -->
<!--   layout(title = list(text = "Time2 vs Baseline by Group<br><sub>Vertical line shows difference between groups at mean baseline</sub>")) -->
<!-- ``` -->
<!-- Recall that the treatment effect in this model is proportional to the baseline value and increased by `severity`, a latent variable. The average treatment effect reported in the analysis above is the average across all baseline values in the model. \## Randomized Controlled Trial With No Loss to Follow-Up -->
<!-- In this simulation: -->
<!-- \- `severity` is a latent (unobserved) variable that affects: -->
<!-- a)  Baseline scores (sicker patients have lower scores) -->
<!-- b)  Treatment effect (treatment works better for sicker patients) -->
<!-- Note that in this model severity is not affected by treatment or time. It is set at baseline for each patient and remains the same for each time period. -->
<!-- The Causal DAG for this data generating model is shown below. -->
<!-- ```{r, fig.width = 12, fig.height = 8} -->
<!-- # Create the DAG using dagify -->
<!-- dagRCT <- dagify( -->
<!--   baseline ~ severity, -->
<!--   time1 ~ baseline + group + severity, -->
<!--   change1 ~ baseline + time1, -->
<!--   time2 ~ group + time1 + severity, -->
<!--   change2 ~ baseline + time2, -->
<!--   exposure = "group", -->
<!--   outcome = "time2", -->
<!--   coords = data.frame( -->
<!--     name = c("baseline", "severity", "group", "time1", "change1", "time2", "change2"), -->
<!--     x = c(0, 0, 4, 3, 1.5, 5.5, 4), -->
<!--     y = c(1, 2, 2, 1, 0, 1, 0) -->
<!--   ) -->
<!-- ) -->
<!-- # Change status of severity to indicate that it is a latent variable -->
<!-- latents(dagRCT) = "severity" -->
<!-- # Convert the dagitty graph to a ggdag group for prettier printing -->
<!-- tidy_dagRCT <- tidy_dagitty(dagRCT)  -->
<!-- # Plot with custom node shapes -->
<!-- # Get the status (exposure, outcome) information and set variables without a status to "observed" -->
<!-- status_data <- ggdag_status(tidy_dagRCT)$data %>% mutate(status = ifelse(is.na(status), "observed", as.character(status))) -->
<!-- #status_data <- status_data %>% mutate(gstatus = as.character(status), gstatus = ifelse(name == "censored", "adjusted", as.character(status)),  -->
<!-- #                                      gstatus = factor(gstatus,levels = c(levels(status), "adjusted"))) -->
<!-- # Plot with custom node shapes while preserving status coloring -->
<!-- ggplot(status_data, aes(x = x, y = y, xend = xend, yend = yend)) + -->
<!--   geom_dag_edges(arrow_directed = grid::arrow(length = unit(0.5, "cm"), type = "closed")) + -->
<!--   geom_dag_point(aes(color = status), size = 24) + -->
<!--   geom_dag_text(color = "white") + -->
<!--   scale_shape_manual(values = c(circle = 16, square = 15), guide = "none") + -->
<!--   scale_color_discrete(name = "Status", na.value = "grey50") + -->
<!--   theme_dag() + -->
<!--   theme(legend.position = "right") -->
<!-- ``` -->
<!-- Now let's simulate data for the RCT. This simulates and retains the potential outcomes Y0_time1, Y1_time1, Y0_time2 and Y1_time2 for all patients, then sets time1 and time2 for a patient based on that patient's assigned treatment in the data. This means that we can calculate the true causal effect from the potential outcomes. -->
<!-- ```{r} -->
<!-- # Set seed for reproducibility -->
<!-- set.seed(124) -->
<!-- # Simulate data for demonstration -->
<!-- # 150 participants, 2 groups (treatment and control) -->
<!-- n <- 150 -->
<!-- group <- rep(c(0, 1), each = n/2)  # 0 = control, 1 = treatment -->
<!-- # Generate baseline scores (similar for both groups) -->
<!-- baseline <- rnorm(n, mean = 50, sd = 10) -->
<!-- # Add a latent "severity" variable that affects baseline score -->
<!-- severity <- rnorm(n, mean = 0, sd = 1) -->
<!-- # Adjust baseline by severity (sicker patients have lower baseline scores) -->
<!-- baseline <- baseline - 5 * severity -->
<!-- # Generate follow-up scores with proportional effects -->
<!-- prop_effect1 <- 0.20  # 20% improvement at time1 for treatment group -->
<!-- prop_effect2 <- 0.15  # Additional 15% improvement at time2 for treatment group -->
<!-- # Calculate potential outcomes -->
<!-- # True effect is proportional to baseline -->
<!-- # The treatment also has a stronger effect for patients with higher severity -->
<!-- Y0_time1 <- baseline + rnorm(n, mean = 0, sd = 3) -->
<!-- Y1_time1 <- baseline * (1 + prop_effect1 + 0.1 * severity) + rnorm(n, mean = 0, sd = 3) -->
<!-- Y0_time2 <- Y0_time1 + rnorm(n, mean = 0, sd = 3) -->
<!-- Y1_time2 <- Y1_time1 * (1 + prop_effect1 + 0.1 * severity) + rnorm(n, mean = 0, sd = 3) -->
<!-- # Calculate time1 values - true effect is proportional to baseline -->
<!-- # The treatment also has a stronger effect for patients with higher severity -->
<!-- # time1 <- vector("numeric", n) -->
<!-- # for (i in 1:n) { -->
<!-- #   if (group[i] == 1) { -->
<!-- #     # Treatment group: effect is proportional to baseline and increased by severity -->
<!-- #     effect_modifier <- 1 + prop_effect1 + 0.1 * severity[i] -->
<!-- #     time1[i] <- baseline[i] * effect_modifier + rnorm(1, mean = 0, sd = 3) -->
<!-- #   } else { -->
<!-- #     # Control group: small random change -->
<!-- #     time1[i] <- baseline[i] + rnorm(1, mean = 0, sd = 3) -->
<!-- #   } -->
<!-- # } -->
<!-- # time2 <- vector("numeric", n) -->
<!-- # for (i in 1:n) { -->
<!-- #   if (group[i] == 1) { -->
<!-- #     # Treatment group: additional effect proportional to time1 -->
<!-- #     effect_modifier <- 1 + prop_effect2 + 0.05 * severity[i] -->
<!-- #     time2[i] <- time1[i] * effect_modifier + rnorm(1, mean = 0, sd = 3) -->
<!-- #   } else { -->
<!-- #     # Control group: small random change -->
<!-- #     time2[i] <- time1[i] + rnorm(1, mean = 0, sd = 3) -->
<!-- #   } -->
<!-- # } -->
<!-- # Set the observed time1 and time2 based on treatment (group)  assignment -->
<!-- time1 <- ifelse(group == 0, Y0_time1, Y1_time1) -->
<!-- time2 <- ifelse(group == 0, Y0_time2, Y1_time2) -->
<!-- # Create data frame -->
<!-- data <- data.frame( -->
<!--   id = 1:n, -->
<!--   group = factor(group, labels = c("Control", "Treatment")), -->
<!--   baseline = baseline, -->
<!--   time1 = time1, -->
<!--   time2 = time2, -->
<!--   Y0_time1 = Y0_time1, -->
<!--   Y1_time1 = Y1_time1, -->
<!--   Y0_time2 = Y0_time2, -->
<!--   Y1_time2 = Y1_time2, -->
<!--   severity = severity  # Include the latent severity variable -->
<!-- ) -->
<!-- # Create change scores for the full dataset -->
<!-- data$change1 <- data$time1 - data$baseline -->
<!-- data$change2 <- data$time2 - data$baseline -->
<!-- data -->
<!-- ``` -->
<!-- For publication ready tables, we can use gtsummary. Here is the cannonical Table 1: -->
<!-- ```{r} -->
<!-- library(gtsummary) -->
<!-- table1 <- data |> tbl_summary() -->
<!-- table1 -->
<!-- ``` -->
<!-- And here is the Canonical Table 2. This shows a significant difference between `time2` for the treatment and control groups. -->
<!-- ```{r} -->
<!-- table2 <- tbl_summary(data, by = group) |> add_p() |> bold_labels() -->
<!-- table2 -->
<!-- ``` -->
<!-- With all the potential outcomes we can calculate the Average Treatment Effect of the treatment on time2 as: -->
<!-- ```{r} -->
<!-- mean(data$Y1_time2) - mean(data$Y0_time2) -->
<!-- ``` -->
<!-- This is just the mean of the raw individual treatment effects: -->
<!-- ```{r} -->
<!-- mean(data$Y1_time2 - data$Y0_time2) -->
<!-- ``` -->
<!-- This value is not adjusted for the baseline value of each patient. -->
<!-- We can also compute the difference in change scores between the treated and untreated, which is the causal estimand showing the effect of treatment, $X$, on change in score $Y$, where $Y_1^x$ is the potential outcome of $Y_1$ the follow-up score when $X$ is set to $x$ and $Y_1^{x'}$ is the potential outcome of ... -->
<!-- $$ -->
<!-- \mathrm{E}(Y_1^x - Y_0^x) - \mathrm{E}(Y_1^{x'} - Y_0^{x'}) -->
<!-- $$ -->
<!-- When we have both potential outcomes for the populations, this is identical to the equations above, because the baselines cancel out across the two means below. In @eq-changescore -->
<!-- ```{r} -->
<!-- mean(data$Y1_time2 - data$baseline) - mean(data$Y0_time2 - data$baseline) -->
<!-- ``` -->
<!-- While there is only one measured covariate here (`baseline`) a covariate balance plot showing the standardized mean differences between covariates in the treated and untreated groups (treatment mean - control mean) will show whether there is covariate imbalance due to the small sample size. Here, we include the latent variable `severity`. Even though we have an RCT, both covariates are skewed to the right. -->
<!-- ```{r} -->
<!-- library(cobalt) -->
<!-- unadjcov <- bal.tab(group ~ baseline, data = dataMod2, thresholds = c(m = .1)) -->
<!-- love.plot(unadjcov, stars = "std", thresholds = c(m = .1)) -->
<!-- ``` -->
<!-- Recall that the treatment effect in this model is proportional to the baseline value and increased by `severity`, a latent variable. The average treatment effect reported in the analysis above is the average across all baseline values in the model. -->
<!-- ## Simulate proportional treatment effect on change from baseline in an RCT with censoring -->
<!-- For data with censoring and proportional treatment effects: -->
<!-- This simulation is identical to the one above, but with some subjects dropping out of the study prior to time2 being measured. Changes noted in bold. -->
<!-- \- `severity` is latent variable that affects: -->
<!-- a)  Baseline scores (sicker patients have lower scores) -->
<!-- b)  Treatment effect (treatment works better for sicker patients) -->
<!-- c)  **Censoring probability (sicker patients more likely to drop out)** -->
<!-- \- **Treatment group participants are less likely to be censored** -->
<!-- **- Participants with less improvement are more likely to be censored** -->
<!-- The Causal DAG for this data generating model is shown below. -->
<!-- ```{r, fig.width = 12, fig.height = 8} -->
<!-- library(dagitty) -->
<!-- library(ggdag) -->
<!-- library(tidyverse) -->
<!-- # Create the DAG using dagify -->
<!-- dag1 <- dagify( -->
<!--   baseline ~ severity, -->
<!--   time1 ~ baseline + group + severity, -->
<!--   change1 ~ baseline + time1, -->
<!--   censored ~ change1 + group + severity, -->
<!--   time2 ~ group + time1 + severity, -->
<!--   exposure = "group", -->
<!--   outcome = "time2", -->
<!--   coords = data.frame( -->
<!--     name = c("baseline", "severity", "group", "time1", "change1", "censored", "time2"), -->
<!--     x = c(0, 0, 4, 3, 1.5, 8, 5.5), -->
<!--     y = c(1, 2, 2, 1, 0, 1, 1) -->
<!--   ) -->
<!-- ) -->
<!-- # Indicate that `censored` is adjusted since we only have data for patients who are not censored, censored is forced to equal 0 -->
<!-- adjustedNodes(dag1) <- "censored" -->
<!-- plot(dag1) -->
<!-- #List all paths from treatment `group` to outcome `time2` -->
<!-- # `paths` currently ignores the adjusted nodes when determining which paths are open, so we have to specify adjusted nodes in the call -->
<!-- paths(dag1, Z = adjustedNodes(dag1)) -->
<!-- # Print the adjustment sets (if any) -->
<!-- adjustmentSets(dag1) -->
<!-- tidy_dag1 <- tidy_dagitty(dag1) %>% mutate(shape = ifelse(name == "censored", "square", "circle")) -->
<!-- # Indicate that `censored` is adjusted for in this model -->
<!-- tidy_dag1 <- adjust_for(tidy_dag1, "censored") -->
<!-- # Plot with custom node shapes -->
<!-- # Get the status (exposure, outcome) information -->
<!-- status_data <- ggdag_status(tidy_dag1)$data -->
<!-- status_data <- status_data %>% mutate(gstatus = as.character(status), gstatus = ifelse(name == "censored", "adjusted", as.character(status)),  -->
<!--                                       gstatus = factor(gstatus,levels = c(levels(status), "adjusted"))) -->
<!-- # Plot with custom node shapes while preserving status coloring -->
<!-- ggplot(status_data, aes(x = x, y = y, xend = xend, yend = yend)) + -->
<!--   geom_dag_edges(arrow_directed = grid::arrow(length = unit(0.5, "cm"), type = "closed")) + -->
<!--   geom_dag_point(aes(color = gstatus, shape = shape), size = 24) + -->
<!--   geom_dag_text(color = "white") + -->
<!--   scale_shape_manual(values = c(circle = 16, square = 15), guide = "none") + -->
<!--   scale_color_discrete(name = "Status", na.value = "grey50") + -->
<!--   theme_dag() + -->
<!--   theme(legend.position = "right") -->
<!-- ``` -->
<!-- The `censored` variable is shown with a square around it to indicate that by analyzing only uncensored patients, `censored` is adjusted for in the analysis. Since all arrows point into `censored`, any path from treatment `group` to effect `time2` that includes `censored` will transmit spurious association through `censored` unless the path is blocked at another point. -->
<!-- To see this, lets look at all paths (causal and non-causal) from `group` to `time2`. A causal path is one in which arrows point from the treatment `group` to the outcome `time2`. Noncausal paths are those with at least one arrow pointing back toward the treatment. -->
<!-- ```{r} -->
<!-- # `paths` currently ignores the adjusted nodes when determining which paths are open, so we have to specify the adjusted nodes in the call -->
<!-- paths(dag1, Z = adjustedNodes(dag1)) -->
<!-- ``` -->
<!-- We see that there are 18 paths from `group` to `time2`. \$open is a boolean list showing whether each path is open or closed. All of these paths are open and since many of these paths are noncausal "backdoor" paths, meaning the arrows do not all point from `group` to `time2` this means that if we measure the association between `group` and `time2` in the data, that association is likely to exhibit bias from confounding. For example, paths 1 through 11 are all backdoor paths that go through `censored`. A collider is a variable on a path in which both arrows point toward it. As you can see, `censored` is a collider on every path it appears in. Colliders block association when they are not adjusted, but allow association to flow and bias the analysis when they are adjusted. -->
<!-- To properly measure the total causal effect of `group` on `time2` we need to measure the association that flows through all paths that point from `group` to `time2`. Let's use `paths` to list only the causal paths: -->
<!-- ```{r} -->
<!-- paths(dag1, Z = adjustedNodes(dag1), directed = TRUE) -->
<!-- ``` -->
<!-- There are two causal paths, both open. To measure the total causal effect, we need to block the non-causal open paths by adjusting for variables, if possible. We can use `ggdag` to list the adjustment sets for the total causal effect of `group` on `time2`. This returns nothing because there is no way to adjust variables to block the open path caused through the collider `censored.` -->
<!-- ```{r} -->
<!-- adjustmentSets(dag1, effect = "total") -->
<!-- ``` -->
<!-- We will use IP Weighting for censoring below, but before that, lets analyze this dataset as if there were no loss to follow-up. -->
<!-- # Same model with no loss to follow-up -->
<!-- The same data generating model above includes time2_all with outcome values for all patients. Without Censoring the Causal DAG for time2_all looks like this: -->
<!-- ```{r, fig.height=8, fig.width=10} -->
<!-- library(dagitty) -->
<!-- library(ggdag) -->
<!-- library(tidyverse) -->
<!-- # Create the DAG using dagitify -->
<!-- dag_noloss <- dagify( -->
<!--   baseline ~ severity, -->
<!--   time1 ~ baseline + group + severity, -->
<!--   change1 ~ baseline + time1, -->
<!--   time2_all ~ group + time1 + severity, -->
<!--   exposure = "group", -->
<!--   outcome = "time2_all", -->
<!--   coords = data.frame( -->
<!--     name = c("baseline", "severity", "group", "time1", "change1", "censored", "time2_all"), -->
<!--     x = c(0, 0, 4, 3, 1.5, 8, 5.5), -->
<!--     y = c(1, 2, 2, 1, 0, 1, 1) -->
<!--   ) -->
<!-- ) -->
<!-- tidy_dag_noloss <- tidy_dagitty(dag_noloss) -->
<!-- # Plot with custom node shapes -->
<!-- # Get the status (exposure, outcome) information -->
<!-- status_data <- ggdag_status(tidy_dag_noloss)$data -->
<!-- status_data <- status_data %>% mutate(gstatus = as.character(status), gstatus = ifelse(name == "censored", "adjusted", as.character(status)),  -->
<!--                                       gstatus = factor(gstatus,levels = c(levels(status), "adjusted"))) -->
<!-- # Plot with custom node shapes while preserving status coloring -->
<!-- ggplot(status_data, aes(x = x, y = y, xend = xend, yend = yend)) + -->
<!--   geom_dag_edges(arrow_directed = grid::arrow(length = unit(0.5, "cm"), type = "closed")) + -->
<!--   geom_dag_point(aes(color = gstatus), size = 24) + -->
<!--   geom_dag_text(color = "white") + -->
<!--   scale_shape_manual(values = c(circle = 16, square = 15), guide = "none") + -->
<!--   scale_color_discrete(name = "Status", na.value = "grey50") + -->
<!--   theme_dag() + -->
<!--   theme(legend.position = "right") -->
<!-- ``` -->
<!-- ```{r, eval = FALSE} -->
<!-- # Load required libraries -->
<!-- library(dagitty) -->
<!-- library(ggdag) -->
<!-- library(dplyr) -->
<!-- library(ggplot2) -->
<!-- # Define the DAG -->
<!-- dag1 <- dagitty('dag { -->
<!-- bb="0,0,1,1" -->
<!-- baseline [pos="0.348,0.542"] -->
<!-- censored [adjusted,pos="0.931,0.499"] -->
<!-- change1 [pos="0.477,0.641"] -->
<!-- group [exposure,pos="0.343,0.368"] -->
<!-- severity [pos="0.348,0.449"] -->
<!-- time1 [pos="0.486,0.540"] -->
<!-- time2 [outcome,pos="0.605,0.539"] -->
<!-- baseline -> change1 -->
<!-- baseline -> time1 -->
<!-- change1 -> censored -->
<!-- group -> censored -->
<!-- group -> time1 -->
<!-- group -> time2 -->
<!-- severity -> baseline -->
<!-- severity -> censored -->
<!-- severity -> time1 -->
<!-- severity -> time2 -->
<!-- time1 -> change1 -->
<!-- time1 -> time2 -->
<!-- }' -->
<!-- ) -->
<!-- plot(dag1) -->
<!-- ``` -->
<!-- ## Generate Data According to the Two Causal DAGs Above -->
<!-- ```{r} -->
<!-- # Install and load required packages -->
<!-- # Uncomment to install packages if needed -->
<!-- # install.packages(c("lavaan", "semPlot", "tidyverse", "psych")) -->
<!-- library(lavaan) -->
<!-- library(semPlot) -->
<!-- library(tidyverse) -->
<!-- library(psych) -->
<!-- # Set seed for reproducibility -->
<!-- set.seed(123) -->
<!-- # Simulate data for demonstration -->
<!-- # 150 participants, 2 groups (treatment and control) -->
<!-- n <- 150 -->
<!-- group <- rep(c(0, 1), each = n/2)  # 0 = control, 1 = treatment -->
<!-- # Generate baseline scores (similar for both groups) -->
<!-- baseline <- rnorm(n, mean = 50, sd = 10) -->
<!-- # Add a latent "severity" variable that affects both baseline and censoring -->
<!-- # This creates the missing not at random (MNAR) scenario -->
<!-- severity <- rnorm(n, mean = 0, sd = 1) -->
<!-- # Adjust baseline by severity (sicker patients have lower baseline scores) -->
<!-- baseline <- baseline - 5 * severity -->
<!-- # Generate follow-up scores with proportional effects -->
<!-- prop_effect1 <- 0.20  # 20% improvement at time1 for treatment group -->
<!-- prop_effect2 <- 0.15  # Additional 15% improvement at time2 for treatment group -->
<!-- # Calculate time1 values - true effect is proportional to baseline -->
<!-- # The treatment also has a stronger effect for patients with higher severity -->
<!-- time1 <- vector("numeric", n) -->
<!-- for (i in 1:n) { -->
<!--   if (group[i] == 1) { -->
<!--     # Treatment group: effect is proportional to baseline and increased by severity -->
<!--     effect_modifier <- 1 + prop_effect1 + 0.1 * severity[i] -->
<!--     time1[i] <- baseline[i] * effect_modifier + rnorm(1, mean = 0, sd = 3) -->
<!--   } else { -->
<!--     # Control group: small random change -->
<!--     time1[i] <- baseline[i] + rnorm(1, mean = 0, sd = 3) -->
<!--   } -->
<!-- } -->
<!-- # Calculate time2 values -->
<!-- time2 <- vector("numeric", n) -->
<!-- for (i in 1:n) { -->
<!--   if (group[i] == 1) { -->
<!--     # Treatment group: additional effect proportional to time1 -->
<!--     effect_modifier <- 1 + prop_effect2 + 0.05 * severity[i] -->
<!--     time2[i] <- time1[i] * effect_modifier + rnorm(1, mean = 0, sd = 3) -->
<!--   } else { -->
<!--     # Control group: small random change -->
<!--     time2[i] <- time1[i] + rnorm(1, mean = 0, sd = 3) -->
<!--   } -->
<!-- } -->
<!-- # Save time2 values prior to censoring to create a model without censoring -->
<!-- time2_all <- time2 -->
<!-- # Generate censoring indicators -->
<!-- # Higher probability of censoring (dropout) for: -->
<!-- # 1. Sicker patients (higher severity) -->
<!-- # 2. Control group participants (treatment has benefit that keeps people engaged) -->
<!-- # 3. Those with smaller improvements from baseline to time1 -->
<!-- # Calculate change from baseline to time1 -->
<!-- change_time1 <- time1 - baseline -->
<!-- # Calculate censoring probabilities -->
<!-- # Logit model for censoring -->
<!-- logit_censoring <- -2 +  -->
<!--                    1.5 * severity +                # Sicker patients more likely to drop out -->
<!--                    -0.5 * group +                 # Treatment group less likely to drop out -->
<!--                    -0.05 * change_time1           # Those improving less likely to drop out -->
<!-- # Convert to probability -->
<!-- p_censored <- 1 / (1 + exp(-logit_censoring)) -->
<!-- # Generate censoring indicator (1 = censored/dropped out, 0 = observed) -->
<!-- censored <- rbinom(n, 1, p_censored) -->
<!-- # Apply censoring to the data (set values to NA) -->
<!-- time2[censored == 1] <- NA -->
<!-- # Create data frame -->
<!-- data <- data.frame( -->
<!--   id = 1:n, -->
<!--   group = factor(group, labels = c("Control", "Treatment")), -->
<!--   baseline = baseline, -->
<!--   time1 = time1, -->
<!--   time2 = time2, -->
<!--   time2_all = time2_all, -->
<!--   severity = severity,  # Include the latent severity variable -->
<!--   censored = censored    # Include the censoring indicator -->
<!-- ) -->
<!-- # Create change scores for the full dataset -->
<!-- data$change1 <- data$time1 - data$baseline -->
<!-- data$change2 <- data$time2 - data$baseline -->
<!-- data -->
<!-- ``` -->
<!-- # Analyze Ideal Dataset with no Loss to Follow-Up -->
<!-- Let's analyze this dataset using the difference in group means: -->
<!-- ```{r} -->
<!-- group_means <- data %>% group_by(group) %>% summarize(mean(time2_all)) -->
<!-- group_means -->
<!-- ``` -->
<!-- The average treatment effect when there is no loss to follow-up is and we do not adjust for baseline, we see: -->
<!-- ```{r} -->
<!-- group_means %>% deframe %>% .[["Treatment"]] - group_means %>% deframe %>% .[["Control"]] -->
<!-- ``` -->
<!-- Using ANCOVA we get: -->
<!-- ```{r} -->
<!-- ideal <- glm(time2_all ~ baseline + group, data = data) -->
<!-- summary(ideal) -->
<!-- ``` -->
<!-- The effect estimate here is 17.65, which is higher than the difference in group means of 16.38. -->
<!-- When there is loss to follow-up, the näive approach to estimating the average treatment effect is to ignore patients who were censored, which means removing them from the data. The average treatment effect is then the mean outcome (time2) of the treated group minus the mean outcome (time2) of the untreated in the remaining patients. Here we return to using time2, which has missing values for censored patients. -->
<!-- ```{r} -->
<!-- group_means_uncensored <- data %>% filter(censored == 0) %>% group_by(group) %>% summarize(mean(time2)) -->
<!-- group_means_uncensored -->
<!-- ``` -->
<!-- Ignoring censored patients underestimates the treatment effect, because patients who have higher baseline values have higher treatment effects, but are also more likely to drop out (be lost to follow-up): -->
<!-- ```{r} -->
<!-- group_means_uncensored %>% deframe %>% .[["Treatment"]] - group_means_uncensored %>% deframe %>% .[["Control"]] -->
<!-- ``` -->
<!-- We can also use logistic regression to do the same näive analysis, using the ANCOVA approach of adjusting for baseline. -->
<!-- ```{r} -->
<!-- model_naive <- lm(time2 ~ group + baseline, -->
<!--                    data = subset(data, !is.na(time2))) -->
<!-- model_naive -->
<!-- ``` -->
<!-- This result is closer to the true result of 17.65 -->
<!-- One appropriate way to analyze an RCT with censored patients is by using IP (Inverse Probability) weighting to adjust the data for the probability of remaining in the study. This creates a pseudo-population where the outcome for patients who were uncensored gets weighted by their inverse probability of staying in the study as calculated using baseline covariates. -->
<!-- To do this, we first use logistic regression to create a model that predicts whether a patient will be censored based on group (the treatment) and baseline HBA1C. -->
<!-- ```{r} -->
<!-- # Model for censoring process - modeling factors affecting dropout -->
<!-- model_censoring <- glm(censored ~ group + baseline + time1,  -->
<!--                       data = data, -->
<!--                       family = binomial(link = "logit")) -->
<!-- summary(model_censoring) -->
<!-- ``` -->
<!-- The model for censoring is consistent with the data generating process in which there is a Higher probability of censoring (dropout) for: -->
<!-- 1.  Sicker patients (higher severity) -->
<!-- 2.  Control group participants (treatment has benefit that keeps people engaged) -->
<!-- 3.  Those with smaller improvements from baseline to time1 -->
<!-- Now we can predict the probability of remaining in the study (not being censored) by using the regression results on each patient in the study and calculating 1 - p(censored) Look at the probability of remaining in the study to convince yourself that the model is producing appropriate results. For example, patients in the treatment group are more likely to remain in the study, as expected. -->
<!-- ```{r} -->
<!-- data$p_observed <- 1 - predict(model_censoring, type = "response") -->
<!-- data -->
<!-- ``` -->
<!-- We can compare covariates based on treatment group. Notice that those in the control group are more likely to be censored and therefore have a lower probability of being observed at time2: -->
<!-- ```{r} -->
<!-- table2 <- tbl_summary(data, by = group) |> add_p() |> bold_labels() -->
<!-- table2 -->
<!-- ``` -->
<!-- Now we add the IP weights to the data -->
<!-- ```{r} -->
<!-- # Create weights as inverse of probability of being observed -->
<!-- data$ipw <- 1 / data$p_observed -->
<!-- ``` -->
<!-- Finally, we can do a second regression with the IP weights to estimate the average treatment effect: -->
<!-- ```{r} -->
<!-- # Weighted analysis -->
<!-- model_ipw <- glm(time2 ~ group + baseline,  -->
<!--                 data = subset(data, !is.na(time2)), -->
<!--                 weights = ipw) -->
<!-- summary(model_ipw) -->
<!-- ``` -->
<!-- FInally we use this model and G-Computation to create the counterfactuals (the outcomes when treated and untreaded) for all patients. -->
<!-- To do this, we copy the dataset, set all patients to the Treatment group, then use the model to predict time2_1. Then we do the same for the control to create time2_0. The difference in means give us the effect. -->
<!-- ```{r} -->
<!-- # Copy dataset -->
<!-- datap <- data -->
<!-- # Set all patients to Treatment -->
<!-- datap <- datap %>% mutate(group = "Treatment") -->
<!-- # Predict and store time2_1 -->
<!-- time2_1 <- predict(model_ipw, newdata = datap, type = "response") -->
<!-- # Set all patients to Control -->
<!-- datap <- datap %>% mutate(group = "Control") -->
<!-- # Predict time2_0 (for control) -->
<!-- time2_0 <- predict(model_ipw, newdata = datap, type = "response") -->
<!-- # Find the difference in means -->
<!-- mean(time2_1) - mean(time2_0) -->
<!-- ``` -->
<!-- This estimand does not adjust the outcome for baseline scores. -->
<!-- # Analyzing Censored Dataset -->
<!-- ```{r} -->
<!-- # Create interaction term for the model - do this BEFORE creating the uncensored subset -->
<!-- data$group_numeric <- as.numeric(data$group) - 1  # Convert to 0/1 -->
<!-- data$baseline_by_group <- data$baseline * data$group_numeric -->
<!-- # Create uncensored subset - AFTER creating all derived variables -->
<!-- data_uncensored <- subset(data, censored == 0) -->
<!-- print(paste("Number of censored observations:", sum(data$censored))) -->
<!-- print(paste("Proportion of censored observations:", mean(data$censored))) -->
<!-- # Basic visualization - compare baseline by censoring status -->
<!-- ggplot(data, aes(x = factor(censored), y = baseline, fill = group)) + -->
<!--   geom_boxplot() + -->
<!--   ggtitle("Baseline Scores by Group and Censoring Status") + -->
<!--   xlab("Censored (1 = yes, 0 = no)") + -->
<!--   ylab("Baseline Score") -->
<!-- # Create change scores -->
<!-- data$change1 <- data$time1 - data$baseline -->
<!-- data$change2 <- data$time2 - data$baseline -->
<!-- # Longitudinal plot with censoring indicated -->
<!-- data_long <- data %>% -->
<!--   pivot_longer(cols = c(baseline, time1, time2), -->
<!--                names_to = "time", -->
<!--                values_to = "score") %>% -->
<!--   mutate(time = factor(time, levels = c("baseline", "time1", "time2"), -->
<!--                       labels = c("Baseline", "Time 1", "Time 2"))) -->
<!-- # Add transparency based on censoring (censored data points are more transparent) -->
<!-- ggplot(data_long, aes(x = time, y = score, group = interaction(id, group),  -->
<!--                       color = group, alpha = factor(censored))) + -->
<!--   geom_line() + -->
<!--   scale_alpha_manual(values = c("0" = 1, "1" = 0.2), name = "Censored") + -->
<!--   stat_summary(data = subset(data_long, !(time == "Time 2" & is.na(score))), -->
<!--                aes(group = group), fun = mean, geom = "line", size = 1.5) + -->
<!--   stat_summary(data = subset(data_long, !(time == "Time 2" & is.na(score))), -->
<!--                aes(group = group), fun = mean, geom = "point", size = 3) + -->
<!--   theme_minimal() + -->
<!--   ggtitle("Change in Scores Over Time by Group (with Censoring)") + -->
<!--   ylab("Score") + -->
<!--   xlab("Measurement Time") -->
<!-- # Define SEM model for uncensored data -->
<!-- # We need a separate model because the censoring variable has no variance in the uncensored subset -->
<!-- model_uncens <- ' -->
<!--   # Latent variable for true change -->
<!--   change =~ change1 + change2 -->
<!--   # Regression paths: group, baseline, and severity predict change -->
<!--   # Group represents treatment effect -->
<!--   # Baseline represents the proportional nature of the effect -->
<!--   # Severity represents the hidden confounding variable -->
<!--   change ~ group + baseline + severity -->
<!--   # Allow residual correlation between time points -->
<!--   change1 ~~ change2 -->
<!-- ' -->
<!-- # Fit the model using only uncensored data (creates bias) -->
<!-- fit_uncens <- sem(model_uncens, data = data_uncensored) -->
<!-- summary(fit_uncens, fit.measures = TRUE, standardized = TRUE) -->
<!-- # Model that ignores severity (misspecified) -->
<!-- model_misspec <- ' -->
<!--   # Latent variable for true change -->
<!--   change =~ change1 + change2 -->
<!--   # Regression paths: only group and baseline predict change -->
<!--   # Missing the severity variable (creates omitted variable bias) -->
<!--   change ~ group + baseline -->
<!--   # Allow residual correlation between time points -->
<!--   change1 ~~ change2 -->
<!-- ' -->
<!-- # Fit the misspecified model with all data using FIML -->
<!-- fit_misspec <- sem(model_misspec, data = data, missing = "fiml") -->
<!-- summary(fit_misspec, fit.measures = TRUE, standardized = TRUE) -->
<!-- # Fit the misspecified model with uncensored data only (double bias) -->
<!-- fit_misspec_uncens <- sem(model_misspec, data = data_uncensored) -->
<!-- summary(fit_misspec_uncens, fit.measures = TRUE, standardized = TRUE) -->
<!-- # Compare treatment effect estimates across models  -->
<!-- # We need to handle the case where some models may not have been successfully fit -->
<!-- treatmentEffect <- data.frame( -->
<!--   Model = character(), -->
<!--   Estimate = numeric(), -->
<!--   stringsAsFactors = FALSE -->
<!-- ) -->
<!-- # Extract treatment effect from model1  -->
<!-- if(exists("fit_cens")) { -->
<!--   idx <- which(parameterEstimates(fit_cens)$lhs == "change" &  -->
<!--                parameterEstimates(fit_cens)$rhs == "group") -->
<!--   if(length(idx) > 0) { -->
<!--     treatmentEffect <- rbind(treatmentEffect,  -->
<!--                           data.frame(Model = "Complete + Severity",  -->
<!--                                      Estimate = parameterEstimates(fit_cens)[idx, "est"])) -->
<!--   } -->
<!-- } -->
<!-- # Extract from model with uncensored data + severity -->
<!-- if(exists("fit_uncens")) { -->
<!--   idx <- which(parameterEstimates(fit_uncens)$lhs == "change" &  -->
<!--                parameterEstimates(fit_uncens)$rhs == "group") -->
<!--   if(length(idx) > 0) { -->
<!--     treatmentEffect <- rbind(treatmentEffect,  -->
<!--                           data.frame(Model = "Uncensored + Severity",  -->
<!--                                      Estimate = parameterEstimates(fit_uncens)[idx, "est"])) -->
<!--   } -->
<!-- } -->
<!-- # Extract from misspecified model -->
<!-- if(exists("fit_misspec")) { -->
<!--   idx <- which(parameterEstimates(fit_misspec)$lhs == "change" &  -->
<!--                parameterEstimates(fit_misspec)$rhs == "group") -->
<!--   if(length(idx) > 0) { -->
<!--     treatmentEffect <- rbind(treatmentEffect,  -->
<!--                           data.frame(Model = "Complete w/o Severity",  -->
<!--                                      Estimate = parameterEstimates(fit_misspec)[idx, "est"])) -->
<!--   } -->
<!-- } -->
<!-- # Extract from misspecified model with uncensored data -->
<!-- if(exists("fit_misspec_uncens")) { -->
<!--   idx <- which(parameterEstimates(fit_misspec_uncens)$lhs == "change" &  -->
<!--                parameterEstimates(fit_misspec_uncens)$rhs == "group") -->
<!--   if(length(idx) > 0) { -->
<!--     treatmentEffect <- rbind(treatmentEffect,  -->
<!--                           data.frame(Model = "Uncensored w/o Severity",  -->
<!--                                      Estimate = parameterEstimates(fit_misspec_uncens)[idx, "est"])) -->
<!--   } -->
<!-- } -->
<!-- # Print the comparison table -->
<!-- print("Treatment Effect Estimates Across Models:") -->
<!-- print(treatmentEffect) -->
<!-- # This comparison table shows the bias introduced by analyzing only uncensored participants -->
<!-- # and by omitting important confounding variables from the model -->
<!-- # Alternative model with latent variables for each time point -->
<!-- # For proportional effects, we need interaction terms -->
<!-- model2 <- ' -->
<!--   # Latent variables for each time point -->
<!--   baseline =~ 1*baseline -->
<!--   followup1 =~ 1*time1 -->
<!--   followup2 =~ 1*time2 -->
<!--   # Regression paths from baseline to follow-ups -->
<!--   followup1 ~ baseline -->
<!--   followup2 ~ baseline + followup1 -->
<!--   # Effect of treatment on follow-ups -->
<!--   # Direct effects of group -->
<!--   followup1 ~ group -->
<!--   followup2 ~ group -->
<!--   # Interaction effects (proportional effects) -->
<!--   # Create interaction term in the data first -->
<!-- ' -->
<!-- # Alternative model with latent variables and missing data handling -->
<!-- model2_cens <- ' -->
<!--   # Latent variables for each time point - avoid name collisions with observed variables -->
<!--   latent_baseline =~ 1*baseline -->
<!--   latent_followup1 =~ 1*time1 -->
<!--   latent_followup2 =~ 1*time2 -->
<!--   # Regression paths from baseline to follow-ups -->
<!--   latent_followup1 ~ latent_baseline -->
<!--   latent_followup2 ~ latent_baseline + latent_followup1 -->
<!--   # Effect of treatment on follow-ups -->
<!--   # Direct effects of group -->
<!--   latent_followup1 ~ group -->
<!--   latent_followup2 ~ group -->
<!--   # Severity affects outcomes -->
<!--   latent_baseline ~ severity -->
<!--   latent_followup1 ~ severity -->
<!--   latent_followup2 ~ severity -->
<!--   # Censoring is related to severity and treatment -->
<!--   censored ~ severity + group -->
<!--   # Interaction effects (proportional effects) -->
<!--   latent_followup1 ~ baseline_by_group -->
<!--   latent_followup2 ~ baseline_by_group -->
<!-- ' -->
<!-- # Create interaction term for the model if not already there -->
<!-- if(!"baseline_by_group" %in% names(data)) { -->
<!--   data$group_numeric <- as.numeric(data$group) - 1  # Convert to 0/1 -->
<!--   data$baseline_by_group <- data$baseline * data$group_numeric -->
<!-- } -->
<!-- # Fit the censoring-aware model with FIML -->
<!-- fit2_cens <- sem(model2_cens, data = data, missing = "fiml") -->
<!-- summary(fit2_cens, fit.measures = TRUE, standardized = TRUE) -->
<!-- # Visualize the censoring-aware model -->
<!-- semPaths(fit2_cens, what = "est", fade = FALSE, residuals = FALSE,  -->
<!--          edge.label.cex = 0.8,  -->
<!--          title = FALSE,  -->
<!--          layout = "tree2") -->
<!-- # Create a simplified version for uncensored data only -->
<!-- model2_simple <- ' -->
<!--   # Latent variables for each time point - avoid name collisions -->
<!--   latent_baseline =~ 1*baseline -->
<!--   latent_followup1 =~ 1*time1 -->
<!--   latent_followup2 =~ 1*time2 -->
<!--   # Regression paths from baseline to follow-ups -->
<!--   latent_followup1 ~ latent_baseline -->
<!--   latent_followup2 ~ latent_baseline + latent_followup1 -->
<!--   # Effect of treatment on follow-ups -->
<!--   # Direct effects of group -->
<!--   latent_followup1 ~ group -->
<!--   latent_followup2 ~ group -->
<!--   # Interaction effects (proportional effects) -->
<!--   latent_followup1 ~ baseline_by_group -->
<!--   latent_followup2 ~ baseline_by_group -->
<!-- ' -->
<!-- # Fit the simplified model with uncensored data only -->
<!-- # Check first that required variables exist in the dataset -->
<!-- print("Variables in data_uncensored:") -->
<!-- print(names(data_uncensored)) -->
<!-- # Verify that baseline_by_group exists in the dataset -->
<!-- if("baseline_by_group" %in% names(data_uncensored)) { -->
<!--   fit2_uncens <- sem(model2_simple, data = data_uncensored) -->
<!--   summary(fit2_uncens, fit.measures = TRUE, standardized = TRUE) -->
<!-- } else { -->
<!--   print("Error: baseline_by_group missing from data_uncensored") -->
<!--   # Create it again just to be sure -->
<!--   data_uncensored$group_numeric <- as.numeric(data_uncensored$group) - 1 -->
<!--   data_uncensored$baseline_by_group <- data_uncensored$baseline * data_uncensored$group_numeric -->
<!--   # Now try fitting the model -->
<!--   fit2_uncens <- sem(model2_simple, data = data_uncensored) -->
<!--   summary(fit2_uncens, fit.measures = TRUE, standardized = TRUE) -->
<!-- } -->
<!-- # Interpretation -->
<!-- # For data with censoring and proportional treatment effects: -->
<!-- #  -->
<!-- # In this simulation: -->
<!-- #  -->
<!-- # 1. SELECTION BIAS MECHANISM: -->
<!-- #    - We created a "severity" latent variable that affects: -->
<!-- #      a) Baseline scores (sicker patients have lower scores) -->
<!-- #      b) Treatment effect (treatment works better for sicker patients) -->
<!-- #      c) Censoring probability (sicker patients more likely to drop out) -->
<!-- #    - Treatment group participants are less likely to be censored -->
<!-- #    - Participants with less improvement are more likely to be censored -->
<!-- #  -->
<!-- # 2. BIAS IN THE TREATMENT EFFECT ESTIMATE: -->
<!-- #    - Complete model with severity included (fit_cens): Most accurate estimate -->
<!-- #    - Uncensored data with severity included (fit_uncens): Biased estimate -->
<!-- #      (typically underestimates treatment effect because sicker patients -->
<!-- #      who would benefit more are more likely to drop out) -->
<!-- #    - Models without severity (fit_misspec & fit_misspec_uncens): Biased due to -->
<!-- #      omitted variable bias (severity affects both censoring and outcomes) -->
<!-- #  -->
<!-- # 3. THE BIASES INTERACT: -->
<!-- #    - Selection bias: Analyzing only uncensored participants -->
<!-- #    - Omitted variable bias: Not including severity variable -->
<!-- #    - The combined effect typically leads to underestimating treatment efficacy -->
<!-- #  -->
<!-- # 4. PROPER HANDLING APPROACHES: -->
<!-- #    - Full Information Maximum Likelihood (FIML) for missing data -->
<!-- #    - Including all relevant confounders in the model -->
<!-- #    - Sensitivity analyses for different missing data mechanisms -->
<!-- #    - Inverse probability weighting to account for selection bias -->
<!-- #  -->
<!-- # The comparison of treatment effect estimates across models shows how much -->
<!-- # the estimated effect changes when using different approaches, demonstrating -->
<!-- # the magnitude of bias from censoring and model misspecification. -->
<!-- ``` -->
<!-- ```{r} -->
<!-- # GLM Analysis for Treatment Effect with Censoring -->
<!-- # Assuming the data has already been generated as in the previous code -->
<!-- # and variables are in the 'data' dataframe -->
<!-- # 1. Naive GLM analysis ignoring censoring -->
<!-- # This ignores the missing data problem and just analyzes what is observed -->
<!-- # Model for time2 outcome, complete cases only -->
<!-- model_naive <- glm(time2 ~ group + baseline,  -->
<!--                   data = subset(data, !is.na(time2)), -->
<!--                   family = gaussian()) -->
<!-- # Summary of naive model -->
<!-- summary(model_naive) -->
<!-- # 2. Model for change from baseline -->
<!-- # Calculate absolute change and use as outcome -->
<!-- data$abs_change <- data$time2 - data$baseline -->
<!-- model_change <- glm(abs_change ~ group + baseline,  -->
<!--                    data = subset(data, !is.na(time2)), -->
<!--                    family = gaussian()) -->
<!-- summary(model_change) -->
<!-- # 3. Model for proportional change -->
<!-- # Calculate proportional change and use as outcome -->
<!-- data$prop_change <- (data$time2 - data$baseline) / data$baseline -->
<!-- model_prop_change <- glm(prop_change ~ group + baseline,  -->
<!--                         data = subset(data, !is.na(time2)), -->
<!--                         family = gaussian()) -->
<!-- summary(model_prop_change) -->
<!-- # 4. Model that includes severity (the hidden confounder) -->
<!-- model_with_severity <- glm(time2 ~ group + baseline + severity,  -->
<!--                          data = subset(data, !is.na(time2)), -->
<!--                          family = gaussian()) -->
<!-- summary(model_with_severity) -->
<!-- # 5. Model for censoring process - modeling factors affecting dropout -->
<!-- model_censoring <- glm(censored ~ group + baseline + severity,  -->
<!--                       data = data, -->
<!--                       family = binomial(link = "logit")) -->
<!-- summary(model_censoring) -->
<!-- # 6. Inverse probability weighting to account for censoring -->
<!-- # First, predict probability of being observed (not censored) -->
<!-- data$p_observed <- 1 - predict(model_censoring, type = "response") -->
<!-- # Create weights as inverse of probability of being observed -->
<!-- data$ipw <- 1 / data$p_observed -->
<!-- # Weighted analysis -->
<!-- model_ipw <- glm(time2 ~ group + baseline,  -->
<!--                 data = subset(data, !is.na(time2)), -->
<!--                 family = gaussian(), -->
<!--                 weights = ipw) -->
<!-- summary(model_ipw) -->
<!-- # 7. Model with interaction between baseline and treatment -->
<!-- model_interaction <- glm(time2 ~ group * baseline + severity,  -->
<!--                        data = subset(data, !is.na(time2)), -->
<!--                        family = gaussian()) -->
<!-- summary(model_interaction) -->
<!-- # 8. Compare treatment effect estimates across different models -->
<!-- # Extract coefficients for the treatment effect (group) -->
<!-- treatment_effects <- data.frame( -->
<!--   Model = c( -->
<!--     "Naive (Complete Cases)", -->
<!--     "Change Score", -->
<!--     "Proportional Change", -->
<!--     "With Severity", -->
<!--     "IPW for Censoring", -->
<!--     "With Interaction" -->
<!--   ), -->
<!--   Estimate = c( -->
<!--     coef(model_naive)["groupTreatment"], -->
<!--     coef(model_change)["groupTreatment"], -->
<!--     coef(model_prop_change)["groupTreatment"], -->
<!--     coef(model_with_severity)["groupTreatment"], -->
<!--     coef(model_ipw)["groupTreatment"], -->
<!--     coef(model_interaction)["groupTreatment"] -->
<!--   ), -->
<!--   SE = c( -->
<!--     summary(model_naive)$coefficients["groupTreatment", "Std. Error"], -->
<!--     summary(model_change)$coefficients["groupTreatment", "Std. Error"], -->
<!--     summary(model_prop_change)$coefficients["groupTreatment", "Std. Error"], -->
<!--     summary(model_with_severity)$coefficients["groupTreatment", "Std. Error"], -->
<!--     summary(model_ipw)$coefficients["groupTreatment", "Std. Error"], -->
<!--     summary(model_interaction)$coefficients["groupTreatment", "Std. Error"] -->
<!--   ) -->
<!-- ) -->
<!-- treatment_effects$Lower_CI <- treatment_effects$Estimate - 1.96 * treatment_effects$SE -->
<!-- treatment_effects$Upper_CI <- treatment_effects$Estimate + 1.96 * treatment_effects$SE -->
<!-- # Print comparison table -->
<!-- print(treatment_effects) -->
<!-- # 9. Visualization of treatment effects across models -->
<!-- library(ggplot2) -->
<!-- ggplot(treatment_effects, aes(x = Model, y = Estimate)) + -->
<!--   geom_point(size = 3) + -->
<!--   geom_errorbar(aes(ymin = Lower_CI, ymax = Upper_CI), width = 0.2) + -->
<!--   coord_flip() + -->
<!--   theme_minimal() + -->
<!--   ggtitle("Treatment Effect Estimates Across Different GLM Models") + -->
<!--   ylab("Estimated Treatment Effect") + -->
<!--   xlab("") -->
<!-- # 10. Calculate marginal effects of treatment at different baseline values -->
<!-- # This shows how the treatment effect varies with baseline -->
<!-- # if(requireNamespace("margins", quietly = TRUE)) { -->
<!-- #   library(margins) -->
<!-- #    -->
<!-- #   # For the interaction model -->
<!-- #   marg_effects <- margins(model_interaction,  -->
<!-- #                          variables = "group", -->
<!-- #                          at = list(baseline = seq(min(data$baseline, na.rm = TRUE), -->
<!-- #                                                 max(data$baseline, na.rm = TRUE), -->
<!-- #                                                 length.out = 10))) -->
<!-- #    -->
<!-- #   summary(marg_effects) -->
<!-- #    -->
<!-- #   # Plot the marginal effects -->
<!-- #   plot(marg_effects) -->
<!-- # } else { -->
<!--   # Manual calculation of marginal effects at different baseline values -->
<!--   baseline_values <- seq(min(data$baseline, na.rm = TRUE), -->
<!--                         max(data$baseline, na.rm = TRUE), -->
<!--                         length.out = 10) -->
<!--   # Extract coefficients -->
<!--   b_group <- coef(model_interaction)["groupTreatment"] -->
<!--   b_interaction <- coef(model_interaction)["groupTreatment:baseline"] -->
<!--   # Calculate marginal effect at each baseline value -->
<!--   marginal_effects <- data.frame( -->
<!--     baseline = baseline_values, -->
<!--     effect = b_group + b_interaction * baseline_values -->
<!--   ) -->
<!--   # Plot the marginal effects -->
<!--   ggplot(marginal_effects, aes(x = baseline, y = effect)) + -->
<!--     geom_line() + -->
<!--     geom_point() + -->
<!--     theme_minimal() + -->
<!--     ggtitle("Marginal Effect of Treatment at Different Baseline Values") + -->
<!--     ylab("Treatment Effect") + -->
<!--     xlab("Baseline Value") -->
<!-- #} -->
<!-- # 11. Calculate the total effect of treatment on time2 -->
<!-- # For models without interaction, this is just the coefficient of group -->
<!-- # For models with interaction, we need to evaluate at the mean baseline -->
<!-- # Mean baseline value -->
<!-- mean_baseline <- mean(data$baseline, na.rm = TRUE) -->
<!-- # Total effect in interaction model -->
<!-- total_effect <- coef(model_interaction)["groupTreatment"] +  -->
<!--                coef(model_interaction)["groupTreatment:baseline"] * mean_baseline -->
<!-- cat("Total effect of treatment on time2 at mean baseline:", total_effect, "\n") -->
<!-- # 12. Predicted outcomes for treatment vs control -->
<!-- # Create prediction data for a range of baseline values -->
<!-- pred_data <- expand.grid( -->
<!--   group = factor(c("Control", "Treatment"), levels = levels(data$group)), -->
<!--   baseline = seq(min(data$baseline, na.rm = TRUE), -->
<!--                 max(data$baseline, na.rm = TRUE), -->
<!--                 length.out = 20), -->
<!--   severity = mean(data$severity, na.rm = TRUE)  # Fix severity at mean -->
<!-- ) -->
<!-- # Predictions from different models -->
<!-- pred_data$pred_naive <- predict(model_naive, newdata = pred_data, type = "response") -->
<!-- pred_data$pred_with_severity <- predict(model_with_severity, newdata = pred_data, type = "response") -->
<!-- pred_data$pred_interaction <- predict(model_interaction, newdata = pred_data, type = "response") -->
<!-- # Plot predictions -->
<!-- ggplot(pred_data, aes(x = baseline, y = pred_interaction, color = group)) + -->
<!--   geom_line() + -->
<!--   theme_minimal() + -->
<!--   ggtitle("Predicted Time2 Values by Treatment Group and Baseline") + -->
<!--   ylab("Predicted Time2") + -->
<!--   xlab("Baseline Value") + -->
<!--   scale_color_manual(values = c("blue", "red")) + -->
<!--   theme(legend.title = element_blank()) -->
<!-- # Additional analysis: Marginal effects for IPW interaction model -->
<!-- model_interaction_ipw <- glm(time2 ~ group * baseline + severity,  -->
<!--                            data = subset(data, !is.na(time2)), -->
<!--                            family = gaussian(), -->
<!--                            weights = ipw) -->
<!-- if(requireNamespace("margins", quietly = TRUE)) { -->
<!--   library(margins) -->
<!--   # Marginal effects for standard interaction model -->
<!--   marg_effects_std <- margins(model_interaction,  -->
<!--                             variables = "group", -->
<!--                             at = list(baseline = seq(min(data$baseline, na.rm = TRUE), -->
<!--                                                    max(data$baseline, na.rm = TRUE), -->
<!--                                                    length.out = 10))) -->
<!--   # Marginal effects for IPW interaction model -->
<!--   marg_effects_ipw <- margins(model_interaction_ipw,  -->
<!--                             variables = "group", -->
<!--                             at = list(baseline = seq(min(data$baseline, na.rm = TRUE), -->
<!--                                                    max(data$baseline, na.rm = TRUE), -->
<!--                                                    length.out = 10))) -->
<!--   # Combine for comparison -->
<!--   marg_combined <- data.frame( -->
<!--     baseline = attr(marg_effects_std, "at")$baseline, -->
<!--     effect_std = summary(marg_effects_std)$AME, -->
<!--     effect_ipw = summary(marg_effects_ipw)$AME -->
<!--   ) -->
<!--   # Plot comparison of marginal effects -->
<!--   ggplot(marg_combined) + -->
<!--     geom_line(aes(x = baseline, y = effect_std, color = "Standard Model")) + -->
<!--     geom_line(aes(x = baseline, y = effect_ipw, color = "IPW Model")) + -->
<!--     geom_point(aes(x = baseline, y = effect_std, color = "Standard Model")) + -->
<!--     geom_point(aes(x = baseline, y = effect_ipw, color = "IPW Model")) + -->
<!--     theme_minimal() + -->
<!--     ggtitle("Marginal Effect of Treatment at Different Baseline Values") + -->
<!--     ylab("Treatment Effect") + -->
<!--     xlab("Baseline Value") + -->
<!--     scale_color_manual(values = c("blue", "red"), name = "Model Type") -->
<!-- } else { -->
<!--   # Manual calculation for both models -->
<!--   baseline_values <- seq(min(data$baseline, na.rm = TRUE), -->
<!--                         max(data$baseline, na.rm = TRUE), -->
<!--                         length.out = 10) -->
<!--   # Extract coefficients for standard model -->
<!--   b_group_std <- coef(model_interaction)["groupTreatment"] -->
<!--   b_interaction_std <- coef(model_interaction)["groupTreatment:baseline"] -->
<!--   # Extract coefficients for IPW model -->
<!--   b_group_ipw <- coef(model_interaction_ipw)["groupTreatment"] -->
<!--   b_interaction_ipw <- coef(model_interaction_ipw)["groupTreatment:baseline"] -->
<!--   # Calculate marginal effects -->
<!--   marginal_effects <- data.frame( -->
<!--     baseline = baseline_values, -->
<!--     effect_std = b_group_std + b_interaction_std * baseline_values, -->
<!--     effect_ipw = b_group_ipw + b_interaction_ipw * baseline_values -->
<!--   ) -->
<!--   # Plot comparison -->
<!--   ggplot(marginal_effects) + -->
<!--     geom_line(aes(x = baseline, y = effect_std, color = "Standard Model")) + -->
<!--     geom_line(aes(x = baseline, y = effect_ipw, color = "IPW Model")) + -->
<!--     geom_point(aes(x = baseline, y = effect_std, color = "Standard Model")) + -->
<!--     geom_point(aes(x = baseline, y = effect_ipw, color = "IPW Model")) + -->
<!--     theme_minimal() + -->
<!--     ggtitle("Marginal Effect of Treatment at Different Baseline Values") + -->
<!--     ylab("Treatment Effect") + -->
<!--     xlab("Baseline Value") + -->
<!--     scale_color_manual(values = c("blue", "red"), name = "Model Type") -->
<!-- } -->
<!-- ``` -->
<!-- ## Analyze non-censored version, including severity. When no patients are censored severity should not be needed. -->
<!-- ```{r} -->
<!-- glm(formula = time2_all ~ group + baseline + severity, family = gaussian(),  -->
<!--     data = data) -->
<!-- ``` -->
<!-- # Removing severity from the model -->
<!-- ```{r} -->
<!-- glm(formula = time2_all ~ group + baseline, family = gaussian(),  -->
<!--     data = data) -->
<!-- ``` -->
<!-- # Adding baseline as an interaction with treatment group -->
<!-- ```{r} -->
<!-- glm(formula = time2_all ~ group*baseline, family = gaussian(),  -->
<!--     data = data) -->
<!-- ``` -->
<!-- ## Analysis using stabilized inverse probability weights to adjust for censoring. -->
<!-- Treatment is randomized in this data, so no need to adjust for treatment assignment -->
<!-- ```{r} -->
<!-- ### Estimate stabilized inverse probability weights for censoring ### -->
<!-- # Fit a pooled logistic model that predicts the probability of remaining uncensored  -->
<!-- # (not being lost to follow-up) -->
<!-- psc.denom <- glm(censored == 0 ~ group + baseline + severity ,  -->
<!--                 family=binomial(link="logit"), -->
<!--                 data=data) -->
<!-- summary(psc.denom) -->
<!-- # Obtain predicted probabilities for the denominator -->
<!-- data$psc.denom <- predict(psc.denom, data, type="response")  -->
<!-- # Fit model for the numerator of the stabilized weights -->
<!-- psc.num <- glm(censored==0 ~ group,  -->
<!--                family=binomial(link="logit"), data=data) -->
<!-- summary(psc.num) -->
<!-- # Estimate stabilized weights -->
<!-- data$psc.num <- predict(psc.num, data, type="response") -->
<!-- data <- data %>% -->
<!--   group_by(id) %>% -->
<!--   mutate( -->
<!--     sw_c = cumprod(psc.num)/cumprod(psc.denom) -->
<!--   ) %>% -->
<!--   ungroup() %>% -->
<!--   mutate(sw_c = ifelse(is.na(censored), 1, sw_c))  -->
<!-- ###  Min, 25th percentile, median, mean, SD, 75th percentile, and max: stabilized weights ### -->
<!-- summary(data$sw_c) -->
<!-- sd(data$sw_c) -->
<!-- ``` -->
<!-- Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot. -->

</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-glymour2022" class="csl-entry" role="listitem">
Glymour, M Maria. 2022. <span>“Commentary: Modelling Change in a Causal Framework.”</span> <em>International Journal of Epidemiology</em> 51 (5): 1615–21. <a href="https://doi.org/10.1093/ije/dyac151">https://doi.org/10.1093/ije/dyac151</a>.
</div>
<div id="ref-tennant2021" class="csl-entry" role="listitem">
Tennant, Peter W G, Kellyn F Arnold, George T H Ellison, and Mark S Gilthorpe. 2021. <span>“Analyses of <span>‘</span>Change Scores<span>’</span> Do Not Estimate Causal Effects in Observational Data.”</span> <em>International Journal of Epidemiology</em> 51 (5): 1604–15. <a href="https://doi.org/10.1093/ije/dyab050">https://doi.org/10.1093/ije/dyab050</a>.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>